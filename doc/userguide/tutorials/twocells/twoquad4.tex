
\section{\label{sec:Tutorial-Two-quad4}Tutorial Using Two Quadrilaterals}

PyLith features discussed in this tutorial:
\begin{itemize}
\item Quasi-static solution
\item Mesh ASCII format
\item Dirichlet boundary conditions
\item Neumann boundary conditions
\item Kinematic fault interface conditions
\item Plane strain linearly elastic material
\item VTK output
\item Bilinear quadrilateral cells
\item SimpleDB spatial database
\item ZeroDispDB spatial database
\end{itemize}
All of the files necessary to run the examples are contained in the
directory \texttt{examples/twocells/twoquad4.}


\subsection{Overview}

This tutorial is another simple 2D example of a quasi-static finite
element problem. It is a mesh composed of two bilinear quadrilaterals
subject to displacement or traction boundary conditions, assuming
plane-strain linear elastic behavior. Due to the simple geometry of
the problem, the mesh may be constructed by hand, using PyLith mesh
ASCII format to describe the mesh. In this tutorial, we will walk
through the steps necessary to construct, run, and view four problems
that use the same mesh. In addition to this manual, each of the files
for the example problem includes extensive comments.


\subsection{Mesh Description}

The mesh consists of two square cells with edge lengths of one unit
forming a regular region (Figure \ref{fig:twoquad4-mesh}). The mesh
geometry and topology are described in the file \texttt{twoquad4.mesh},
which is in PyLith mesh ASCII format. This file describes the dimensionality
of the problem (in this case 2D), the coordinates of the vertices
(nodes), the vertices composing each cell (element), the material
ID to be associated with each cell, and then provides groups of vertices
that may be used to define faults or surfaces to which boundary conditions
may be applied.

\noindent \begin{center}
\begin{figure}
\begin{centering}
\includegraphics{tutorials/twocells/figs/twoquad4-mesh}
\par\end{centering}

\caption{Mesh composed of two bilinear quadrilateral cells used for the example
problems.\label{fig:twoquad4-mesh}}
\end{figure}

\par\end{center}


\subsection{Additional Common Information}

In addition to the mesh, the four example problems share additional
information. As in the previous examples, we place this information
in \texttt{pylithapp.cfg}, since this file is read automatically every
time PyLith is run. Settings specific to a particular problem may
be placed in other \texttt{.cfg} files, as described later, and then
those files are placed on the command line.


\subsection{Axial Displacement Example}

The first example problem is extension of the mesh along the x axis.
Parameter settings that override or augment those in \texttt{pylithapp.cfg}
are contained in the file \texttt{axialdisp.cfg}. These include:
\begin{description}
\item [{pylithapp.timedependent.bc.x\_neg}] Specifies the boundary conditions
for the left side of the mesh, defining which degrees of freedom are
being constrained (x), giving the label (defined in \texttt{twoquad4.mesh})
defining the points desired, assigning a label to the boundary condition
set, and giving the name of the spatial database with the values for
the Dirichlet boundary condition (\texttt{axialdisp.spatialdb}).
\item [{pylithapp.timedependent.bc.x\_pos}] Specifies the boundary conditions
for the right side of the mesh, defining which degrees of freedom
are being constrained (x), giving the label (defined in \texttt{twoquad4.mesh})
defining the points desired, assigning a label to the boundary condition
set, and giving the name of the spatial database defining the boundary
conditions (\texttt{axialdisp.spatialdb}).
\item [{pylithapp.timedependent.bc.y\_neg}] Specifies the boundary conditions
for the bottom two corners of the mesh, defining which degrees of
freedom are being constrained (y), giving the label (defined in \texttt{twoquad4.mesh})
defining the points desired, assigning a label to the boundary condition
set, and giving the name of the spatial database with the values for
the Dirichlet boundary condition (\texttt{axialdisp.spatialdb}).
\end{description}
The values for the Dirichlet boundary condition are given in the file
\texttt{axialdisp.spatialdb}, as specified in \texttt{axialdisp.cfg}.
Because the data are being specified using two control points with
a linear variation in the values between the two (rather than being
uniform over the mesh, for example), the data dimension is one.

The files containing common information (\texttt{twoquad4.mesh}, \texttt{pylithapp.cfg},
\texttt{matprops.spatialdb}) along with the problem-specific files
(\texttt{axialdisp.cfg}, \texttt{axialdisp.spatialdb}) provide a complete
description of the problem, and we can then run this example by typing
\begin{lyxcode}
pylith~axialdisp.cfg
\end{lyxcode}
As in the two triangle axial displacement example, three files will
be produced. If the problem ran correctly, you should be able to produce
a figure such as Figure \vref{fig:twoquad4-axial}, which was generated
using ParaView.

\noindent \begin{center}
\begin{figure}[t]
\begin{centering}
\includegraphics[scale=0.33]{tutorials/twocells/figs/twoquad4-axialdisp}
\par\end{centering}

\caption{Color contours and vectors of displacement for the axial displacement
example using a mesh composed of two bilinear quadrilateral cells.\label{fig:twoquad4-axial}}
\end{figure}

\par\end{center}


\subsection{Shear Displacement Example}

The next example problem is shearing of the mesh in the y direction
using displacements applied along the positive and negative x boundaries.
Parameter settings that override or augment those in \texttt{pylithapp.cfg}
are contained in the file \texttt{sheardisp.cfg}. These include:
\begin{description}
\item [{pylithapp.timedependent.bc.x\_neg}] Specifies the boundary conditions
for the left side of the mesh, defining which degrees of freedom are
being constrained (x and y), giving the label (\texttt{x\_neg}, defined
in \texttt{twoquad4.mesh}) defining the points desired, assigning
a label to the boundary condition set, and giving the name of the
spatial database with the values for the Dirichlet boundary condition
(\texttt{sheardisp.spatialdb}).
\item [{pylithapp.timedependent.bc.x\_pos}] Specifies the boundary conditions
for the left side of the mesh, defining which degrees of freedom are
being constrained (y only), giving the label (\texttt{x\_pos}, defined
in \texttt{twoquad4.mesh}) defining the points desired, assigning
a label to the boundary condition set, and giving the name of the
spatial database with the values for the Dirichlet boundary condition
(\texttt{sheardisp.spatialdb}).
\end{description}
The values for the Dirichlet boundary conditions are described in
the file \texttt{sheardisp.spatialdb}, as specified in \texttt{sheardisp.cfg}.
In this case, the desired displacement values are given at two control
points, corresponding to the two edges we want to constrain. Since
data are being specified at two points with a linear variations in
the values between the points (rather than being uniform over the
mesh, for example), the data dimension is one.

The files containing common information (\texttt{twoquad4.mesh}, \texttt{pylithapp.cfg},
\texttt{matprops.spatialdb}) along with the problem-specific files
(\texttt{sheardisp.cfg}, \texttt{sheardisp.spatialdb}) provide a complete
description of the problem, and we can then run this example by typing
\begin{lyxcode}
pylith~sheardisp.cfg
\end{lyxcode}
As in the previous example, three files will be produced. If the problem
ran correctly, you should be able to produce a figure such as Figure
\vref{fig:twoquad4-shear}, which was generated using ParaView.

\begin{figure}
\begin{centering}
\includegraphics[scale=0.33]{tutorials/twocells/figs/twoquad4-sheardisp}
\par\end{centering}

\caption{Color contours and vectors of displacement for the shear displacement
example using a mesh composed of two bilinear quadrilateral cells.\label{fig:twoquad4-shear}}
\end{figure}



\subsection{Kinematic Fault Slip Example}

The next example problem is a left-lateral fault slip applied between
the two square cells using kinematic cohesive cells. The left and
right boundaries are held fixed in the x and y directions. Parameter
settings that override or augment those in \texttt{pylithapp.cfg}
are contained in the file \texttt{dislocation.cfg}. These settings
include:
\begin{description}
\item [{pylithapp.timedependent.bc.x\_neg}] Specifies the boundary conditions
for the left side of the mesh, defining which degrees of freedom are
being constrained (x and y), giving the label (\texttt{x\_neg}, defined
in \texttt{twoquad4.mesh}) defining the points desired, and assigning
a label to the boundary condition set. Instead of specifying a spatial
database file for the values of the Dirichlet boundary condition,
we use the default spatial database (ZeroDispDB) for the Dirichlet
boundary condition, which sets the displacements to zero for all time.
\item [{pylithapp.timedependent.bc.x\_pos}] Specifies the boundary conditions
for the right side of the mesh, defining which degrees of freedom
are being constrained (x and y), giving the label (\texttt{x\_neg},
defined in \texttt{twoquad4.mesh}) defining the points desired, and
assigning a label to the boundary condition set. We use the ZeroDispDB
for this boundary condition as well, which sets the displacements
to zero for all time.
\item [{pylithapp.timedependent.interfaces}] Gives the label (defined in
\texttt{twoquad4.mesh}) defining the points on the fault, provides
quadrature information, and then gives database names for material
properties (needed for conditioning), fault slip, peak fault slip
rate, and fault slip time.
\end{description}
The fault example requires three additional database files that were
not needed for the simple displacement examples. The first file (\texttt{dislocation\_slip.spatialdb})
specifies 0.01 m of left-lateral fault slip for the entire fault.
The data dimension is zero since the same data are applied to all
points in the set. The default slip time function is a step-function,
so we also must provide the time at which slip begins. The elastic
solution is associated with advancing from $t=-dt$ to $t=0$, so
we set the slip initiation time for the step-function to 0 in \texttt{dislocation\_sliptime.spatialdb}.

The files containing common information (\texttt{twoquad4.mesh}, \texttt{pylithapp.cfg},
\texttt{matprops.spatialdb}) along with the problem-specific files
(\texttt{\small{}dislocation.cfg}{\small{}, }\texttt{\small{}dislocation\_slip.spatialdb}{\small{},
}\texttt{\small{}}~\linebreak{}
\texttt{\small{}dislocation\_sliptime.spatialdb}) provide a complete
description of the problem, and we can then run this example by typing
\begin{lyxcode}
pylith~dislocation.cfg
\end{lyxcode}
The addition of a fault results in two additional output files (as
in the two triangle fault example), \texttt{}~\linebreak{}
\texttt{dislocation-fault\_t0000000.vtk} and \texttt{dislocation-fault\_info.vtk}.
These files provide output of fault slip, change in tractions, and
diagnostic information such as the normal direction, final slip, and
slip time for each vertex on the fault. If the problem ran correctly,
you should be able to produce a figure such as Figure \ref{fig:twoquad4-disloc},
which was generated using ParaView.

\begin{figure}
\begin{centering}
\includegraphics[scale=0.33]{tutorials/twocells/figs/twoquad4-dislocation}
\par\end{centering}

\caption{Color contours and vectors of displacement for the kinematic fault
example using a mesh composed of two bilinear quadrilateral cells.\label{fig:twoquad4-disloc}}
\end{figure}



\subsection{\label{sub:Tutorial-twoquad4-traction}Axial Traction Example}

The fourth example demonstrates the use of Neumann (traction) boundary
conditions. Constant tractions are applied to the right edge of the
mesh, while displacements normal to the boundaries are held fixed
along the left and bottom edges of the mesh. Parameter settings that
override or augment those in \texttt{pylithapp.cfg} are contained
in the file \texttt{axialtract.cfg}. These settings include:
\begin{description}
\item [{pylithapp.timedependent}] Specifies an implicit formulation for
the problem and specifies the array of boundary conditions. The boundary
condition type for \texttt{x\_pos} is explicitly set to \texttt{Neumann},
since the default boundary condition type is \texttt{Dirichlet}.
\item [{pylithapp.timedependent.bc.x\_neg}] Specifies the boundary conditions
for the left side of the mesh, defining which degrees of freedom are
being constrained (x) and giving the label (defined in \texttt{twoquad4.mesh})
defining the points desired. In this case, rather than specifying
a spatial database file with values for the Dirichlet boundary conditions,
we use the default spatial database (ZeroDispDB) for the Dirichlet
boundary condition, which sets the displacements to zero for all time.
\item [{pylithapp.timedependent.bc.x\_pos}] Specifies the Neumann boundary
conditions for the right side of the mesh, giving the label (defined
in \texttt{twoquad4.mesh}) defining the points desired, assigning
a label to the boundary condition set, and giving the name of the
spatial database with the traction vectors for the Neumann boundary
condition (\texttt{axialtract.spatialdb}).
\item [{pylithapp.timedependent.bc.y\_neg}] Specifies the boundary conditions
for the bottom two corners of the mesh, defining which degrees of
freedom are being constrained (y) and giving the label (defined in
\texttt{twoquad4.mesh}) defining the points desired. In this case,
we again use the ZeroDispDB, which sets the displacements to zero
for all time.
\item [{pylithapp.problem.formulation.output.output.writer}] Gives the
base filename for VTK output \\
(\texttt{axialtract.vtk}).
\item [{pylithapp.timedependent.bc.x\_pos.output}] Gives the field to be
output for the \texttt{x\_pos} boundary (\texttt{tractions}), and
gives the base filename for \texttt{x\_pos} boundary output (\texttt{axialtract-tractions.vtk}).
\end{description}
The traction vectors for the Neumann boundary conditions are given
in the file \texttt{axialtract.spatialdb}, as specified in \texttt{axialtract.cfg}.
The files containing common information (\texttt{twoquad4.mesh}, \texttt{pylithapp.cfg},
\texttt{matprops.spatialdb}) along with the problem-specific files
(\texttt{axialtract.cfg}, \texttt{axialtract.spatialdb}) provide a
complete description of the problem, and we can then run this example
by typing
\begin{lyxcode}
pylith~axialtract.cfg
\end{lyxcode}
Once the problem has run, six files will be produced. This includes
the five files as in the previous example plus \texttt{axialtract-tractions\_info.vtk},
which gives the \texttt{x} and \texttt{y} components of traction applied
at each integration point. If the problem ran correctly, you should
be able to produce a figure such as Figure \vref{fig:twoquad4-axialtract},
which was generated using ParaView. The results may be compared against
the analytical solution derived in Section \ref{sub:Analytical-Constant-Traction}.

\begin{figure}
\begin{centering}
\includegraphics[scale=0.33]{tutorials/twocells/figs/twoquad4-axialtract}
\par\end{centering}

\caption{Color contours and vectors of displacement for the axial traction
example using a mesh composed of two bilinear quadrilateral cells.\label{fig:twoquad4-axialtract}}
\end{figure}

