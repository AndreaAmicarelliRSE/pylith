/* Generated by Pyrex 0.9.5.1a on Fri May  4 14:14:53 2007 */

#include "Python.h"
#include "structmember.h"
#ifndef PY_LONG_LONG
  #define PY_LONG_LONG LONG_LONG
#endif
#ifdef __cplusplus
#define __PYX_EXTERN_C extern "C"
#else
#define __PYX_EXTERN_C extern
#endif
__PYX_EXTERN_C double pow(double, double);
#include "stdlib.h"
#include "string.h"
#include "elementtypes.h"
#include "const.h"
#include "petsc.h"
#include "petscerror.h"
#include "petscvec.h"
#include "petscmat.h"
#include "petscmeshfwd.h"
#include "petsclog.h"
#include "petscsnes.h"
#include "config.h"
#include "stddef.h"


typedef struct {PyObject **p; char *s;} __Pyx_InternTabEntry; /*proto*/
typedef struct {PyObject **p; char *s; long n;} __Pyx_StringTabEntry; /*proto*/

static PyObject *__pyx_m;
static PyObject *__pyx_b;
static int __pyx_lineno;
static char *__pyx_filename;
static char **__pyx_f;

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name); /*proto*/

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb); /*proto*/

static void __Pyx_WriteUnraisable(char *name); /*proto*/

static int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type); /*proto*/

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list); /*proto*/

static PyObject *__Pyx_UnpackItem(PyObject *); /*proto*/
static int __Pyx_EndUnpack(PyObject *); /*proto*/

static int __Pyx_PrintItem(PyObject *); /*proto*/
static int __Pyx_PrintNewline(void); /*proto*/

static int __Pyx_InternStrings(__Pyx_InternTabEntry *t); /*proto*/

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t); /*proto*/

static int __Pyx_SetVtable(PyObject *dict, void *vtable); /*proto*/

static PyTypeObject *__Pyx_ImportType(char *module_name, char *class_name, long size);  /*proto*/

static int __Pyx_GetVtable(PyObject *dict, void *vtabptr); /*proto*/

static void __Pyx_AddTraceback(char *funcname); /*proto*/

/* Declarations from constants */

enum  {
  __pyx_e_9constants_numberSpaceDimensions = 3,
  __pyx_e_9constants_numberDegreesFreedom = 3,
  __pyx_e_9constants_stateVariableDimension = 6,
  __pyx_e_9constants_materialMatrixDimension = 21,
  __pyx_e_9constants_numberSkewDimensions = 2,
  __pyx_e_9constants_numberSlipDimensions = 5,
  __pyx_e_9constants_numberSlipNeighbors = 4,
  __pyx_e_9constants_maxElementNodes = 20,
  __pyx_e_9constants_nsnodesmax = 4,
  __pyx_e_9constants_maxMaterialModels = 20,
  __pyx_e_9constants_maxStateVariables = 30,
  __pyx_e_9constants_numberAllowedVolumeElementTypes = 1
};


/* Declarations from elementtypes */


/* Declarations from petsc */


/* Declarations from libpylith3d */

__PYX_EXTERN_C void (FC_FUNC_(assign_wink, ASSIGN_WINK)(double (*),double (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*))); /*proto*/
__PYX_EXTERN_C void (FC_FUNC(autoprestr, AUTOPRESTR)(Mat (*),Vec (*),Vec (*),double (*),double (*),double (*),double (*),double (*),double (*),double (*),double (*),double (*),double (*),int (*),double (*),double (*),double (*),double (*),double (*),int (*),int (*),double (*),int (*),int (*),int (*),double (*),double (*),double (*),double (*),double (*),int (*),int (*),double (*),int (*),int (*),int (*),double (*),int (*),double (*),double (*),double (*),double (*),double (*),double (*),double (*),double (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),double (*),double (*),double (*),int (*),double (*),int (*),double (*),double (*),double (*),int (*),double (*),double (*),int (*),int (*),int (*),double (*),double (*),int (*),int (*),int (*),double (*),double (*),double (*),int (*),double (*),double (*),int (*),int (*),int (*),int (*),int (*),char (*),int (*),int (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(cmp_stiffsz, CMP_STIFFSZ)(int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(create_id, CREATE_ID)(int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*))); /*proto*/
__PYX_EXTERN_C void (FC_FUNC(elastc, ELASTC)(Mat (*),Vec (*),Vec (*),double (*),double (*),double (*),double (*),double (*),double (*),double (*),double (*),double (*),double (*),int (*),double (*),double (*),double (*),double (*),double (*),int (*),int (*),double (*),int (*),int (*),int (*),double (*),double (*),double (*),double (*),double (*),int (*),int (*),double (*),int (*),int (*),int (*),double (*),int (*),double (*),double (*),double (*),double (*),double (*),double (*),double (*),double (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),double (*),double (*),double (*),int (*),double (*),int (*),double (*),double (*),double (*),int (*),double (*),double (*),int (*),int (*),int (*),double (*),double (*),int (*),int (*),int (*),double (*),double (*),double (*),int (*),double (*),double (*),int (*),int (*),int (*),int (*),int (*),char (*),int (*),int (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC(f77close, F77CLOSE)(int (*),int (*))); /*proto*/
__PYX_EXTERN_C void (FC_FUNC(f77open, F77OPEN)(int (*),int (*),char (*),char (*),char (*),char (*),int (*),size_t ,size_t ,size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(id_split, ID_SPLIT)(int (*),int (*),int (*),int (*),int (*))); /*proto*/
__PYX_EXTERN_C void (FC_FUNC(lnklst, LNKLST)(int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC(local, LOCAL)(int (*),int (*),int (*),int (*),int (*),int (*))); /*proto*/
__PYX_EXTERN_C void (FC_FUNC(localf, LOCALF)(int (*),int (*),int (*),int (*),int (*),int (*))); /*proto*/
__PYX_EXTERN_C void (FC_FUNC(localx, LOCALX)(int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*))); /*proto*/
__PYX_EXTERN_C void (FC_FUNC(makemsr, MAKEMSR)(Mat (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),double (*))); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(matmod_def, MATMOD_DEF)(int (*))); /*proto*/
__PYX_EXTERN_C void (FC_FUNC(nfind, NFIND)(double (*),double (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*))); /*proto*/
__PYX_EXTERN_C void (FC_FUNC(preshape, PRESHAPE)(double (*),double (*),double (*),int (*),int (*),int (*),int (*),int (*),char (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC(preshape2d, PRESHAPE2D)(double (*),double (*),int (*),int (*),int (*),int (*),int (*),char (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(read_bc, READ_BC)(double (*),double (*),double (*),double (*),int (*),int (*),int (*),int (*),int (*),char (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(read_connect, READ_CONNECT)(int (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(read_coords, READ_COORDS)(double (*),double (*),int (*),int (*),char (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(read_diff, READ_DIFF)(double (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(read_fuldat, READ_FULDAT)(int (*),int (*),int (*),int (*),int (*),int (*),char (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(read_hist, READ_HIST)(double (*),double (*),int (*),int (*),int (*),char (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(read_prestr, READ_PRESTR)(double (*),double (*),double (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(read_skew, READ_SKEW)(double (*),double (*),int (*),int (*),int (*),int (*),char (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(read_slip, READ_SLIP)(int (*),int (*),int (*),int (*),int (*),int (*),char (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(read_split, READ_SPLIT)(double (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(read_stateout, READ_STATEOUT)(int (*),int (*),int (*),char (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(read_timdat, READ_TIMDAT)(double (*),double (*),double (*),double (*),double (*),double (*),double (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(read_tractions, READ_TRACTIONS)(int (*),double (*),double (*),int (*),int (*),int (*),char (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(read_wink, READ_WINK)(double (*),double (*),int (*),int (*),int (*),int (*),int (*),char (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(scan_bc, SCAN_BC)(int (*),int (*),char (*),char (*),char (*),char (*),int (*),char (*),size_t ,size_t ,size_t ,size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(scan_connect, SCAN_CONNECT)(int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(scan_coords, SCAN_COORDS)(int (*),int (*),char (*),char (*),int (*),char (*),size_t ,size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(scan_diff, SCAN_DIFF)(int (*),int (*),int (*),char (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(scan_fuldat, SCAN_FULDAT)(int (*),int (*),int (*),int (*),char (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(scan_hist, SCAN_HIST)(int (*),int (*),char (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(scan_prestr, SCAN_PRESTR)(int (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(scan_skew, SCAN_SKEW)(int (*),int (*),char (*),char (*),int (*),char (*),size_t ,size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(scan_slip, SCAN_SLIP)(int (*),int (*),char (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(scan_split, SCAN_SPLIT)(int (*),int (*),char (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(scan_timdat, SCAN_TIMDAT)(int (*),int (*),int (*),char (*),char (*),int (*),char (*),size_t ,size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(scan_tractions, SCAN_TRACTIONS)(int (*),int (*),int (*),int (*),char (*),char (*),int (*),char (*),size_t ,size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(scan_wink, SCAN_WINK)(int (*),int (*),int (*),char (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(scan_winkx, SCAN_WINKX)(int (*),int (*),int (*),int (*),char (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(sort_elements, SORT_ELEMENTS)(int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(sort_slip_nodes, SORT_SLIP_NODES)(int (*),int (*),int (*),int (*))); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(sort_split_nodes, SORT_SPLIT_NODES)(int (*),int (*),int (*),int (*))); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(try_binio, TRY_BINIO)(int (*),int (*),char (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC(viscos, VISCOS)(Mat (*),Vec (*),Vec (*),double (*),double (*),double (*),double (*),double (*),double (*),double (*),double (*),double (*),double (*),int (*),double (*),double (*),double (*),double (*),double (*),int (*),int (*),double (*),int (*),int (*),int (*),double (*),double (*),double (*),double (*),double (*),int (*),int (*),double (*),int (*),int (*),int (*),double (*),int (*),double (*),double (*),double (*),double (*),double (*),double (*),double (*),double (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),double (*),double (*),double (*),int (*),double (*),int (*),double (*),double (*),double (*),int (*),double (*),double (*),int (*),int (*),int (*),double (*),double (*),int (*),int (*),int (*),double (*),double (*),double (*),int (*),double (*),double (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),int (*),int (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(viscos_setup, VISCOS_SETUP)(int (*),int (*),int (*),int (*),char (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(viscos_step, VISCOS_STEP)(Mat (*),Vec (*),Vec (*),double (*),double (*),double (*),double (*),double (*),double (*),double (*),double (*),double (*),double (*),int (*),double (*),double (*),double (*),double (*),double (*),int (*),int (*),double (*),int (*),int (*),int (*),double (*),double (*),double (*),double (*),double (*),int (*),int (*),double (*),int (*),int (*),int (*),double (*),int (*),double (*),double (*),double (*),double (*),double (*),double (*),double (*),double (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),double (*),double (*),double (*),int (*),double (*),int (*),double (*),double (*),double (*),int (*),double (*),double (*),int (*),int (*),int (*),double (*),double (*),int (*),int (*),int (*),double (*),double (*),double (*),int (*),double (*),double (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),double (*),double (*),int (*),double (*),int (*),char (*),size_t ,size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(viscos_cleanup, VISCOS_CLEANUP)(int (*),int (*),int (*),int (*),char (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(write_bc, WRITE_BC)(double (*),int (*),int (*),int (*),int (*),int (*),char (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(write_connect, WRITE_CONNECT)(int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(write_coords, WRITE_COORDS)(double (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(write_diff, WRITE_DIFF)(double (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(write_element_info, WRITE_ELEMENT_INFO)(int (*),int (*),int (*),int (*),int (*),int (*),int (*),double (*),double (*),int (*),int (*))); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(write_fuldat, WRITE_FULDAT)(int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(write_global_info, WRITE_GLOBAL_INFO)(char (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(write_hist, WRITE_HIST)(double (*),double (*),int (*),int (*),int (*),int (*),int (*),char (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(write_props, WRITE_PROPS)(double (*),double (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(write_skew, WRITE_SKEW)(double (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(write_slip, WRITE_SLIP)(int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(write_sparse_info, WRITE_SPARSE_INFO)(int (*),int (*),int (*),int (*),double (*),int (*),int (*))); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(write_split, WRITE_SPLIT)(double (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(write_split_plot, WRITE_SPLIT_PLOT)(int (*),int (*),int (*),int (*))); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(write_stateout, WRITE_STATEOUT)(int (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(write_strscomp, WRITE_STRSCOMP)(double (*),double (*),double (*),int (*),int (*))); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(write_subiter, WRITE_SUBITER)(int (*),int (*),int (*))); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(write_tractions, WRITE_TRACTIONS)(int (*),double (*),int (*),int (*),int (*),int (*),int (*),char (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(write_timdat, WRITE_TIMDAT)(double (*),double (*),double (*),double (*),double (*),double (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(write_ucd_mesh, WRITE_UCD_MESH)(double (*),int (*),int (*),int (*),int (*),int (*),double (*),int (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(write_wink, WRITE_WINK)(double (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),size_t )); /*proto*/
__PYX_EXTERN_C void (FC_FUNC_(write_winkx, WRITE_WINKX)(double (*),int (*),int (*),int (*),int (*),int (*),int (*),char (*),size_t )); /*proto*/

/* Declarations from PyLithMeshLib */

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyMesh_Type;

struct PyMeshObject {
  PyObject_HEAD
  struct __pyx_vtabstruct_13PyLithMeshLib_Mesh *__pyx_vtab;
  Mesh mesh;
  Mat A;
  Vec rhs;
  Vec sol;
  char (*meshInputFile);
  char (*meshBcFile);
  int interpolateMesh;
  char (*partitioner);
  PyObject *_meshInputFile;
  PyObject *_meshBcFile;
  PyObject *_partitioner;
};

struct __pyx_vtabstruct_13PyLithMeshLib_Mesh {
  PyObject *((*createMat)(struct PyMeshObject *));
  PyObject *((*destroyMat)(struct PyMeshObject *));
  PyObject *((*outputMesh)(struct PyMeshObject *,PyObject *));
};
static struct __pyx_vtabstruct_13PyLithMeshLib_Mesh *__pyx_vtabptr_13PyLithMeshLib_Mesh;

static PyTypeObject *__pyx_ptype_13PyLithMeshLib_Mesh = 0;

/* Declarations from PyLithLib */

enum  {
  __pyx_e_9PyLithLib_errorstring_size = 4096
};

enum  {
  __pyx_e_9PyLithLib_prestress = 0
};


struct __pyx_obj_9PyLithLib_IntArray {
  PyObject_HEAD
  struct __pyx_vtabstruct_9PyLithLib_IntArray *__pyx_vtab;
  int len;
  int (*ptr);
};

struct __pyx_vtabstruct_9PyLithLib_IntArray {
  PyObject *((*asList)(struct __pyx_obj_9PyLithLib_IntArray *));
};
static struct __pyx_vtabstruct_9PyLithLib_IntArray *__pyx_vtabptr_9PyLithLib_IntArray;


struct __pyx_obj_9PyLithLib_DoubleArray {
  PyObject_HEAD
  struct __pyx_vtabstruct_9PyLithLib_DoubleArray *__pyx_vtab;
  int len;
  double (*ptr);
};

struct __pyx_vtabstruct_9PyLithLib_DoubleArray {
  PyObject *((*asList)(struct __pyx_obj_9PyLithLib_DoubleArray *));
};
static struct __pyx_vtabstruct_9PyLithLib_DoubleArray *__pyx_vtabptr_9PyLithLib_DoubleArray;


struct __pyx_obj_9PyLithLib_PyLith {
  PyObject_HEAD
  struct __pyx_vtabstruct_9PyLithLib_PyLith *__pyx_vtab;
  PyObject *title;
  PyObject *fileRoot;
  PyObject *ofile;
  PyObject *pfile;
  PyObject *ucdroot;
  PyObject *coordinateInputFile;
  PyObject *bcfile;
  PyObject *timeStepInputFile;
  PyObject *stfile;
  PyObject *connectivityInputFile;
  PyObject *fofile;
  PyObject *sampleLocationFile;
  PyObject *spfile;
  PyObject *skfile;
  PyObject *hfile;
  PyObject *tractionInputFile;
  PyObject *wfile;
  PyObject *materialHistoryInputFile;
  PyObject *prestressInputFile;
  PyObject *slfile;
  PyObject *difile;
  PyObject *wxfile;
  int idout;
  int idsk;
  int iucd;
  int icode;
  int pythonTimestep;
  int generateGreen;
  int idebug;
  int ncycle;
  int iskopt;
  double stol;
  double dtol;
  double epert;
  int nprevdflag;
  int intord;
  int ipstrs;
  int ipauto;
  double tpois;
  double tyoungs;
  int numat;
  int kti;
  int kto;
  int kr;
  int kw;
  int kp;
  int kucd;
  struct PyMeshObject *_mesh;
  double (_grav[3]);
  double (_prscal[6]);
  double (_wscal[3]);
  double (_wxscal[3]);
  struct __pyx_obj_9PyLithLib_DoubleArray *_prop;
  struct __pyx_obj_9PyLithLib_IntArray *_infmat;
  PyObject *trace;
  int maxElementEquations;
  int (neni[10]);
  int (infmatmod[(6 * __pyx_e_9constants_maxMaterialModels)]);
  int numnp;
  double cscale;
  int numbc;
  double dscale;
  double vscale;
  double fscale;
  int nwinke;
  int nwink;
  int numrot;
  double runits;
  int lastep;
  int nintg;
  double tunits;
  int icontr;
  int nhist;
  int nprestr;
  int nprestrflag;
  int numtractions;
  double tscale;
  int numfn;
  int numslp;
  int numdif;
  int nwinkxe;
  int nwinkx;
  int maxvfamilies;
  struct __pyx_obj_9PyLithLib_IntArray *ivflist;
  int numelv;
  int nvfamilies;
  int ietypev;
  int nen;
  int nsnodes;
  int ngauss;
  int nee;
  int connectivitySize;
  struct __pyx_obj_9PyLithLib_DoubleArray *sh;
  struct __pyx_obj_9PyLithLib_DoubleArray *shj;
  struct __pyx_obj_9PyLithLib_DoubleArray *gauss;
  struct __pyx_obj_9PyLithLib_DoubleArray *sh2d;
  struct __pyx_obj_9PyLithLib_DoubleArray *gauss2d;
  int (infetype[4]);
  int (infetype2d[4]);
  struct __pyx_obj_9PyLithLib_DoubleArray *x;
  struct __pyx_obj_9PyLithLib_DoubleArray *bond;
  struct __pyx_obj_9PyLithLib_IntArray *ibond;
  int numberConcForces;
  struct __pyx_obj_9PyLithLib_DoubleArray *skew;
  struct __pyx_obj_9PyLithLib_DoubleArray *delt;
  struct __pyx_obj_9PyLithLib_DoubleArray *alfa;
  struct __pyx_obj_9PyLithLib_DoubleArray *utol;
  struct __pyx_obj_9PyLithLib_DoubleArray *ftol;
  struct __pyx_obj_9PyLithLib_DoubleArray *etol;
  struct __pyx_obj_9PyLithLib_DoubleArray *times;
  struct __pyx_obj_9PyLithLib_IntArray *maxstp;
  struct __pyx_obj_9PyLithLib_IntArray *maxit;
  struct __pyx_obj_9PyLithLib_IntArray *ntdinit;
  struct __pyx_obj_9PyLithLib_IntArray *lgdef;
  struct __pyx_obj_9PyLithLib_IntArray *itmax;
  struct __pyx_obj_9PyLithLib_IntArray *iprint;
  int (istatout[(3 * __pyx_e_9constants_maxStateVariables)]);
  int (nstatout[3]);
  struct __pyx_obj_9PyLithLib_DoubleArray *histry;
  struct __pyx_obj_9PyLithLib_IntArray *ien;
  struct __pyx_obj_9PyLithLib_IntArray *mat;
  struct __pyx_obj_9PyLithLib_IntArray *tractionverts;
  struct __pyx_obj_9PyLithLib_DoubleArray *tractionvals;
  struct __pyx_obj_9PyLithLib_IntArray *nfault;
  struct __pyx_obj_9PyLithLib_DoubleArray *fault;
  int numflt;
  struct __pyx_obj_9PyLithLib_IntArray *nslip;
  int numsn;
  struct __pyx_obj_9PyLithLib_IntArray *idhist;
  struct __pyx_obj_9PyLithLib_DoubleArray *diforc;
  struct __pyx_obj_9PyLithLib_IntArray *iwinkdef;
  struct __pyx_obj_9PyLithLib_IntArray *iwinkid;
  struct __pyx_obj_9PyLithLib_DoubleArray *winkdef;
  struct __pyx_obj_9PyLithLib_IntArray *iwinkxdef;
  struct __pyx_obj_9PyLithLib_IntArray *iwinkxid;
  struct __pyx_obj_9PyLithLib_DoubleArray *winkxdef;
  struct __pyx_obj_9PyLithLib_IntArray *idftn;
  struct __pyx_obj_9PyLithLib_IntArray *id;
  struct __pyx_obj_9PyLithLib_IntArray *idx;
  struct __pyx_obj_9PyLithLib_IntArray *idslp;
  int neq;
  struct __pyx_obj_9PyLithLib_IntArray *ipslp;
  struct __pyx_obj_9PyLithLib_DoubleArray *wink;
  struct __pyx_obj_9PyLithLib_DoubleArray *winkx;
  struct __pyx_obj_9PyLithLib_IntArray *iwink;
  struct __pyx_obj_9PyLithLib_IntArray *iwinkx;
  struct __pyx_obj_9PyLithLib_IntArray *iens;
  struct __pyx_obj_9PyLithLib_IntArray *ivfamily;
  struct __pyx_obj_9PyLithLib_IntArray *indxiel;
  struct __pyx_obj_9PyLithLib_IntArray *ielindx;
  int nstatesz;
  int nstatesz0;
  int npropsz;
  PetscInt autoprestrStage;
  PetscInt elasticStage;
  PetscInt viscousStage;
  PetscEvent iterateEvent;
  struct __pyx_obj_9PyLithLib_IntArray *lm;
  struct __pyx_obj_9PyLithLib_IntArray *lmf;
  struct __pyx_obj_9PyLithLib_IntArray *lmx;
  int nnz;
  int nmin;
  int nmax;
  double wavg;
  struct __pyx_obj_9PyLithLib_DoubleArray *bextern;
  struct __pyx_obj_9PyLithLib_DoubleArray *btraction;
  struct __pyx_obj_9PyLithLib_DoubleArray *bgravity;
  struct __pyx_obj_9PyLithLib_DoubleArray *bconcForce;
  struct __pyx_obj_9PyLithLib_DoubleArray *bwink;
  struct __pyx_obj_9PyLithLib_DoubleArray *bwinkx;
  struct __pyx_obj_9PyLithLib_DoubleArray *bintern;
  struct __pyx_obj_9PyLithLib_DoubleArray *bresid;
  struct __pyx_obj_9PyLithLib_DoubleArray *dispVec;
  struct __pyx_obj_9PyLithLib_DoubleArray *dprev;
  struct __pyx_obj_9PyLithLib_DoubleArray *d;
  struct __pyx_obj_9PyLithLib_DoubleArray *deld;
  struct __pyx_obj_9PyLithLib_DoubleArray *dcur;
  struct __pyx_obj_9PyLithLib_DoubleArray *dx;
  struct __pyx_obj_9PyLithLib_DoubleArray *deldx;
  struct __pyx_obj_9PyLithLib_DoubleArray *dxcur;
  struct __pyx_obj_9PyLithLib_DoubleArray *dfault;
  struct __pyx_obj_9PyLithLib_DoubleArray *tfault;
  struct __pyx_obj_9PyLithLib_DoubleArray *s;
  struct __pyx_obj_9PyLithLib_DoubleArray *stemp;
  struct __pyx_obj_9PyLithLib_DoubleArray *state;
  struct __pyx_obj_9PyLithLib_DoubleArray *dstate;
  struct __pyx_obj_9PyLithLib_DoubleArray *dmat;
  struct __pyx_obj_9PyLithLib_DoubleArray *state0;
  int (iddmat[36]);
  int (nforce[8]);
  int (ncodat[2]);
  int (npar[12]);
  int (nprint[4]);
  int (nsysdat[11]);
  int (nunits[6]);
  int (nvisdat[4]);
  double (rgiter[3]);
  double (rtimdat[4]);
  int (ntimdat[8]);
};

struct __pyx_vtabstruct_9PyLithLib_PyLith {
  PyObject *((*outputSampleValues)(struct __pyx_obj_9PyLithLib_PyLith *,PyObject *,PyObject *,PyObject *));
  PyObject *((*greenFunction)(struct __pyx_obj_9PyLithLib_PyLith *,PyObject *));
  PyObject *((*scan)(struct __pyx_obj_9PyLithLib_PyLith *));
  PyObject *((*scan_connect)(struct __pyx_obj_9PyLithLib_PyLith *));
  PyObject *((*read)(struct __pyx_obj_9PyLithLib_PyLith *));
  PyObject *((*getdef)(struct __pyx_obj_9PyLithLib_PyLith *));
  PyObject *((*numberequations)(struct __pyx_obj_9PyLithLib_PyLith *));
  PyObject *((*nfind)(struct __pyx_obj_9PyLithLib_PyLith *));
  PyObject *((*sortmesh)(struct __pyx_obj_9PyLithLib_PyLith *));
  PyObject *((*sort_elements)(struct __pyx_obj_9PyLithLib_PyLith *));
  PyObject *((*setupPETScLogging)(struct __pyx_obj_9PyLithLib_PyLith *));
  PyObject *((*sparsesetup)(struct __pyx_obj_9PyLithLib_PyLith *));
  PyObject *((*allocateremaining)(struct __pyx_obj_9PyLithLib_PyLith *));
  PyObject *((*meshwrite)(struct __pyx_obj_9PyLithLib_PyLith *));
  PyObject *((*solveElastic)(struct __pyx_obj_9PyLithLib_PyLith *));
  PyObject *((*interpolatePoints)(struct __pyx_obj_9PyLithLib_PyLith *,PyObject *));
  PyObject *((*runSimulation)(struct __pyx_obj_9PyLithLib_PyLith *));
};
static struct __pyx_vtabstruct_9PyLithLib_PyLith *__pyx_vtabptr_9PyLithLib_PyLith;

static PyTypeObject *__pyx_ptype_9PyLithLib_IntArray = 0;
static PyTypeObject *__pyx_ptype_9PyLithLib_DoubleArray = 0;
static PyTypeObject *__pyx_ptype_9PyLithLib_PyLith = 0;
static int __pyx_v_9PyLithLib_memoryUsage;
static PyObject *__pyx_k1;
static PyObject *__pyx_k2;
static PyObject *__pyx_k3;
static PyObject *__pyx_k4;
static PyObject *__pyx_k5;
static PyObject *__pyx_k6;
static PyObject *(__pyx_f_9PyLithLib_setIntArrayFromList(int (*),int ,PyObject *)); /*proto*/
static PyObject *(__pyx_f_9PyLithLib_listFromIntArray(int (*),int )); /*proto*/
static PyObject *(__pyx_f_9PyLithLib_setDoubleArrayFromList(double (*),int ,PyObject *)); /*proto*/
static PyObject *(__pyx_f_9PyLithLib_listFromDoubleArray(double (*),int )); /*proto*/
__PYX_EXTERN_C PyObject *(exceptionhandler(int ,char (*))); /*proto*/
static PetscInt (__pyx_f_9PyLithLib_PetscLogStageRegister(PyObject *)); /*proto*/
static PetscEvent (__pyx_f_9PyLithLib_PetscLogEventRegister(PyObject *,PetscCookie )); /*proto*/
static PyObject *(__pyx_f_9PyLithLib_PetscLogStagePush(int )); /*proto*/
static PyObject *(__pyx_f_9PyLithLib_PetscLogStagePop(void)); /*proto*/


/* Implementation of PyLithLib */

static PyObject *__pyx_n_constants;
static PyObject *__pyx_n_elementtypes;
static PyObject *__pyx_n_libpylith3d;
static PyObject *__pyx_n_petsc;
static PyObject *__pyx_n_PyLithMeshLib;
static PyObject *__pyx_n_f77open;
static PyObject *__pyx_n_f77close;
static PyObject *__pyx_n_gfile;
static PyObject *__pyx_n_ghelp;
static PyObject *__pyx_n_PetscInitialize;
static PyObject *__pyx_n_PetscFinalize;
static PyObject *__pyx_n_try_binio;

static PyObject *__pyx_n_isinstance;
static PyObject *__pyx_n_int;
static PyObject *__pyx_n_len;
static PyObject *__pyx_n_MemoryError;

static PyObject *__pyx_k7p;

static char (__pyx_k7[]) = "malloc failed";

static int __pyx_f_9PyLithLib_8IntArray___new__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_9PyLithLib_8IntArray___new__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_l = 0;
  PyObject *__pyx_v_init;
  long __pyx_v_size;
  PyObject *__pyx_v_i;
  int __pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  long __pyx_5;
  int __pyx_6;
  int __pyx_7;
  static char *__pyx_argnames[] = {"l",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_l)) return -1;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_l);
  __pyx_v_init = Py_None; Py_INCREF(Py_None);
  __pyx_v_i = Py_None; Py_INCREF(Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":48 */
  __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_isinstance); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_int); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; goto __pyx_L1;}
  Py_INCREF(__pyx_v_l);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_l);
  PyTuple_SET_ITEM(__pyx_3, 1, __pyx_2);
  __pyx_2 = 0;
  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_4 = PyObject_IsTrue(__pyx_2); if (__pyx_4 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (__pyx_4) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":49 */
    __pyx_4 = PyInt_AsLong(__pyx_v_l); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 49; goto __pyx_L1;}
    ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_v_self)->len = __pyx_4;
    goto __pyx_L2;
  }
  /*else*/ {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":51 */
    __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; goto __pyx_L1;}
    __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; goto __pyx_L1;}
    Py_INCREF(__pyx_v_l);
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_l);
    __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_4 = PyInt_AsLong(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_v_self)->len = __pyx_4;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":52 */
    Py_INCREF(__pyx_v_l);
    Py_DECREF(__pyx_v_init);
    __pyx_v_init = __pyx_v_l;
  }
  __pyx_L2:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":53 */
  __pyx_v_size = ((sizeof(int )) * ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_v_self)->len);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":54 */
  ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_v_self)->ptr = ((int (*))malloc(__pyx_v_size));

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":55 */
  __pyx_4 = (((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_v_self)->ptr == NULL);
  if (__pyx_4) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":56 */
    __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_MemoryError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; goto __pyx_L1;}
    __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; goto __pyx_L1;}
    Py_INCREF(__pyx_k7p);
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_k7p);
    __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":58 */
  __pyx_v_9PyLithLib_memoryUsage = (__pyx_v_9PyLithLib_memoryUsage + __pyx_v_size);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":59 */
  __pyx_4 = PyObject_IsTrue(__pyx_v_init); if (__pyx_4 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; goto __pyx_L1;}
  if (__pyx_4) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":60 */
    __pyx_4 = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_v_self)->len;
    for (__pyx_5 = 0; __pyx_5 < __pyx_4; ++__pyx_5) {
      __pyx_1 = PyInt_FromLong(__pyx_5); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; goto __pyx_L1;}
      Py_DECREF(__pyx_v_i);
      __pyx_v_i = __pyx_1;
      __pyx_1 = 0;

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":61 */
      __pyx_3 = PyObject_GetItem(__pyx_v_init, __pyx_v_i); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; goto __pyx_L1;}
      __pyx_6 = PyInt_AsLong(__pyx_3); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; goto __pyx_L1;}
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      __pyx_7 = PyInt_AsLong(__pyx_v_i); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; goto __pyx_L1;}
      (((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_v_self)->ptr[__pyx_7]) = __pyx_6;
    }
    goto __pyx_L4;
  }
  __pyx_L4:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":62 */
  __pyx_r = 0;
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("PyLithLib.IntArray.__new__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_init);
  Py_DECREF(__pyx_v_i);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_l);
  return __pyx_r;
}

static void __pyx_f_9PyLithLib_8IntArray___dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_f_9PyLithLib_8IntArray___dealloc__(PyObject *__pyx_v_self) {
  Py_INCREF(__pyx_v_self);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":65 */
  free(((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_v_self)->ptr);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":66 */
  ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_v_self)->ptr = NULL;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":68 */
  __pyx_v_9PyLithLib_memoryUsage = (__pyx_v_9PyLithLib_memoryUsage - ((sizeof(int )) * ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_v_self)->len));

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":69 */
  goto __pyx_L0;

  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
}

static PyObject *__pyx_f_9PyLithLib_8IntArray_asList(struct __pyx_obj_9PyLithLib_IntArray *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":72 */
  __pyx_1 = __pyx_f_9PyLithLib_listFromIntArray(__pyx_v_self->ptr,__pyx_v_self->len); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; goto __pyx_L1;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("PyLithLib.IntArray.asList");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_k8p;

static char (__pyx_k8[]) = "malloc failed";

static int __pyx_f_9PyLithLib_11DoubleArray___new__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_9PyLithLib_11DoubleArray___new__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_l = 0;
  PyObject *__pyx_v_init;
  long __pyx_v_size;
  PyObject *__pyx_v_i;
  int __pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  long __pyx_5;
  double __pyx_6;
  int __pyx_7;
  static char *__pyx_argnames[] = {"l",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_l)) return -1;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_l);
  __pyx_v_init = Py_None; Py_INCREF(Py_None);
  __pyx_v_i = Py_None; Py_INCREF(Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":83 */
  __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_isinstance); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_int); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; goto __pyx_L1;}
  Py_INCREF(__pyx_v_l);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_l);
  PyTuple_SET_ITEM(__pyx_3, 1, __pyx_2);
  __pyx_2 = 0;
  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_4 = PyObject_IsTrue(__pyx_2); if (__pyx_4 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (__pyx_4) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":84 */
    __pyx_4 = PyInt_AsLong(__pyx_v_l); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; goto __pyx_L1;}
    ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_v_self)->len = __pyx_4;
    goto __pyx_L2;
  }
  /*else*/ {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":86 */
    __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 86; goto __pyx_L1;}
    __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 86; goto __pyx_L1;}
    Py_INCREF(__pyx_v_l);
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_l);
    __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 86; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_4 = PyInt_AsLong(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 86; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_v_self)->len = __pyx_4;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":87 */
    Py_INCREF(__pyx_v_l);
    Py_DECREF(__pyx_v_init);
    __pyx_v_init = __pyx_v_l;
  }
  __pyx_L2:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":88 */
  __pyx_v_size = ((sizeof(double )) * ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_v_self)->len);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":89 */
  ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_v_self)->ptr = ((double (*))malloc(__pyx_v_size));

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":90 */
  __pyx_4 = (((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_v_self)->ptr == NULL);
  if (__pyx_4) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":91 */
    __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_MemoryError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; goto __pyx_L1;}
    __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; goto __pyx_L1;}
    Py_INCREF(__pyx_k8p);
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_k8p);
    __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":93 */
  __pyx_v_9PyLithLib_memoryUsage = (__pyx_v_9PyLithLib_memoryUsage + __pyx_v_size);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":94 */
  __pyx_4 = PyObject_IsTrue(__pyx_v_init); if (__pyx_4 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; goto __pyx_L1;}
  if (__pyx_4) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":95 */
    __pyx_4 = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_v_self)->len;
    for (__pyx_5 = 0; __pyx_5 < __pyx_4; ++__pyx_5) {
      __pyx_1 = PyInt_FromLong(__pyx_5); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 95; goto __pyx_L1;}
      Py_DECREF(__pyx_v_i);
      __pyx_v_i = __pyx_1;
      __pyx_1 = 0;

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":96 */
      __pyx_3 = PyObject_GetItem(__pyx_v_init, __pyx_v_i); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; goto __pyx_L1;}
      __pyx_6 = PyFloat_AsDouble(__pyx_3); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; goto __pyx_L1;}
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      __pyx_7 = PyInt_AsLong(__pyx_v_i); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; goto __pyx_L1;}
      (((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_v_self)->ptr[__pyx_7]) = __pyx_6;
    }
    goto __pyx_L4;
  }
  __pyx_L4:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":97 */
  __pyx_r = 0;
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("PyLithLib.DoubleArray.__new__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_init);
  Py_DECREF(__pyx_v_i);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_l);
  return __pyx_r;
}

static void __pyx_f_9PyLithLib_11DoubleArray___dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_f_9PyLithLib_11DoubleArray___dealloc__(PyObject *__pyx_v_self) {
  Py_INCREF(__pyx_v_self);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":100 */
  free(((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_v_self)->ptr);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":101 */
  ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_v_self)->ptr = NULL;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":103 */
  __pyx_v_9PyLithLib_memoryUsage = (__pyx_v_9PyLithLib_memoryUsage - ((sizeof(double )) * ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_v_self)->len));

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":104 */
  goto __pyx_L0;

  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
}

static PyObject *__pyx_f_9PyLithLib_11DoubleArray_asList(struct __pyx_obj_9PyLithLib_DoubleArray *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":107 */
  __pyx_1 = __pyx_f_9PyLithLib_listFromDoubleArray(__pyx_v_self->ptr,__pyx_v_self->len); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; goto __pyx_L1;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("PyLithLib.DoubleArray.asList");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_9PyLithLib_setIntArrayFromList(int (*__pyx_v_array),int __pyx_v_dim,PyObject *__pyx_v_aList) {
  PyObject *__pyx_v_i;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  long __pyx_5;
  int __pyx_6;
  Py_INCREF(__pyx_v_aList);
  __pyx_v_i = Py_None; Py_INCREF(Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":114 */
  __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; goto __pyx_L1;}
  Py_INCREF(__pyx_v_aList);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_aList);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_1 = PyInt_FromLong(__pyx_v_dim); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; goto __pyx_L1;}
  if (PyObject_Cmp(__pyx_3, __pyx_1, &__pyx_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; goto __pyx_L1;}
  __pyx_4 = __pyx_4 == 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (!__pyx_4) {
    PyErr_SetNone(PyExc_AssertionError);
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; goto __pyx_L1;}
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":115 */
  for (__pyx_5 = 0; __pyx_5 < __pyx_v_dim; ++__pyx_5) {
    __pyx_2 = PyInt_FromLong(__pyx_5); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; goto __pyx_L1;}
    Py_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_2;
    __pyx_2 = 0;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":116 */
    __pyx_3 = PyObject_GetItem(__pyx_v_aList, __pyx_v_i); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 116; goto __pyx_L1;}
    __pyx_4 = PyInt_AsLong(__pyx_3); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 116; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_6 = PyInt_AsLong(__pyx_v_i); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 116; goto __pyx_L1;}
    (__pyx_v_array[__pyx_6]) = __pyx_4;
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":117 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("PyLithLib.setIntArrayFromList");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_i);
  Py_DECREF(__pyx_v_aList);
  return __pyx_r;
}

static PyObject *__pyx_n_append;

static PyObject *__pyx_f_9PyLithLib_listFromIntArray(int (*__pyx_v_array),int __pyx_v_dim) {
  PyObject *__pyx_v_aList;
  PyObject *__pyx_v_i;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  long __pyx_2;
  int __pyx_3;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  __pyx_v_aList = Py_None; Py_INCREF(Py_None);
  __pyx_v_i = Py_None; Py_INCREF(Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":121 */
  __pyx_1 = PyList_New(0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; goto __pyx_L1;}
  Py_DECREF(__pyx_v_aList);
  __pyx_v_aList = __pyx_1;
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":122 */
  for (__pyx_2 = 0; __pyx_2 < __pyx_v_dim; ++__pyx_2) {
    __pyx_1 = PyInt_FromLong(__pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; goto __pyx_L1;}
    Py_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_1;
    __pyx_1 = 0;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":123 */
    __pyx_1 = PyObject_GetAttr(__pyx_v_aList, __pyx_n_append); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; goto __pyx_L1;}
    __pyx_3 = PyInt_AsLong(__pyx_v_i); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; goto __pyx_L1;}
    __pyx_4 = PyInt_FromLong((__pyx_v_array[__pyx_3])); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; goto __pyx_L1;}
    __pyx_5 = PyTuple_New(1); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_5, 0, __pyx_4);
    __pyx_4 = 0;
    __pyx_4 = PyObject_CallObject(__pyx_1, __pyx_5); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":124 */
  Py_INCREF(__pyx_v_aList);
  __pyx_r = __pyx_v_aList;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  __Pyx_AddTraceback("PyLithLib.listFromIntArray");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_aList);
  Py_DECREF(__pyx_v_i);
  return __pyx_r;
}

static PyObject *__pyx_f_9PyLithLib_setDoubleArrayFromList(double (*__pyx_v_array),int __pyx_v_dim,PyObject *__pyx_v_aList) {
  PyObject *__pyx_v_i;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  long __pyx_5;
  double __pyx_6;
  Py_INCREF(__pyx_v_aList);
  __pyx_v_i = Py_None; Py_INCREF(Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":128 */
  __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; goto __pyx_L1;}
  Py_INCREF(__pyx_v_aList);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_aList);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_1 = PyInt_FromLong(__pyx_v_dim); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; goto __pyx_L1;}
  if (PyObject_Cmp(__pyx_3, __pyx_1, &__pyx_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; goto __pyx_L1;}
  __pyx_4 = __pyx_4 == 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (!__pyx_4) {
    PyErr_SetNone(PyExc_AssertionError);
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; goto __pyx_L1;}
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":129 */
  for (__pyx_5 = 0; __pyx_5 < __pyx_v_dim; ++__pyx_5) {
    __pyx_2 = PyInt_FromLong(__pyx_5); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; goto __pyx_L1;}
    Py_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_2;
    __pyx_2 = 0;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":130 */
    __pyx_3 = PyObject_GetItem(__pyx_v_aList, __pyx_v_i); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; goto __pyx_L1;}
    __pyx_6 = PyFloat_AsDouble(__pyx_3); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_4 = PyInt_AsLong(__pyx_v_i); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; goto __pyx_L1;}
    (__pyx_v_array[__pyx_4]) = __pyx_6;
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":131 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("PyLithLib.setDoubleArrayFromList");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_i);
  Py_DECREF(__pyx_v_aList);
  return __pyx_r;
}

static PyObject *__pyx_f_9PyLithLib_listFromDoubleArray(double (*__pyx_v_array),int __pyx_v_dim) {
  PyObject *__pyx_v_aList;
  PyObject *__pyx_v_i;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  long __pyx_2;
  int __pyx_3;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  __pyx_v_aList = Py_None; Py_INCREF(Py_None);
  __pyx_v_i = Py_None; Py_INCREF(Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":135 */
  __pyx_1 = PyList_New(0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; goto __pyx_L1;}
  Py_DECREF(__pyx_v_aList);
  __pyx_v_aList = __pyx_1;
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":136 */
  for (__pyx_2 = 0; __pyx_2 < __pyx_v_dim; ++__pyx_2) {
    __pyx_1 = PyInt_FromLong(__pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; goto __pyx_L1;}
    Py_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_1;
    __pyx_1 = 0;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":137 */
    __pyx_1 = PyObject_GetAttr(__pyx_v_aList, __pyx_n_append); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; goto __pyx_L1;}
    __pyx_3 = PyInt_AsLong(__pyx_v_i); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; goto __pyx_L1;}
    __pyx_4 = PyFloat_FromDouble((__pyx_v_array[__pyx_3])); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; goto __pyx_L1;}
    __pyx_5 = PyTuple_New(1); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_5, 0, __pyx_4);
    __pyx_4 = 0;
    __pyx_4 = PyObject_CallObject(__pyx_1, __pyx_5); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/array.pyx":138 */
  Py_INCREF(__pyx_v_aList);
  __pyx_r = __pyx_v_aList;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  __Pyx_AddTraceback("PyLithLib.listFromDoubleArray");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_aList);
  Py_DECREF(__pyx_v_i);
  return __pyx_r;
}

static PyObject *__pyx_n_unknown;
static PyObject *__pyx_n_lower;
static PyObject *__pyx_n_old;
static PyObject *__pyx_n_new;
static PyObject *__pyx_n_scratch;
static PyObject *__pyx_n_ValueError;
static PyObject *__pyx_n_sequential;
static PyObject *__pyx_n_direct;
static PyObject *__pyx_n_formatted;
static PyObject *__pyx_n_unformatted;
static PyObject *__pyx_n_IOError;

static PyObject *__pyx_k14p;
static PyObject *__pyx_k17p;
static PyObject *__pyx_k19p;
static PyObject *__pyx_k20p;
static PyObject *__pyx_k26p;
static PyObject *__pyx_k27p;

static char (__pyx_k14[]) = "status=\'%s\': \'status\' must be in %s";
static char (__pyx_k17[]) = "\'recl\' must be omitted for \'sequential\' access";
static char (__pyx_k19[]) = "\'recl\' must be given for \'direct\' access";
static char (__pyx_k20[]) = "access=\'%s\': \'access\' must be \'sequential\' or \'direct\'";
static char (__pyx_k26[]) = "form=\'%s\': \'form\' must be \'formatted\' or \'unformatted\'";
static char (__pyx_k27[]) = "open: Fortran I/O error %d";

static PyObject *__pyx_f_9PyLithLib_f77open(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_9PyLithLib_f77open(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_unit = 0;
  PyObject *__pyx_v_file = 0;
  PyObject *__pyx_v_status = 0;
  PyObject *__pyx_v_access = 0;
  PyObject *__pyx_v_form = 0;
  PyObject *__pyx_v_recl = 0;
  PyObject *__pyx_v_statusChoices;
  int __pyx_v_u;
  int __pyx_v_ios;
  int __pyx_v_rl;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  PyObject *__pyx_5 = 0;
  char (*__pyx_6);
  char (*__pyx_7);
  char (*__pyx_8);
  char (*__pyx_9);
  size_t __pyx_10;
  size_t __pyx_11;
  size_t __pyx_12;
  size_t __pyx_13;
  static char *__pyx_argnames[] = {"unit","file","status","access","form","recl",0};
  __pyx_v_status = __pyx_k1;
  __pyx_v_access = __pyx_k2;
  __pyx_v_form = __pyx_k3;
  __pyx_v_recl = __pyx_k4;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "OO|OOOO", __pyx_argnames, &__pyx_v_unit, &__pyx_v_file, &__pyx_v_status, &__pyx_v_access, &__pyx_v_form, &__pyx_v_recl)) return 0;
  Py_INCREF(__pyx_v_unit);
  Py_INCREF(__pyx_v_file);
  Py_INCREF(__pyx_v_status);
  Py_INCREF(__pyx_v_access);
  Py_INCREF(__pyx_v_form);
  Py_INCREF(__pyx_v_recl);
  __pyx_v_statusChoices = Py_None; Py_INCREF(Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":38 */
  __pyx_1 = __pyx_v_status == Py_None;
  if (__pyx_1) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":39 */
    Py_INCREF(__pyx_n_unknown);
    Py_DECREF(__pyx_v_status);
    __pyx_v_status = __pyx_n_unknown;
    goto __pyx_L2;
  }
  /*else*/ {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":41 */
    __pyx_2 = PyObject_GetAttr(__pyx_v_status, __pyx_n_lower); if (!__pyx_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 41; goto __pyx_L1;}
    __pyx_3 = PyObject_CallObject(__pyx_2, 0); if (!__pyx_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 41; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_v_status);
    __pyx_v_status = __pyx_3;
    __pyx_3 = 0;
  }
  __pyx_L2:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":42 */
  __pyx_2 = PyList_New(4); if (!__pyx_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 42; goto __pyx_L1;}
  Py_INCREF(__pyx_n_old);
  PyList_SET_ITEM(__pyx_2, 0, __pyx_n_old);
  Py_INCREF(__pyx_n_new);
  PyList_SET_ITEM(__pyx_2, 1, __pyx_n_new);
  Py_INCREF(__pyx_n_scratch);
  PyList_SET_ITEM(__pyx_2, 2, __pyx_n_scratch);
  Py_INCREF(__pyx_n_unknown);
  PyList_SET_ITEM(__pyx_2, 3, __pyx_n_unknown);
  Py_DECREF(__pyx_v_statusChoices);
  __pyx_v_statusChoices = __pyx_2;
  __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":43 */
  __pyx_1 = PySequence_Contains(__pyx_v_statusChoices, __pyx_v_status); if (__pyx_1 < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 43; goto __pyx_L1;}
  __pyx_4 = (!__pyx_1);
  if (__pyx_4) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":44 */
    __pyx_3 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 44; goto __pyx_L1;}
    __pyx_2 = PyTuple_New(2); if (!__pyx_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 44; goto __pyx_L1;}
    Py_INCREF(__pyx_v_status);
    PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_status);
    Py_INCREF(__pyx_v_statusChoices);
    PyTuple_SET_ITEM(__pyx_2, 1, __pyx_v_statusChoices);
    __pyx_5 = PyNumber_Remainder(__pyx_k14p, __pyx_2); if (!__pyx_5) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 44; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 44; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_2, 0, __pyx_5);
    __pyx_5 = 0;
    __pyx_5 = PyObject_CallObject(__pyx_3, __pyx_2); if (!__pyx_5) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 44; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __Pyx_Raise(__pyx_5, 0, 0);
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    {__pyx_filename = __pyx_f[1]; __pyx_lineno = 44; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":47 */
  __pyx_1 = __pyx_v_access == Py_None;
  if (__pyx_1) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":48 */
    Py_INCREF(__pyx_n_sequential);
    Py_DECREF(__pyx_v_access);
    __pyx_v_access = __pyx_n_sequential;
    goto __pyx_L4;
  }
  /*else*/ {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":50 */
    __pyx_3 = PyObject_GetAttr(__pyx_v_access, __pyx_n_lower); if (!__pyx_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 50; goto __pyx_L1;}
    __pyx_2 = PyObject_CallObject(__pyx_3, 0); if (!__pyx_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 50; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_v_access);
    __pyx_v_access = __pyx_2;
    __pyx_2 = 0;
  }
  __pyx_L4:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":51 */
  if (PyObject_Cmp(__pyx_v_access, __pyx_n_sequential, &__pyx_4) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 51; goto __pyx_L1;}
  __pyx_4 = __pyx_4 == 0;
  if (__pyx_4) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":53 */
    __pyx_1 = __pyx_v_recl != Py_None;
    if (__pyx_1) {

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":54 */
      __pyx_5 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_5) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 54; goto __pyx_L1;}
      __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 54; goto __pyx_L1;}
      Py_INCREF(__pyx_k17p);
      PyTuple_SET_ITEM(__pyx_3, 0, __pyx_k17p);
      __pyx_2 = PyObject_CallObject(__pyx_5, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 54; goto __pyx_L1;}
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      __Pyx_Raise(__pyx_2, 0, 0);
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 54; goto __pyx_L1;}
      goto __pyx_L6;
    }
    /*else*/ {

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":56 */
      __pyx_5 = PyInt_FromLong(0); if (!__pyx_5) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 56; goto __pyx_L1;}
      Py_DECREF(__pyx_v_recl);
      __pyx_v_recl = __pyx_5;
      __pyx_5 = 0;
    }
    __pyx_L6:;
    goto __pyx_L5;
  }
  if (PyObject_Cmp(__pyx_v_access, __pyx_n_direct, &__pyx_4) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 57; goto __pyx_L1;}
  __pyx_4 = __pyx_4 == 0;
  if (__pyx_4) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":59 */
    __pyx_1 = __pyx_v_recl == Py_None;
    if (__pyx_1) {

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":60 */
      __pyx_3 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 60; goto __pyx_L1;}
      __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 60; goto __pyx_L1;}
      Py_INCREF(__pyx_k19p);
      PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k19p);
      __pyx_5 = PyObject_CallObject(__pyx_3, __pyx_2); if (!__pyx_5) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 60; goto __pyx_L1;}
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      __Pyx_Raise(__pyx_5, 0, 0);
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 60; goto __pyx_L1;}
      goto __pyx_L7;
    }
    __pyx_L7:;
    goto __pyx_L5;
  }
  /*else*/ {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":62 */
    __pyx_3 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 62; goto __pyx_L1;}
    __pyx_2 = PyNumber_Remainder(__pyx_k20p, __pyx_v_access); if (!__pyx_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 62; goto __pyx_L1;}
    __pyx_5 = PyTuple_New(1); if (!__pyx_5) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 62; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_5, 0, __pyx_2);
    __pyx_2 = 0;
    __pyx_2 = PyObject_CallObject(__pyx_3, __pyx_5); if (!__pyx_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 62; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[1]; __pyx_lineno = 62; goto __pyx_L1;}
  }
  __pyx_L5:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":64 */
  __pyx_4 = __pyx_v_form == Py_None;
  if (__pyx_4) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":65 */
    if (PyObject_Cmp(__pyx_v_access, __pyx_n_sequential, &__pyx_1) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 65; goto __pyx_L1;}
    __pyx_1 = __pyx_1 == 0;
    if (__pyx_1) {

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":66 */
      Py_INCREF(__pyx_n_formatted);
      Py_DECREF(__pyx_v_form);
      __pyx_v_form = __pyx_n_formatted;
      goto __pyx_L9;
    }
    /*else*/ {

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":68 */
      Py_INCREF(__pyx_n_unformatted);
      Py_DECREF(__pyx_v_form);
      __pyx_v_form = __pyx_n_unformatted;
    }
    __pyx_L9:;
    goto __pyx_L8;
  }
  /*else*/ {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":70 */
    __pyx_3 = PyList_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 70; goto __pyx_L1;}
    Py_INCREF(__pyx_n_formatted);
    PyList_SET_ITEM(__pyx_3, 0, __pyx_n_formatted);
    Py_INCREF(__pyx_n_unformatted);
    PyList_SET_ITEM(__pyx_3, 1, __pyx_n_unformatted);
    __pyx_4 = PySequence_Contains(__pyx_3, __pyx_v_form); if (__pyx_4 < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 70; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_1 = (!__pyx_4);
    if (__pyx_1) {

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":71 */
      __pyx_5 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_5) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 71; goto __pyx_L1;}
      __pyx_2 = PyNumber_Remainder(__pyx_k26p, __pyx_v_form); if (!__pyx_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 71; goto __pyx_L1;}
      __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 71; goto __pyx_L1;}
      PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
      __pyx_2 = 0;
      __pyx_2 = PyObject_CallObject(__pyx_5, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 71; goto __pyx_L1;}
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      __Pyx_Raise(__pyx_2, 0, 0);
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      {__pyx_filename = __pyx_f[1]; __pyx_lineno = 71; goto __pyx_L1;}
      goto __pyx_L10;
    }
    __pyx_L10:;
  }
  __pyx_L8:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":74 */
  __pyx_4 = PyInt_AsLong(__pyx_v_unit); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 74; goto __pyx_L1;}
  __pyx_v_u = __pyx_4;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":75 */
  __pyx_v_ios = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":76 */
  __pyx_1 = PyInt_AsLong(__pyx_v_recl); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 76; goto __pyx_L1;}
  __pyx_v_rl = __pyx_1;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":77 */
  __pyx_6 = PyString_AsString(__pyx_v_file); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 77; goto __pyx_L1;}
  __pyx_7 = PyString_AsString(__pyx_v_status); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 77; goto __pyx_L1;}
  __pyx_8 = PyString_AsString(__pyx_v_access); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 77; goto __pyx_L1;}
  __pyx_9 = PyString_AsString(__pyx_v_form); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 77; goto __pyx_L1;}
  __pyx_5 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_5) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 78; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 78; goto __pyx_L1;}
  Py_INCREF(__pyx_v_file);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_file);
  __pyx_2 = PyObject_CallObject(__pyx_5, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 78; goto __pyx_L1;}
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_10 = PyInt_AsUnsignedLongMask(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 78; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_5 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_5) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 78; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 78; goto __pyx_L1;}
  Py_INCREF(__pyx_v_status);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_status);
  __pyx_2 = PyObject_CallObject(__pyx_5, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 78; goto __pyx_L1;}
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_11 = PyInt_AsUnsignedLongMask(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 78; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_5 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_5) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 78; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 78; goto __pyx_L1;}
  Py_INCREF(__pyx_v_access);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_access);
  __pyx_2 = PyObject_CallObject(__pyx_5, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 78; goto __pyx_L1;}
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_12 = PyInt_AsUnsignedLongMask(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 78; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_5 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_5) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 78; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 78; goto __pyx_L1;}
  Py_INCREF(__pyx_v_form);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_form);
  __pyx_2 = PyObject_CallObject(__pyx_5, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 78; goto __pyx_L1;}
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_13 = PyInt_AsUnsignedLongMask(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 78; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  FC_FUNC(f77open, F77OPEN)((&__pyx_v_u),(&__pyx_v_ios),__pyx_6,__pyx_7,__pyx_8,__pyx_9,(&__pyx_v_rl),__pyx_10,__pyx_11,__pyx_12,__pyx_13); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 77; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":79 */
  __pyx_4 = (__pyx_v_ios != 0);
  if (__pyx_4) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":80 */
    __pyx_5 = __Pyx_GetName(__pyx_b, __pyx_n_IOError); if (!__pyx_5) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 80; goto __pyx_L1;}
    __pyx_3 = PyInt_FromLong(__pyx_v_ios); if (!__pyx_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 80; goto __pyx_L1;}
    __pyx_2 = PyNumber_Remainder(__pyx_k27p, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 80; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 80; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
    __pyx_2 = 0;
    __pyx_2 = PyObject_CallObject(__pyx_5, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 80; goto __pyx_L1;}
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[1]; __pyx_lineno = 80; goto __pyx_L1;}
    goto __pyx_L11;
  }
  __pyx_L11:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":82 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_5);
  __Pyx_AddTraceback("PyLithLib.f77open");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_statusChoices);
  Py_DECREF(__pyx_v_unit);
  Py_DECREF(__pyx_v_file);
  Py_DECREF(__pyx_v_status);
  Py_DECREF(__pyx_v_access);
  Py_DECREF(__pyx_v_form);
  Py_DECREF(__pyx_v_recl);
  return __pyx_r;
}

static PyObject *__pyx_k28p;

static char (__pyx_k28[]) = "close: Fortran I/O error %d";

static PyObject *__pyx_f_9PyLithLib_f77close(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_9PyLithLib_f77close(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_unit = 0;
  int __pyx_v_u;
  int __pyx_v_ios;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  static char *__pyx_argnames[] = {"unit",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_unit)) return 0;
  Py_INCREF(__pyx_v_unit);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":87 */
  __pyx_1 = PyInt_AsLong(__pyx_v_unit); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 87; goto __pyx_L1;}
  __pyx_v_u = __pyx_1;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":88 */
  __pyx_v_ios = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":89 */
  FC_FUNC(f77close, F77CLOSE)((&__pyx_v_u),(&__pyx_v_ios)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 89; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":90 */
  __pyx_1 = (__pyx_v_ios != 0);
  if (__pyx_1) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":91 */
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_IOError); if (!__pyx_2) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 91; goto __pyx_L1;}
    __pyx_3 = PyInt_FromLong(__pyx_v_ios); if (!__pyx_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 91; goto __pyx_L1;}
    __pyx_4 = PyNumber_Remainder(__pyx_k28p, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 91; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 91; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_4);
    __pyx_4 = 0;
    __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 91; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __Pyx_Raise(__pyx_4, 0, 0);
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    {__pyx_filename = __pyx_f[1]; __pyx_lineno = 91; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":92 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("PyLithLib.f77close");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_unit);
  return __pyx_r;
}

static PyObject *__pyx_n_RuntimeError;

static PyObject *__pyx_k29p;

static char (__pyx_k29[]) = "PetscInitialize: error %d: %s (%s)";

static PyObject *__pyx_f_9PyLithLib_PetscInitialize(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_9PyLithLib_PetscInitialize(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_file = 0;
  PyObject *__pyx_v_help = 0;
  int __pyx_v_argc;
  char (*(*__pyx_v_cargs));
  int __pyx_v_i;
  char (*__pyx_v_carg);
  PyObject *__pyx_v_arg;
  char (*__pyx_v_cfile);
  char (*__pyx_v_chelp);
  int __pyx_v_errnum;
  const_char (*__pyx_v_text);
  char (*__pyx_v_specific);
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  char (*__pyx_5);
  unsigned int __pyx_6;
  PyObject *__pyx_7 = 0;
  PyObject *__pyx_8 = 0;
  static char *__pyx_argnames[] = {"args","file","help",0};
  __pyx_v_file = __pyx_k5;
  __pyx_v_help = __pyx_k6;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O|OO", __pyx_argnames, &__pyx_v_args, &__pyx_v_file, &__pyx_v_help)) return 0;
  Py_INCREF(__pyx_v_args);
  Py_INCREF(__pyx_v_file);
  Py_INCREF(__pyx_v_help);
  __pyx_v_arg = Py_None; Py_INCREF(Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":45 */
  __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_1) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 45; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 45; goto __pyx_L1;}
  Py_INCREF(__pyx_v_args);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_args);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 45; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_4 = PyInt_AsLong(__pyx_3); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 45; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_v_argc = __pyx_4;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":46 */
  __pyx_v_cargs = ((char (*(*)))malloc(((__pyx_v_argc + 1) * (sizeof(char (*))))));

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":50 */
  for (__pyx_v_i = 0; __pyx_v_i < __pyx_v_argc; ++__pyx_v_i) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":51 */
    __pyx_1 = PyInt_FromLong(__pyx_v_i); if (!__pyx_1) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 51; goto __pyx_L1;}
    __pyx_2 = PyObject_GetItem(__pyx_v_args, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 51; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_v_arg);
    __pyx_v_arg = __pyx_2;
    __pyx_2 = 0;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":52 */
    __pyx_5 = PyString_AsString(__pyx_v_arg); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 52; goto __pyx_L1;}
    __pyx_v_carg = __pyx_5;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":53 */
    __pyx_3 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_3) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 53; goto __pyx_L1;}
    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 53; goto __pyx_L1;}
    Py_INCREF(__pyx_v_arg);
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_arg);
    __pyx_2 = PyObject_CallObject(__pyx_3, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 53; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __pyx_3 = PyInt_FromLong(1); if (!__pyx_3) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 53; goto __pyx_L1;}
    __pyx_1 = PyNumber_Add(__pyx_2, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 53; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_2 = PyInt_FromLong((sizeof(char ))); if (!__pyx_2) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 53; goto __pyx_L1;}
    __pyx_3 = PyNumber_Multiply(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 53; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_6 = PyInt_AsUnsignedLongMask(__pyx_3); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 53; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    (__pyx_v_cargs[__pyx_v_i]) = ((char (*))malloc(__pyx_6));

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":54 */
    strcpy((__pyx_v_cargs[__pyx_v_i]),__pyx_v_carg);
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":56 */
  (__pyx_v_cargs[__pyx_v_argc]) = NULL;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":59 */
  __pyx_v_cfile = NULL;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":60 */
  __pyx_v_chelp = NULL;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":61 */
  __pyx_4 = __pyx_v_file != Py_None;
  if (__pyx_4) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":63 */
    if (PyObject_SetAttr(__pyx_m, __pyx_n_gfile, __pyx_v_file) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 63; goto __pyx_L1;}

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":64 */
    __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_gfile); if (!__pyx_1) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 64; goto __pyx_L1;}
    __pyx_5 = PyString_AsString(__pyx_1); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 64; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __pyx_v_cfile = __pyx_5;
    goto __pyx_L4;
  }
  __pyx_L4:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":65 */
  __pyx_4 = __pyx_v_help != Py_None;
  if (__pyx_4) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":67 */
    if (PyObject_SetAttr(__pyx_m, __pyx_n_ghelp, __pyx_v_help) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 67; goto __pyx_L1;}

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":68 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_ghelp); if (!__pyx_2) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 68; goto __pyx_L1;}
    __pyx_5 = PyString_AsString(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 68; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_v_chelp = __pyx_5;
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":73 */
  __pyx_v_errnum = PetscInitialize((&__pyx_v_argc),(&__pyx_v_cargs),__pyx_v_cfile,__pyx_v_chelp);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":74 */
  __pyx_4 = (__pyx_v_errnum != 0);
  if (__pyx_4) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":75 */
    PetscErrorMessage(__pyx_v_errnum,(&__pyx_v_text),(&__pyx_v_specific));

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":76 */
    __pyx_3 = __Pyx_GetName(__pyx_b, __pyx_n_RuntimeError); if (!__pyx_3) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 76; goto __pyx_L1;}
    __pyx_1 = PyInt_FromLong(__pyx_v_errnum); if (!__pyx_1) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 77; goto __pyx_L1;}
    __pyx_2 = PyString_FromString(((char (*))__pyx_v_text)); if (!__pyx_2) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 77; goto __pyx_L1;}
    __pyx_7 = PyString_FromString(__pyx_v_specific); if (!__pyx_7) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 77; goto __pyx_L1;}
    __pyx_8 = PyTuple_New(3); if (!__pyx_8) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 77; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_8, 0, __pyx_1);
    PyTuple_SET_ITEM(__pyx_8, 1, __pyx_2);
    PyTuple_SET_ITEM(__pyx_8, 2, __pyx_7);
    __pyx_1 = 0;
    __pyx_2 = 0;
    __pyx_7 = 0;
    __pyx_1 = PyNumber_Remainder(__pyx_k29p, __pyx_8); if (!__pyx_1) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 76; goto __pyx_L1;}
    Py_DECREF(__pyx_8); __pyx_8 = 0;
    __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 76; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
    __pyx_1 = 0;
    __pyx_7 = PyObject_CallObject(__pyx_3, __pyx_2); if (!__pyx_7) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 76; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __Pyx_Raise(__pyx_7, 0, 0);
    Py_DECREF(__pyx_7); __pyx_7 = 0;
    {__pyx_filename = __pyx_f[2]; __pyx_lineno = 76; goto __pyx_L1;}
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":81 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_7);
  Py_XDECREF(__pyx_8);
  __Pyx_AddTraceback("PyLithLib.PetscInitialize");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_arg);
  Py_DECREF(__pyx_v_args);
  Py_DECREF(__pyx_v_file);
  Py_DECREF(__pyx_v_help);
  return __pyx_r;
}

static PyObject *__pyx_k30p;

static char (__pyx_k30[]) = "PetscFinalize: error %d: %s (%s)";

static PyObject *__pyx_f_9PyLithLib_PetscFinalize(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_9PyLithLib_PetscFinalize(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_errnum;
  const_char (*__pyx_v_text);
  char (*__pyx_v_specific);
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  PyObject *__pyx_6 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":89 */
  __pyx_v_errnum = PetscFinalize();

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":90 */
  __pyx_1 = (__pyx_v_errnum != 0);
  if (__pyx_1) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":91 */
    PetscErrorMessage(__pyx_v_errnum,(&__pyx_v_text),(&__pyx_v_specific));

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":92 */
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_RuntimeError); if (!__pyx_2) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 92; goto __pyx_L1;}
    __pyx_3 = PyInt_FromLong(__pyx_v_errnum); if (!__pyx_3) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 93; goto __pyx_L1;}
    __pyx_4 = PyString_FromString(((char (*))__pyx_v_text)); if (!__pyx_4) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 93; goto __pyx_L1;}
    __pyx_5 = PyString_FromString(__pyx_v_specific); if (!__pyx_5) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 93; goto __pyx_L1;}
    __pyx_6 = PyTuple_New(3); if (!__pyx_6) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 93; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_6, 0, __pyx_3);
    PyTuple_SET_ITEM(__pyx_6, 1, __pyx_4);
    PyTuple_SET_ITEM(__pyx_6, 2, __pyx_5);
    __pyx_3 = 0;
    __pyx_4 = 0;
    __pyx_5 = 0;
    __pyx_3 = PyNumber_Remainder(__pyx_k30p, __pyx_6); if (!__pyx_3) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 92; goto __pyx_L1;}
    Py_DECREF(__pyx_6); __pyx_6 = 0;
    __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 92; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_4, 0, __pyx_3);
    __pyx_3 = 0;
    __pyx_5 = PyObject_CallObject(__pyx_2, __pyx_4); if (!__pyx_5) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 92; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    __Pyx_Raise(__pyx_5, 0, 0);
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    {__pyx_filename = __pyx_f[2]; __pyx_lineno = 92; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":95 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  Py_XDECREF(__pyx_6);
  __Pyx_AddTraceback("PyLithLib.PetscFinalize");
  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}

static PyObject *__pyx_k31p;

static char (__pyx_k31[]) = "PetscLogStageRegister('%s'): error %d: %s (%s)";

static PetscInt __pyx_f_9PyLithLib_PetscLogStageRegister(PyObject *__pyx_v_sname) {
  int __pyx_v_errnum;
  const_char (*__pyx_v_text);
  char (*__pyx_v_specific);
  PetscInt __pyx_v_stage;
  PetscInt __pyx_r;
  char (*__pyx_1);
  int __pyx_2;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  PyObject *__pyx_6 = 0;
  PyObject *__pyx_7 = 0;
  Py_INCREF(__pyx_v_sname);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":104 */
  __pyx_1 = PyString_AsString(__pyx_v_sname); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 104; goto __pyx_L1;}
  __pyx_v_errnum = PetscLogStageRegister((&__pyx_v_stage),__pyx_1);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":105 */
  __pyx_2 = (__pyx_v_errnum != 0);
  if (__pyx_2) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":106 */
    PetscErrorMessage(__pyx_v_errnum,(&__pyx_v_text),(&__pyx_v_specific));

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":107 */
    __pyx_3 = __Pyx_GetName(__pyx_b, __pyx_n_RuntimeError); if (!__pyx_3) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 107; goto __pyx_L1;}
    __pyx_4 = PyInt_FromLong(__pyx_v_errnum); if (!__pyx_4) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 108; goto __pyx_L1;}
    __pyx_5 = PyString_FromString(((char (*))__pyx_v_text)); if (!__pyx_5) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 108; goto __pyx_L1;}
    __pyx_6 = PyString_FromString(__pyx_v_specific); if (!__pyx_6) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 108; goto __pyx_L1;}
    __pyx_7 = PyTuple_New(4); if (!__pyx_7) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 108; goto __pyx_L1;}
    Py_INCREF(__pyx_v_sname);
    PyTuple_SET_ITEM(__pyx_7, 0, __pyx_v_sname);
    PyTuple_SET_ITEM(__pyx_7, 1, __pyx_4);
    PyTuple_SET_ITEM(__pyx_7, 2, __pyx_5);
    PyTuple_SET_ITEM(__pyx_7, 3, __pyx_6);
    __pyx_4 = 0;
    __pyx_5 = 0;
    __pyx_6 = 0;
    __pyx_4 = PyNumber_Remainder(__pyx_k31p, __pyx_7); if (!__pyx_4) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 107; goto __pyx_L1;}
    Py_DECREF(__pyx_7); __pyx_7 = 0;
    __pyx_5 = PyTuple_New(1); if (!__pyx_5) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 107; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_5, 0, __pyx_4);
    __pyx_4 = 0;
    __pyx_6 = PyObject_CallObject(__pyx_3, __pyx_5); if (!__pyx_6) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 107; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    __Pyx_Raise(__pyx_6, 0, 0);
    Py_DECREF(__pyx_6); __pyx_6 = 0;
    {__pyx_filename = __pyx_f[2]; __pyx_lineno = 107; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":110 */
  __pyx_r = __pyx_v_stage;
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  Py_XDECREF(__pyx_6);
  Py_XDECREF(__pyx_7);
  __Pyx_WriteUnraisable("PyLithLib.PetscLogStageRegister");
  __pyx_L0:;
  Py_DECREF(__pyx_v_sname);
  return __pyx_r;
}

static PyObject *__pyx_k32p;

static char (__pyx_k32[]) = "PetscLogEventRegister('%s'): error %d: %s (%s)";

static PetscEvent __pyx_f_9PyLithLib_PetscLogEventRegister(PyObject *__pyx_v_name,PetscCookie __pyx_v_cookie) {
  int __pyx_v_errnum;
  const_char (*__pyx_v_text);
  char (*__pyx_v_specific);
  PetscEvent __pyx_v_event;
  PetscEvent __pyx_r;
  char (*__pyx_1);
  int __pyx_2;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  PyObject *__pyx_6 = 0;
  PyObject *__pyx_7 = 0;
  Py_INCREF(__pyx_v_name);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":119 */
  __pyx_1 = PyString_AsString(__pyx_v_name); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 119; goto __pyx_L1;}
  __pyx_v_errnum = PetscLogEventRegister((&__pyx_v_event),__pyx_1,__pyx_v_cookie);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":120 */
  __pyx_2 = (__pyx_v_errnum != 0);
  if (__pyx_2) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":121 */
    PetscErrorMessage(__pyx_v_errnum,(&__pyx_v_text),(&__pyx_v_specific));

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":122 */
    __pyx_3 = __Pyx_GetName(__pyx_b, __pyx_n_RuntimeError); if (!__pyx_3) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 122; goto __pyx_L1;}
    __pyx_4 = PyInt_FromLong(__pyx_v_errnum); if (!__pyx_4) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 123; goto __pyx_L1;}
    __pyx_5 = PyString_FromString(((char (*))__pyx_v_text)); if (!__pyx_5) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 123; goto __pyx_L1;}
    __pyx_6 = PyString_FromString(__pyx_v_specific); if (!__pyx_6) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 123; goto __pyx_L1;}
    __pyx_7 = PyTuple_New(4); if (!__pyx_7) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 123; goto __pyx_L1;}
    Py_INCREF(__pyx_v_name);
    PyTuple_SET_ITEM(__pyx_7, 0, __pyx_v_name);
    PyTuple_SET_ITEM(__pyx_7, 1, __pyx_4);
    PyTuple_SET_ITEM(__pyx_7, 2, __pyx_5);
    PyTuple_SET_ITEM(__pyx_7, 3, __pyx_6);
    __pyx_4 = 0;
    __pyx_5 = 0;
    __pyx_6 = 0;
    __pyx_4 = PyNumber_Remainder(__pyx_k32p, __pyx_7); if (!__pyx_4) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 122; goto __pyx_L1;}
    Py_DECREF(__pyx_7); __pyx_7 = 0;
    __pyx_5 = PyTuple_New(1); if (!__pyx_5) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 122; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_5, 0, __pyx_4);
    __pyx_4 = 0;
    __pyx_6 = PyObject_CallObject(__pyx_3, __pyx_5); if (!__pyx_6) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 122; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    __Pyx_Raise(__pyx_6, 0, 0);
    Py_DECREF(__pyx_6); __pyx_6 = 0;
    {__pyx_filename = __pyx_f[2]; __pyx_lineno = 122; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":125 */
  __pyx_r = __pyx_v_event;
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  Py_XDECREF(__pyx_6);
  Py_XDECREF(__pyx_7);
  __Pyx_WriteUnraisable("PyLithLib.PetscLogEventRegister");
  __pyx_L0:;
  Py_DECREF(__pyx_v_name);
  return __pyx_r;
}

static PyObject *__pyx_k33p;

static char (__pyx_k33[]) = "PetscLogStagePush: error %d: %s (%s)";

static PyObject *__pyx_f_9PyLithLib_PetscLogStagePush(int __pyx_v_stage) {
  int __pyx_v_errnum;
  const_char (*__pyx_v_text);
  char (*__pyx_v_specific);
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  PyObject *__pyx_6 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":133 */
  __pyx_v_errnum = PetscLogStagePush(__pyx_v_stage);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":134 */
  __pyx_1 = (__pyx_v_errnum != 0);
  if (__pyx_1) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":135 */
    PetscErrorMessage(__pyx_v_errnum,(&__pyx_v_text),(&__pyx_v_specific));

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":136 */
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_RuntimeError); if (!__pyx_2) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 136; goto __pyx_L1;}
    __pyx_3 = PyInt_FromLong(__pyx_v_errnum); if (!__pyx_3) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 137; goto __pyx_L1;}
    __pyx_4 = PyString_FromString(((char (*))__pyx_v_text)); if (!__pyx_4) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 137; goto __pyx_L1;}
    __pyx_5 = PyString_FromString(__pyx_v_specific); if (!__pyx_5) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 137; goto __pyx_L1;}
    __pyx_6 = PyTuple_New(3); if (!__pyx_6) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 137; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_6, 0, __pyx_3);
    PyTuple_SET_ITEM(__pyx_6, 1, __pyx_4);
    PyTuple_SET_ITEM(__pyx_6, 2, __pyx_5);
    __pyx_3 = 0;
    __pyx_4 = 0;
    __pyx_5 = 0;
    __pyx_3 = PyNumber_Remainder(__pyx_k33p, __pyx_6); if (!__pyx_3) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 136; goto __pyx_L1;}
    Py_DECREF(__pyx_6); __pyx_6 = 0;
    __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 136; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_4, 0, __pyx_3);
    __pyx_3 = 0;
    __pyx_5 = PyObject_CallObject(__pyx_2, __pyx_4); if (!__pyx_5) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 136; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    __Pyx_Raise(__pyx_5, 0, 0);
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    {__pyx_filename = __pyx_f[2]; __pyx_lineno = 136; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":139 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  Py_XDECREF(__pyx_6);
  __Pyx_AddTraceback("PyLithLib.PetscLogStagePush");
  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}

static PyObject *__pyx_k34p;

static char (__pyx_k34[]) = "PetscLogStagePop: error %d: %s (%s)";

static PyObject *__pyx_f_9PyLithLib_PetscLogStagePop(void) {
  int __pyx_v_errnum;
  const_char (*__pyx_v_text);
  char (*__pyx_v_specific);
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  PyObject *__pyx_6 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":147 */
  __pyx_v_errnum = PetscLogStagePop();

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":148 */
  __pyx_1 = (__pyx_v_errnum != 0);
  if (__pyx_1) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":149 */
    PetscErrorMessage(__pyx_v_errnum,(&__pyx_v_text),(&__pyx_v_specific));

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":150 */
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_RuntimeError); if (!__pyx_2) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 150; goto __pyx_L1;}
    __pyx_3 = PyInt_FromLong(__pyx_v_errnum); if (!__pyx_3) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 151; goto __pyx_L1;}
    __pyx_4 = PyString_FromString(((char (*))__pyx_v_text)); if (!__pyx_4) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 151; goto __pyx_L1;}
    __pyx_5 = PyString_FromString(__pyx_v_specific); if (!__pyx_5) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 151; goto __pyx_L1;}
    __pyx_6 = PyTuple_New(3); if (!__pyx_6) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 151; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_6, 0, __pyx_3);
    PyTuple_SET_ITEM(__pyx_6, 1, __pyx_4);
    PyTuple_SET_ITEM(__pyx_6, 2, __pyx_5);
    __pyx_3 = 0;
    __pyx_4 = 0;
    __pyx_5 = 0;
    __pyx_3 = PyNumber_Remainder(__pyx_k34p, __pyx_6); if (!__pyx_3) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 150; goto __pyx_L1;}
    Py_DECREF(__pyx_6); __pyx_6 = 0;
    __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 150; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_4, 0, __pyx_3);
    __pyx_3 = 0;
    __pyx_5 = PyObject_CallObject(__pyx_2, __pyx_4); if (!__pyx_5) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 150; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    __Pyx_Raise(__pyx_5, 0, 0);
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    {__pyx_filename = __pyx_f[2]; __pyx_lineno = 150; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":153 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  Py_XDECREF(__pyx_6);
  __Pyx_AddTraceback("PyLithLib.PetscLogStagePop");
  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}

static int __pyx_f_9PyLithLib_6PyLith_4grav___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_gravity); /*proto*/
static int __pyx_f_9PyLithLib_6PyLith_4grav___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_gravity) {
  int __pyx_r;
  PyObject *__pyx_1 = 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_gravity);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":139 */
  __pyx_1 = __pyx_f_9PyLithLib_setDoubleArrayFromList((&(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_grav[0])),((sizeof(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_grav)) / (sizeof((((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_grav[0])))),__pyx_v_gravity); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 139; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("PyLithLib.PyLith.grav.__set__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_gravity);
  return __pyx_r;
}

static PyObject *__pyx_f_9PyLithLib_6PyLith_4grav___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_f_9PyLithLib_6PyLith_4grav___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":143 */
  __pyx_1 = __pyx_f_9PyLithLib_listFromDoubleArray((&(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_grav[0])),((sizeof(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_grav)) / (sizeof((((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_grav[0]))))); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 143; goto __pyx_L1;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("PyLithLib.PyLith.grav.__get__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static int __pyx_f_9PyLithLib_6PyLith_6prscal___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_prestressScale); /*proto*/
static int __pyx_f_9PyLithLib_6PyLith_6prscal___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_prestressScale) {
  int __pyx_r;
  PyObject *__pyx_1 = 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_prestressScale);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":148 */
  __pyx_1 = __pyx_f_9PyLithLib_setDoubleArrayFromList((&(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_prscal[0])),((sizeof(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_prscal)) / (sizeof((((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_prscal[0])))),__pyx_v_prestressScale); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 148; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("PyLithLib.PyLith.prscal.__set__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_prestressScale);
  return __pyx_r;
}

static PyObject *__pyx_f_9PyLithLib_6PyLith_6prscal___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_f_9PyLithLib_6PyLith_6prscal___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":152 */
  __pyx_1 = __pyx_f_9PyLithLib_listFromDoubleArray((&(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_prscal[0])),((sizeof(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_prscal)) / (sizeof((((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_prscal[0]))))); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 152; goto __pyx_L1;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("PyLithLib.PyLith.prscal.__get__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static int __pyx_f_9PyLithLib_6PyLith_5wscal___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_winklerScale); /*proto*/
static int __pyx_f_9PyLithLib_6PyLith_5wscal___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_winklerScale) {
  int __pyx_r;
  PyObject *__pyx_1 = 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_winklerScale);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":157 */
  __pyx_1 = __pyx_f_9PyLithLib_setDoubleArrayFromList((&(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_wscal[0])),((sizeof(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_wscal)) / (sizeof((((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_wscal[0])))),__pyx_v_winklerScale); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 157; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("PyLithLib.PyLith.wscal.__set__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_winklerScale);
  return __pyx_r;
}

static PyObject *__pyx_f_9PyLithLib_6PyLith_5wscal___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_f_9PyLithLib_6PyLith_5wscal___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":161 */
  __pyx_1 = __pyx_f_9PyLithLib_listFromDoubleArray((&(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_wscal[0])),((sizeof(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_wscal)) / (sizeof((((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_wscal[0]))))); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 161; goto __pyx_L1;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("PyLithLib.PyLith.wscal.__get__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static int __pyx_f_9PyLithLib_6PyLith_6wxscal___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_winklerSlipScale); /*proto*/
static int __pyx_f_9PyLithLib_6PyLith_6wxscal___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_winklerSlipScale) {
  int __pyx_r;
  PyObject *__pyx_1 = 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_winklerSlipScale);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":166 */
  __pyx_1 = __pyx_f_9PyLithLib_setDoubleArrayFromList((&(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_wxscal[0])),((sizeof(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_wxscal)) / (sizeof((((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_wxscal[0])))),__pyx_v_winklerSlipScale); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 166; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("PyLithLib.PyLith.wxscal.__set__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_winklerSlipScale);
  return __pyx_r;
}

static PyObject *__pyx_f_9PyLithLib_6PyLith_6wxscal___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_f_9PyLithLib_6PyLith_6wxscal___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":170 */
  __pyx_1 = __pyx_f_9PyLithLib_listFromDoubleArray((&(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_wxscal[0])),((sizeof(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_wxscal)) / (sizeof((((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_wxscal[0]))))); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 170; goto __pyx_L1;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("PyLithLib.PyLith.wxscal.__get__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static int __pyx_f_9PyLithLib_6PyLith_4prop___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_propertyList); /*proto*/
static int __pyx_f_9PyLithLib_6PyLith_4prop___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_propertyList) {
  int __pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_propertyList);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":181 */
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 181; goto __pyx_L1;}
  Py_INCREF(__pyx_v_propertyList);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_propertyList);
  __pyx_2 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 181; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 181; goto __pyx_L1;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_prop));
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_prop = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_2);
  __pyx_2 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("PyLithLib.PyLith.prop.__set__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_propertyList);
  return __pyx_r;
}

static PyObject *__pyx_f_9PyLithLib_6PyLith_4prop___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_f_9PyLithLib_6PyLith_4prop___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":183 */
  __pyx_1 = ((struct __pyx_vtabstruct_9PyLithLib_DoubleArray *)((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_prop->__pyx_vtab)->asList(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_prop); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 183; goto __pyx_L1;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("PyLithLib.PyLith.prop.__get__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static int __pyx_f_9PyLithLib_6PyLith_6infmat___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_materialModel); /*proto*/
static int __pyx_f_9PyLithLib_6PyLith_6infmat___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_materialModel) {
  int __pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_materialModel);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":187 */
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 187; goto __pyx_L1;}
  Py_INCREF(__pyx_v_materialModel);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_materialModel);
  __pyx_2 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 187; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 187; goto __pyx_L1;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_infmat));
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_infmat = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_2);
  __pyx_2 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("PyLithLib.PyLith.infmat.__set__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_materialModel);
  return __pyx_r;
}

static PyObject *__pyx_f_9PyLithLib_6PyLith_6infmat___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_f_9PyLithLib_6PyLith_6infmat___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":189 */
  __pyx_1 = ((struct __pyx_vtabstruct_9PyLithLib_IntArray *)((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_infmat->__pyx_vtab)->asList(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_infmat); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 189; goto __pyx_L1;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("PyLithLib.PyLith.infmat.__get__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_9PyLithLib_6PyLith_4mesh___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_f_9PyLithLib_6PyLith_4mesh___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(((PyObject *)((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_mesh));
  __pyx_r = ((PyObject *)((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_mesh);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static int __pyx_f_9PyLithLib_6PyLith_4mesh___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_mesh); /*proto*/
static int __pyx_f_9PyLithLib_6PyLith_4mesh___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_mesh) {
  int __pyx_r;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_mesh);
  if (!__Pyx_TypeTest(__pyx_v_mesh, __pyx_ptype_13PyLithMeshLib_Mesh)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 208; goto __pyx_L1;}
  Py_INCREF(__pyx_v_mesh);
  Py_DECREF(((PyObject *)((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_mesh));
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_mesh = ((struct PyMeshObject *)__pyx_v_mesh);

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  __Pyx_AddTraceback("PyLithLib.PyLith.mesh.__set__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_mesh);
  return __pyx_r;
}

static PyObject *__pyx_n_form;
static PyObject *__pyx_n_idsk;

static PyObject *__pyx_k37p;

static char (__pyx_k37[]) = "idsk (%d) is not in [0, 1, 2]";

static PyObject *__pyx_f_9PyLithLib_6PyLith_run(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_9PyLithLib_6PyLith_run(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_points = 0;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  int __pyx_2;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  int __pyx_6;
  PyObject *__pyx_7 = 0;
  PyObject *__pyx_8 = 0;
  static char *__pyx_argnames[] = {"points",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_points)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_points);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":213 */
  __pyx_1 = ((struct __pyx_vtabstruct_9PyLithLib_PyLith *)((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->__pyx_vtab)->scan(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 213; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":214 */
  __pyx_1 = ((struct __pyx_vtabstruct_9PyLithLib_PyLith *)((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->__pyx_vtab)->read(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 214; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":215 */
  __pyx_1 = ((struct __pyx_vtabstruct_9PyLithLib_PyLith *)((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->__pyx_vtab)->numberequations(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 215; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":216 */
  __pyx_1 = ((struct __pyx_vtabstruct_9PyLithLib_PyLith *)((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->__pyx_vtab)->sortmesh(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 216; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":217 */
  __pyx_1 = ((struct __pyx_vtabstruct_9PyLithLib_PyLith *)((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->__pyx_vtab)->sparsesetup(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 217; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":218 */
  __pyx_1 = ((struct __pyx_vtabstruct_9PyLithLib_PyLith *)((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->__pyx_vtab)->allocateremaining(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 218; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":225 */
  __pyx_2 = (((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->idout != 0);
  if (__pyx_2) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":226 */
    __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_f77open); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 226; goto __pyx_L1;}
    __pyx_3 = PyInt_FromLong(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->kw); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 226; goto __pyx_L1;}
    __pyx_4 = PyTuple_New(2); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 226; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_4, 0, __pyx_3);
    Py_INCREF(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->ofile);
    PyTuple_SET_ITEM(__pyx_4, 1, ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->ofile);
    __pyx_3 = 0;
    __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_4); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 226; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":229 */
  __pyx_2 = (((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->idsk == 0);
  if (__pyx_2) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":230 */
    goto __pyx_L3;
  }
  __pyx_2 = (((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->idsk == 1);
  if (__pyx_2) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":232 */
    __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_f77open); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 232; goto __pyx_L1;}
    __pyx_4 = PyInt_FromLong(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->kp); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 232; goto __pyx_L1;}
    __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 232; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_4);
    Py_INCREF(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->pfile);
    PyTuple_SET_ITEM(__pyx_3, 1, ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->pfile);
    __pyx_4 = 0;
    __pyx_4 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 232; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    goto __pyx_L3;
  }
  __pyx_2 = (((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->idsk == 2);
  if (__pyx_2) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":234 */
    __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_f77open); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 234; goto __pyx_L1;}
    __pyx_3 = PyInt_FromLong(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->kp); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 234; goto __pyx_L1;}
    __pyx_4 = PyTuple_New(2); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 234; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_4, 0, __pyx_3);
    Py_INCREF(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->pfile);
    PyTuple_SET_ITEM(__pyx_4, 1, ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->pfile);
    __pyx_3 = 0;
    __pyx_3 = PyDict_New(); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 234; goto __pyx_L1;}
    if (PyDict_SetItem(__pyx_3, __pyx_n_form, __pyx_n_unformatted) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 234; goto __pyx_L1;}
    __pyx_5 = PyEval_CallObjectWithKeywords(__pyx_1, __pyx_4, __pyx_3); if (!__pyx_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 234; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    goto __pyx_L3;
  }
  /*else*/ {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":236 */
    __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 236; goto __pyx_L1;}
    __pyx_4 = __Pyx_GetName(__pyx_b, __pyx_n_idsk); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 236; goto __pyx_L1;}
    __pyx_3 = PyNumber_Remainder(__pyx_k37p, __pyx_4); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 236; goto __pyx_L1;}
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    __pyx_5 = PyTuple_New(1); if (!__pyx_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 236; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_5, 0, __pyx_3);
    __pyx_3 = 0;
    __pyx_4 = PyObject_CallObject(__pyx_1, __pyx_5); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 236; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    __Pyx_Raise(__pyx_4, 0, 0);
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    {__pyx_filename = __pyx_f[3]; __pyx_lineno = 236; goto __pyx_L1;}
  }
  __pyx_L3:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":238 */
  /*try:*/ {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":239 */
    __pyx_3 = ((struct __pyx_vtabstruct_9PyLithLib_PyLith *)((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->__pyx_vtab)->meshwrite(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 239; goto __pyx_L5;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":241 */
    __pyx_2 = ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->generateGreen;
    if (__pyx_2) {

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":242 */
      __pyx_1 = ((struct __pyx_vtabstruct_9PyLithLib_PyLith *)((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->__pyx_vtab)->greenFunction(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self),__pyx_v_points); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 242; goto __pyx_L5;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      goto __pyx_L7;
    }
    /*else*/ {

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":244 */
      __pyx_5 = ((struct __pyx_vtabstruct_9PyLithLib_PyLith *)((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->__pyx_vtab)->runSimulation(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)); if (!__pyx_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 244; goto __pyx_L5;}
      Py_DECREF(__pyx_5); __pyx_5 = 0;
    }
    __pyx_L7:;
  }
  /*finally:*/ {
    int __pyx_why;
    __pyx_why = 0; goto __pyx_L6;
    __pyx_L5: {
      __pyx_why = 4;
      Py_XDECREF(__pyx_4); __pyx_4 = 0;
      Py_XDECREF(__pyx_3); __pyx_3 = 0;
      Py_XDECREF(__pyx_1); __pyx_1 = 0;
      Py_XDECREF(__pyx_5); __pyx_5 = 0;
      PyErr_Fetch(&__pyx_4, &__pyx_3, &__pyx_1);
      __pyx_2 = __pyx_lineno;
      goto __pyx_L6;
    }
    __pyx_L6:;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":248 */
    __pyx_6 = (((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->idout != 0);
    if (__pyx_6) {
      __pyx_5 = __Pyx_GetName(__pyx_m, __pyx_n_f77close); if (!__pyx_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 248; goto __pyx_L1;}
      __pyx_7 = PyInt_FromLong(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->kw); if (!__pyx_7) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 248; goto __pyx_L1;}
      __pyx_8 = PyTuple_New(1); if (!__pyx_8) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 248; goto __pyx_L1;}
      PyTuple_SET_ITEM(__pyx_8, 0, __pyx_7);
      __pyx_7 = 0;
      __pyx_7 = PyObject_CallObject(__pyx_5, __pyx_8); if (!__pyx_7) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 248; goto __pyx_L1;}
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      Py_DECREF(__pyx_8); __pyx_8 = 0;
      Py_DECREF(__pyx_7); __pyx_7 = 0;
      goto __pyx_L8;
    }
    __pyx_L8:;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":249 */
    __pyx_6 = (((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->idsk != 0);
    if (__pyx_6) {
      __pyx_5 = __Pyx_GetName(__pyx_m, __pyx_n_f77close); if (!__pyx_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 249; goto __pyx_L1;}
      __pyx_8 = PyInt_FromLong(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->kp); if (!__pyx_8) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 249; goto __pyx_L1;}
      __pyx_7 = PyTuple_New(1); if (!__pyx_7) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 249; goto __pyx_L1;}
      PyTuple_SET_ITEM(__pyx_7, 0, __pyx_8);
      __pyx_8 = 0;
      __pyx_8 = PyObject_CallObject(__pyx_5, __pyx_7); if (!__pyx_8) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 249; goto __pyx_L1;}
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      Py_DECREF(__pyx_7); __pyx_7 = 0;
      Py_DECREF(__pyx_8); __pyx_8 = 0;
      goto __pyx_L9;
    }
    __pyx_L9:;
    switch (__pyx_why) {
      case 3: goto __pyx_L0;
      case 4: {
        PyErr_Restore(__pyx_4, __pyx_3, __pyx_1);
        __pyx_lineno = __pyx_2;
        __pyx_4 = 0;
        __pyx_3 = 0;
        __pyx_1 = 0;
        goto __pyx_L1;
      }
    }
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":251 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  Py_XDECREF(__pyx_7);
  Py_XDECREF(__pyx_8);
  __Pyx_AddTraceback("PyLithLib.PyLith.run");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_points);
  return __pyx_r;
}

static int __pyx_f_9PyLithLib_6PyLith___new__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_9PyLithLib_6PyLith___new__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_dim;
  PyObject *__pyx_v_i;
  int __pyx_r;
  long __pyx_1;
  PyObject *__pyx_2 = 0;
  int __pyx_3;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return -1;
  Py_INCREF(__pyx_v_self);
  __pyx_v_i = Py_None; Py_INCREF(Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":457 */
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->idout = 1;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":458 */
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->idsk = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":459 */
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->iucd = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":462 */
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->icode = 3;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":463 */
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->pythonTimestep = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":464 */
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->generateGreen = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":465 */
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->idebug = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":466 */
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->ncycle = 1;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":469 */
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->iskopt = 2;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":475 */
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->stol = 1.0e-12;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":476 */
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->dtol = 1.0e-7;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":477 */
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->epert = 1.0e-1;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":479 */
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->nprevdflag = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":481 */
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->intord = 1;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":483 */
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->ipstrs = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":484 */
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->ipauto = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":485 */
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->tpois = 0.49;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":486 */
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->tyoungs = 1.0e30;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":493 */
  __pyx_v_dim = ((sizeof(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_grav)) / (sizeof((((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_grav[0]))));

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":494 */
  for (__pyx_1 = 0; __pyx_1 < __pyx_v_dim; ++__pyx_1) {
    __pyx_2 = PyInt_FromLong(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 494; goto __pyx_L1;}
    Py_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_2;
    __pyx_2 = 0;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":495 */
    __pyx_3 = PyInt_AsLong(__pyx_v_i); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 495; goto __pyx_L1;}
    (((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_grav[__pyx_3]) = 0.0;
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":498 */
  __pyx_v_dim = ((sizeof(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_prscal)) / (sizeof((((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_prscal[0]))));

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":499 */
  for (__pyx_1 = 0; __pyx_1 < __pyx_v_dim; ++__pyx_1) {
    __pyx_2 = PyInt_FromLong(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 499; goto __pyx_L1;}
    Py_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_2;
    __pyx_2 = 0;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":500 */
    __pyx_3 = PyInt_AsLong(__pyx_v_i); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 500; goto __pyx_L1;}
    (((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_prscal[__pyx_3]) = 1.0;
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":503 */
  __pyx_v_dim = ((sizeof(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_wscal)) / (sizeof((((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_wscal[0]))));

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":504 */
  for (__pyx_1 = 0; __pyx_1 < __pyx_v_dim; ++__pyx_1) {
    __pyx_2 = PyInt_FromLong(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 504; goto __pyx_L1;}
    Py_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_2;
    __pyx_2 = 0;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":505 */
    __pyx_3 = PyInt_AsLong(__pyx_v_i); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 505; goto __pyx_L1;}
    (((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_wscal[__pyx_3]) = 1.0;
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":507 */
  __pyx_v_dim = ((sizeof(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_wxscal)) / (sizeof((((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_wxscal[0]))));

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":508 */
  for (__pyx_1 = 0; __pyx_1 < __pyx_v_dim; ++__pyx_1) {
    __pyx_2 = PyInt_FromLong(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 508; goto __pyx_L1;}
    Py_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_2;
    __pyx_2 = 0;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":509 */
    __pyx_3 = PyInt_AsLong(__pyx_v_i); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 509; goto __pyx_L1;}
    (((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->_wxscal[__pyx_3]) = 1.0;
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":512 */
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->kti = 5;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":513 */
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->kto = 6;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":514 */
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->kr = 10;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":515 */
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->kw = 11;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":516 */
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->kp = 12;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":517 */
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->kucd = 13;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":519 */
  __pyx_r = 0;
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("PyLithLib.PyLith.__new__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_i);
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_n_journal;
static PyObject *__pyx_n_debug;

static PyObject *__pyx_k39p;

static char (__pyx_k39[]) = "pylith3d.trace";

static int __pyx_f_9PyLithLib_6PyLith___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_9PyLithLib_6PyLith___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_journal;
  int __pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return -1;
  Py_INCREF(__pyx_v_self);
  __pyx_v_journal = Py_None; Py_INCREF(Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":523 */
  __pyx_1 = __Pyx_Import(__pyx_n_journal, 0); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 523; goto __pyx_L1;}
  Py_DECREF(__pyx_v_journal);
  __pyx_v_journal = __pyx_1;
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":524 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_journal, __pyx_n_debug); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 524; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 524; goto __pyx_L1;}
  Py_INCREF(__pyx_k39p);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k39p);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 524; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->trace);
  ((struct __pyx_obj_9PyLithLib_PyLith *)__pyx_v_self)->trace = __pyx_3;
  __pyx_3 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("PyLithLib.PyLith.__init__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_journal);
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_n_file;
static PyObject *__pyx_n_w;
static PyObject *__pyx_n_enumerate;
static PyObject *__pyx_n_write;
static PyObject *__pyx_n_close;

static PyObject *__pyx_k42p;

static char (__pyx_k40[]) = "impulse# sample# sample values";
static char (__pyx_k42[]) = "%d %d %g %g %g";

static PyObject *__pyx_f_9PyLithLib_6PyLith_outputSampleValues(struct __pyx_obj_9PyLithLib_PyLith *__pyx_v_self,PyObject *__pyx_v_filename,PyObject *__pyx_v_impulseNode,PyObject *__pyx_v_values) {
  PyObject *__pyx_v_f;
  PyObject *__pyx_v_v;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  PyObject *__pyx_6 = 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_filename);
  Py_INCREF(__pyx_v_impulseNode);
  Py_INCREF(__pyx_v_values);
  __pyx_v_f = Py_None; Py_INCREF(Py_None);
  __pyx_v_v = Py_None; Py_INCREF(Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":528 */
  __pyx_k40;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":533 */
  __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_file); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 533; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(2); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 533; goto __pyx_L1;}
  Py_INCREF(__pyx_v_filename);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_filename);
  Py_INCREF(__pyx_n_w);
  PyTuple_SET_ITEM(__pyx_2, 1, __pyx_n_w);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 533; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_v_f);
  __pyx_v_f = __pyx_3;
  __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":534 */
  __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_enumerate); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 534; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 534; goto __pyx_L1;}
  Py_INCREF(__pyx_v_values);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_values);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 534; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_1 = PyObject_GetIter(__pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 534; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  for (;;) {
    __pyx_2 = PyIter_Next(__pyx_1);
    if (!__pyx_2) {
      if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 534; goto __pyx_L1;}
      break;
    }
    __pyx_3 = PyObject_GetIter(__pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 534; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_2 = __Pyx_UnpackItem(__pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 534; goto __pyx_L1;}
    Py_DECREF(__pyx_v_v);
    __pyx_v_v = __pyx_2;
    __pyx_2 = 0;
    __pyx_2 = __Pyx_UnpackItem(__pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 534; goto __pyx_L1;}
    Py_DECREF(__pyx_v_values);
    __pyx_v_values = __pyx_2;
    __pyx_2 = 0;
    if (__Pyx_EndUnpack(__pyx_3) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 534; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":535 */
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_write); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 535; goto __pyx_L1;}
    __pyx_3 = PyInt_FromLong(0); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 535; goto __pyx_L1;}
    __pyx_4 = PyObject_GetItem(__pyx_v_values, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 535; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_3 = PyInt_FromLong(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 535; goto __pyx_L1;}
    __pyx_5 = PyObject_GetItem(__pyx_v_values, __pyx_3); if (!__pyx_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 535; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_3 = PyInt_FromLong(2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 535; goto __pyx_L1;}
    __pyx_6 = PyObject_GetItem(__pyx_v_values, __pyx_3); if (!__pyx_6) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 535; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_3 = PyTuple_New(5); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 535; goto __pyx_L1;}
    Py_INCREF(__pyx_v_impulseNode);
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_impulseNode);
    Py_INCREF(__pyx_v_v);
    PyTuple_SET_ITEM(__pyx_3, 1, __pyx_v_v);
    PyTuple_SET_ITEM(__pyx_3, 2, __pyx_4);
    PyTuple_SET_ITEM(__pyx_3, 3, __pyx_5);
    PyTuple_SET_ITEM(__pyx_3, 4, __pyx_6);
    __pyx_4 = 0;
    __pyx_5 = 0;
    __pyx_6 = 0;
    __pyx_4 = PyNumber_Remainder(__pyx_k42p, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 535; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_5 = PyTuple_New(2); if (!__pyx_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 535; goto __pyx_L1;}
    Py_INCREF(__pyx_v_f);
    PyTuple_SET_ITEM(__pyx_5, 0, __pyx_v_f);
    PyTuple_SET_ITEM(__pyx_5, 1, __pyx_4);
    __pyx_4 = 0;
    __pyx_6 = PyObject_CallObject(__pyx_2, __pyx_5); if (!__pyx_6) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 535; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    Py_DECREF(__pyx_6); __pyx_6 = 0;
  }
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":536 */
  __pyx_3 = PyObject_GetAttr(__pyx_v_f, __pyx_n_close); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 536; goto __pyx_L1;}
  __pyx_4 = PyObject_CallObject(__pyx_3, 0); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 536; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_4); __pyx_4 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":537 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  Py_XDECREF(__pyx_6);
  __Pyx_AddTraceback("PyLithLib.PyLith.outputSampleValues");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_f);
  Py_DECREF(__pyx_v_v);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_filename);
  Py_DECREF(__pyx_v_impulseNode);
  Py_DECREF(__pyx_v_values);
  return __pyx_r;
}

static char (__pyx_k43[]) = "\n        # Beginning of loop that loops over split node sets, creating\n        # an \'impulse\' for each one and outputting response values.\n        # Below at present is a quasi-C version of the needed code.\n\n        splitField = None\n        m = None\n\n        # Need bindings for these\n        pylith3d.meshGetSectionPair(mesh, \"split\", splitField)\n        pylith3d.meshGetMesh(self.mesh, m)\n\n        # This is incorrect, but I need something like:\n        topology = getTopology(m)\n        patch = 0\n        eNumbering = pylith3d.getLocalNumbering(topology, patch, ??)\n        vNumbering = pylith3d.getLocalNumbering(topology, patch, 0)\n\n\n        # Need to loop over global nodes\n        for node in ??:\n            # Need integer and double lists to hold split node info\n            faultind = []\n            faultvals = []\n            indfault = None\n            valfault = None\n        \n            # Need to find elements in the split node \'patch\' that contain node.\n            numSet = 0\n            for elem in ??:\n                # Not sure if this does what I want\n                if (pylith3d.sieve.baseContains(elem)):\n                    # This is totally wrong, but I need to get local element and node numbers,\n                    # along with values\n                    numSet += 1\n                    faultind += [eNumbering.getIndex(elem)]\n                    faultind += [vNumbering.getIndex(node)]\n\n                    # Need to look up how to get field values\n                    faultvals += [value.x, value.y, value.z]\n\n                    # Create arrays to send to fortran code\n                    indfault = intListToArray(faultind)\n                    valfault = doubleListToArray(faultvals)\n\n            # Call fortran routine to set specified split values and clear the rest\n            pylith3d.setsplit(self.nfault, self.fault, numfn, indfault, valfault, numSet)\n            # Solve\n            pylith3d.solveElastic()\n            values = self.interpolatePoints(points)\n            self.outputSampleValues(self.fileRoot+\'.output\', values)\n        return\n                    \n        \n        \n                    SectionReal splitField;\n                    \n                    # Need bindings for this\n                    ierr = MeshGetSectionPair(mesh, \"split\", &splitField);\n                    // Loop over split nodes\n                    for() {\n                    // Loop over elements\n                    for() {\n                    # Need bindings for this\n                    ierr = SectionPairSetFiberDimension(splitField, e, 1);\n                    }\n                    # Need bindings for this\n                    ierr = SectionPairAllocate(splitField);\n                    // Loop over elements\n                    for() {\n                    PetscPair value;\n\n                    value.i = node;\n                    value.x = ;\n                    value.y = ;\n                    value.z = ;\n                    # Need bindings for this\n                    ierr = SectionPairUpdate(splitField, e, &value);\n                    # Major problem right now:  This just updates PETSc/Sieve\'s copy of splitField.\n                    # It does not change the values within PyLith, which have been read from\n                    # per-process input files.\n                    }\n                    // Solve\n                    pl3drun.solveElastic()\n                    # Need bindings for this\n                    ierr = SectionPairClear(splitField);\n                    }\n                    values = self.interpolatePoints(points)\n                    self.outputSampleValues(self.fileRoot+\'.output\', values)\n                    ";

static PyObject *__pyx_f_9PyLithLib_6PyLith_greenFunction(struct __pyx_obj_9PyLithLib_PyLith *__pyx_v_self,PyObject *__pyx_v_points) {
  PyObject *__pyx_r;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_points);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":541 */
  __pyx_k43;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":631 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_points);
  return __pyx_r;
}

static PyObject *__pyx_n_log;
static PyObject *__pyx_n_units;
static PyObject *__pyx_n_parser;
static PyObject *__pyx_n_parse;
static PyObject *__pyx_n_str;
static PyObject *__pyx_n_strip;
static PyObject *__pyx_n_value;

static PyObject *__pyx_k44p;
static PyObject *__pyx_k45p;
static PyObject *__pyx_k46p;
static PyObject *__pyx_k47p;

static char (__pyx_k44[]) = "Hello from PyLith.scan (begin)!";
static char (__pyx_k45[]) = "Scanning ascii files to determine dimensions.";
static char (__pyx_k46[]) = "pyre.units";
static char (__pyx_k47[]) = "Hello from PyLith.scan (end)!";

static PyObject *__pyx_f_9PyLithLib_6PyLith_scan(struct __pyx_obj_9PyLithLib_PyLith *__pyx_v_self) {
  PyObject *__pyx_v_pyre;
  int __pyx_v_errorcode;
  char (__pyx_v_errorstring[__pyx_e_9PyLithLib_errorstring_size]);
  PyObject *__pyx_v_uparser;
  PyObject *__pyx_v_neni;
  int __pyx_v_dim;
  PyObject *__pyx_v_i;
  char (__pyx_v_coord_units[30]);
  char (__pyx_v_displacement_units[30]);
  char (__pyx_v_velocity_units[30]);
  char (__pyx_v_force_units[30]);
  char (__pyx_v_rotation_units[30]);
  char (__pyx_v_time_units[30]);
  char (__pyx_v_traction_units[30]);
  int __pyx_v_nsnodesmax;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  PyObject *__pyx_6 = 0;
  PyObject *__pyx_7 = 0;
  PyObject *__pyx_8 = 0;
  PyObject *__pyx_9 = 0;
  PyObject *__pyx_10 = 0;
  PyObject *__pyx_11 = 0;
  int __pyx_12;
  long __pyx_13;
  int __pyx_14;
  char (*__pyx_15);
  size_t __pyx_16;
  double __pyx_17;
  Py_INCREF(__pyx_v_self);
  __pyx_v_pyre = Py_None; Py_INCREF(Py_None);
  __pyx_v_uparser = Py_None; Py_INCREF(Py_None);
  __pyx_v_neni = Py_None; Py_INCREF(Py_None);
  __pyx_v_i = Py_None; Py_INCREF(Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":638 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self->trace, __pyx_n_log); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 638; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 638; goto __pyx_L1;}
  Py_INCREF(__pyx_k44p);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k44p);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 638; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":639 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self->trace, __pyx_n_log); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 639; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 639; goto __pyx_L1;}
  Py_INCREF(__pyx_k45p);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k45p);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 639; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":641 */
  __pyx_1 = __Pyx_Import(__pyx_k46p, 0); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 641; goto __pyx_L1;}
  Py_DECREF(__pyx_v_pyre);
  __pyx_v_pyre = __pyx_1;
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":645 */
  __pyx_v_errorcode = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":647 */
  __pyx_2 = PyObject_GetAttr(__pyx_v_pyre, __pyx_n_units); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 647; goto __pyx_L1;}
  __pyx_3 = PyObject_GetAttr(__pyx_2, __pyx_n_parser); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 647; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(__pyx_3, 0); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 647; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_v_uparser);
  __pyx_v_uparser = __pyx_1;
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":656 */
  __pyx_v_self->maxElementEquations = (__pyx_e_9constants_numberDegreesFreedom * __pyx_e_9constants_maxElementNodes);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":658 */
  __pyx_2 = PyInt_FromLong(8); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 658; goto __pyx_L1;}
  __pyx_3 = PyInt_FromLong(7); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 658; goto __pyx_L1;}
  __pyx_1 = PyInt_FromLong(6); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 658; goto __pyx_L1;}
  __pyx_4 = PyInt_FromLong(5); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 658; goto __pyx_L1;}
  __pyx_5 = PyInt_FromLong(4); if (!__pyx_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 658; goto __pyx_L1;}
  __pyx_6 = PyInt_FromLong(20); if (!__pyx_6) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 658; goto __pyx_L1;}
  __pyx_7 = PyInt_FromLong(18); if (!__pyx_7) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 658; goto __pyx_L1;}
  __pyx_8 = PyInt_FromLong(15); if (!__pyx_8) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 658; goto __pyx_L1;}
  __pyx_9 = PyInt_FromLong(13); if (!__pyx_9) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 658; goto __pyx_L1;}
  __pyx_10 = PyInt_FromLong(10); if (!__pyx_10) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 658; goto __pyx_L1;}
  __pyx_11 = PyList_New(10); if (!__pyx_11) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 658; goto __pyx_L1;}
  PyList_SET_ITEM(__pyx_11, 0, __pyx_2);
  PyList_SET_ITEM(__pyx_11, 1, __pyx_3);
  PyList_SET_ITEM(__pyx_11, 2, __pyx_1);
  PyList_SET_ITEM(__pyx_11, 3, __pyx_4);
  PyList_SET_ITEM(__pyx_11, 4, __pyx_5);
  PyList_SET_ITEM(__pyx_11, 5, __pyx_6);
  PyList_SET_ITEM(__pyx_11, 6, __pyx_7);
  PyList_SET_ITEM(__pyx_11, 7, __pyx_8);
  PyList_SET_ITEM(__pyx_11, 8, __pyx_9);
  PyList_SET_ITEM(__pyx_11, 9, __pyx_10);
  __pyx_2 = 0;
  __pyx_3 = 0;
  __pyx_1 = 0;
  __pyx_4 = 0;
  __pyx_5 = 0;
  __pyx_6 = 0;
  __pyx_7 = 0;
  __pyx_8 = 0;
  __pyx_9 = 0;
  __pyx_10 = 0;
  Py_DECREF(__pyx_v_neni);
  __pyx_v_neni = __pyx_11;
  __pyx_11 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":660 */
  __pyx_v_dim = ((sizeof(__pyx_v_self->neni)) / (sizeof((__pyx_v_self->neni[0]))));

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":661 */
  __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 661; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 661; goto __pyx_L1;}
  Py_INCREF(__pyx_v_neni);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_neni);
  __pyx_1 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 661; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_4 = PyInt_FromLong(__pyx_v_dim); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 661; goto __pyx_L1;}
  if (PyObject_Cmp(__pyx_1, __pyx_4, &__pyx_12) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 661; goto __pyx_L1;}
  __pyx_12 = __pyx_12 == 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  if (!__pyx_12) {
    PyErr_SetNone(PyExc_AssertionError);
    {__pyx_filename = __pyx_f[3]; __pyx_lineno = 661; goto __pyx_L1;}
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":662 */
  for (__pyx_13 = 0; __pyx_13 < __pyx_v_dim; ++__pyx_13) {
    __pyx_5 = PyInt_FromLong(__pyx_13); if (!__pyx_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 662; goto __pyx_L1;}
    Py_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_5;
    __pyx_5 = 0;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":663 */
    __pyx_6 = PyObject_GetItem(__pyx_v_neni, __pyx_v_i); if (!__pyx_6) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 663; goto __pyx_L1;}
    __pyx_12 = PyInt_AsLong(__pyx_6); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 663; goto __pyx_L1;}
    Py_DECREF(__pyx_6); __pyx_6 = 0;
    __pyx_14 = PyInt_AsLong(__pyx_v_i); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 663; goto __pyx_L1;}
    (__pyx_v_self->neni[__pyx_14]) = __pyx_12;
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":666 */
  FC_FUNC_(matmod_def, MATMOD_DEF)(__pyx_v_self->infmatmod); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 666; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":673 */
  __pyx_15 = PyString_AsString(__pyx_v_self->coordinateInputFile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 677; goto __pyx_L1;}
  __pyx_7 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_7) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 681; goto __pyx_L1;}
  __pyx_8 = PyTuple_New(1); if (!__pyx_8) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 681; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->coordinateInputFile);
  PyTuple_SET_ITEM(__pyx_8, 0, __pyx_v_self->coordinateInputFile);
  __pyx_9 = PyObject_CallObject(__pyx_7, __pyx_8); if (!__pyx_9) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 681; goto __pyx_L1;}
  Py_DECREF(__pyx_7); __pyx_7 = 0;
  Py_DECREF(__pyx_8); __pyx_8 = 0;
  __pyx_16 = PyInt_AsUnsignedLongMask(__pyx_9); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 681; goto __pyx_L1;}
  Py_DECREF(__pyx_9); __pyx_9 = 0;
  FC_FUNC_(scan_coords, SCAN_COORDS)((&__pyx_v_self->numnp),(&__pyx_v_self->kr),__pyx_v_coord_units,__pyx_15,(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_coord_units)),__pyx_16,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 673; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":683 */
  __pyx_10 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_10) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 683; goto __pyx_L1;}
  Py_DECREF(__pyx_10); __pyx_10 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":684 */
  (__pyx_v_coord_units[((sizeof(__pyx_v_coord_units)) - 1)]) = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":686 */
  __pyx_11 = PyObject_GetAttr(__pyx_v_uparser, __pyx_n_parse); if (!__pyx_11) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 686; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_str); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 686; goto __pyx_L1;}
  __pyx_3 = PyString_FromString(__pyx_v_coord_units); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 686; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 686; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_3);
  __pyx_3 = 0;
  __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_1); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 686; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_5 = PyObject_GetAttr(__pyx_4, __pyx_n_strip); if (!__pyx_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 686; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  __pyx_6 = PyObject_CallObject(__pyx_5, 0); if (!__pyx_6) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 686; goto __pyx_L1;}
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  __pyx_7 = PyTuple_New(1); if (!__pyx_7) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 686; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_7, 0, __pyx_6);
  __pyx_6 = 0;
  __pyx_8 = PyObject_CallObject(__pyx_11, __pyx_7); if (!__pyx_8) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 686; goto __pyx_L1;}
  Py_DECREF(__pyx_11); __pyx_11 = 0;
  Py_DECREF(__pyx_7); __pyx_7 = 0;
  __pyx_9 = PyObject_GetAttr(__pyx_8, __pyx_n_value); if (!__pyx_9) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 686; goto __pyx_L1;}
  Py_DECREF(__pyx_8); __pyx_8 = 0;
  __pyx_17 = PyFloat_AsDouble(__pyx_9); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 686; goto __pyx_L1;}
  Py_DECREF(__pyx_9); __pyx_9 = 0;
  __pyx_v_self->cscale = __pyx_17;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":691 */
  __pyx_15 = PyString_AsString(__pyx_v_self->bcfile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 697; goto __pyx_L1;}
  __pyx_10 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_10) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 703; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 703; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->bcfile);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_self->bcfile);
  __pyx_2 = PyObject_CallObject(__pyx_10, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 703; goto __pyx_L1;}
  Py_DECREF(__pyx_10); __pyx_10 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_16 = PyInt_AsUnsignedLongMask(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 703; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  FC_FUNC_(scan_bc, SCAN_BC)((&__pyx_v_self->numbc),(&__pyx_v_self->kr),__pyx_v_displacement_units,__pyx_v_velocity_units,__pyx_v_force_units,__pyx_15,(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_displacement_units)),(sizeof(__pyx_v_velocity_units)),(sizeof(__pyx_v_force_units)),__pyx_16,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 691; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":705 */
  __pyx_1 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 705; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":706 */
  (__pyx_v_displacement_units[((sizeof(__pyx_v_displacement_units)) - 1)]) = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":707 */
  (__pyx_v_velocity_units[((sizeof(__pyx_v_velocity_units)) - 1)]) = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":708 */
  (__pyx_v_force_units[((sizeof(__pyx_v_force_units)) - 1)]) = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":710 */
  __pyx_12 = (__pyx_v_self->numbc > 0);
  if (__pyx_12) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":711 */
    __pyx_4 = PyObject_GetAttr(__pyx_v_uparser, __pyx_n_parse); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 711; goto __pyx_L1;}
    __pyx_5 = __Pyx_GetName(__pyx_b, __pyx_n_str); if (!__pyx_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 711; goto __pyx_L1;}
    __pyx_6 = PyString_FromString(__pyx_v_displacement_units); if (!__pyx_6) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 711; goto __pyx_L1;}
    __pyx_11 = PyTuple_New(1); if (!__pyx_11) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 711; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_11, 0, __pyx_6);
    __pyx_6 = 0;
    __pyx_7 = PyObject_CallObject(__pyx_5, __pyx_11); if (!__pyx_7) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 711; goto __pyx_L1;}
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    Py_DECREF(__pyx_11); __pyx_11 = 0;
    __pyx_8 = PyObject_GetAttr(__pyx_7, __pyx_n_strip); if (!__pyx_8) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 711; goto __pyx_L1;}
    Py_DECREF(__pyx_7); __pyx_7 = 0;
    __pyx_9 = PyObject_CallObject(__pyx_8, 0); if (!__pyx_9) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 711; goto __pyx_L1;}
    Py_DECREF(__pyx_8); __pyx_8 = 0;
    __pyx_10 = PyTuple_New(1); if (!__pyx_10) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 711; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_10, 0, __pyx_9);
    __pyx_9 = 0;
    __pyx_3 = PyObject_CallObject(__pyx_4, __pyx_10); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 711; goto __pyx_L1;}
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    Py_DECREF(__pyx_10); __pyx_10 = 0;
    __pyx_2 = PyObject_GetAttr(__pyx_3, __pyx_n_value); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 711; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_17 = PyFloat_AsDouble(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 711; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_v_self->dscale = __pyx_17;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":712 */
    __pyx_1 = PyObject_GetAttr(__pyx_v_uparser, __pyx_n_parse); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 712; goto __pyx_L1;}
    __pyx_6 = __Pyx_GetName(__pyx_b, __pyx_n_str); if (!__pyx_6) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 712; goto __pyx_L1;}
    __pyx_5 = PyString_FromString(__pyx_v_velocity_units); if (!__pyx_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 712; goto __pyx_L1;}
    __pyx_11 = PyTuple_New(1); if (!__pyx_11) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 712; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_11, 0, __pyx_5);
    __pyx_5 = 0;
    __pyx_7 = PyObject_CallObject(__pyx_6, __pyx_11); if (!__pyx_7) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 712; goto __pyx_L1;}
    Py_DECREF(__pyx_6); __pyx_6 = 0;
    Py_DECREF(__pyx_11); __pyx_11 = 0;
    __pyx_8 = PyObject_GetAttr(__pyx_7, __pyx_n_strip); if (!__pyx_8) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 712; goto __pyx_L1;}
    Py_DECREF(__pyx_7); __pyx_7 = 0;
    __pyx_9 = PyObject_CallObject(__pyx_8, 0); if (!__pyx_9) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 712; goto __pyx_L1;}
    Py_DECREF(__pyx_8); __pyx_8 = 0;
    __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 712; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_4, 0, __pyx_9);
    __pyx_9 = 0;
    __pyx_10 = PyObject_CallObject(__pyx_1, __pyx_4); if (!__pyx_10) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 712; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    __pyx_3 = PyObject_GetAttr(__pyx_10, __pyx_n_value); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 712; goto __pyx_L1;}
    Py_DECREF(__pyx_10); __pyx_10 = 0;
    __pyx_17 = PyFloat_AsDouble(__pyx_3); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 712; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_v_self->vscale = __pyx_17;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":713 */
    __pyx_2 = PyObject_GetAttr(__pyx_v_uparser, __pyx_n_parse); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 713; goto __pyx_L1;}
    __pyx_5 = __Pyx_GetName(__pyx_b, __pyx_n_str); if (!__pyx_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 713; goto __pyx_L1;}
    __pyx_6 = PyString_FromString(__pyx_v_force_units); if (!__pyx_6) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 713; goto __pyx_L1;}
    __pyx_11 = PyTuple_New(1); if (!__pyx_11) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 713; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_11, 0, __pyx_6);
    __pyx_6 = 0;
    __pyx_7 = PyObject_CallObject(__pyx_5, __pyx_11); if (!__pyx_7) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 713; goto __pyx_L1;}
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    Py_DECREF(__pyx_11); __pyx_11 = 0;
    __pyx_8 = PyObject_GetAttr(__pyx_7, __pyx_n_strip); if (!__pyx_8) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 713; goto __pyx_L1;}
    Py_DECREF(__pyx_7); __pyx_7 = 0;
    __pyx_9 = PyObject_CallObject(__pyx_8, 0); if (!__pyx_9) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 713; goto __pyx_L1;}
    Py_DECREF(__pyx_8); __pyx_8 = 0;
    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 713; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_9);
    __pyx_9 = 0;
    __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_1); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 713; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __pyx_10 = PyObject_GetAttr(__pyx_4, __pyx_n_value); if (!__pyx_10) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 713; goto __pyx_L1;}
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    __pyx_17 = PyFloat_AsDouble(__pyx_10); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 713; goto __pyx_L1;}
    Py_DECREF(__pyx_10); __pyx_10 = 0;
    __pyx_v_self->fscale = __pyx_17;
    goto __pyx_L4;
  }
  /*else*/ {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":715 */
    __pyx_v_self->dscale = 0.0;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":716 */
    __pyx_v_self->vscale = 0.0;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":717 */
    __pyx_v_self->fscale = 0.0;
  }
  __pyx_L4:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":719 */
  __pyx_15 = PyString_AsString(__pyx_v_self->wfile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 723; goto __pyx_L1;}
  __pyx_3 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 726; goto __pyx_L1;}
  __pyx_6 = PyTuple_New(1); if (!__pyx_6) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 726; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->wfile);
  PyTuple_SET_ITEM(__pyx_6, 0, __pyx_v_self->wfile);
  __pyx_5 = PyObject_CallObject(__pyx_3, __pyx_6); if (!__pyx_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 726; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_6); __pyx_6 = 0;
  __pyx_16 = PyInt_AsUnsignedLongMask(__pyx_5); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 726; goto __pyx_L1;}
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  FC_FUNC_(scan_wink, SCAN_WINK)((&__pyx_v_self->nwinke),(&__pyx_v_self->nwink),(&__pyx_v_self->kr),__pyx_15,(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_16,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 719; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":728 */
  __pyx_11 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_11) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 728; goto __pyx_L1;}
  Py_DECREF(__pyx_11); __pyx_11 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":731 */
  __pyx_15 = PyString_AsString(__pyx_v_self->skfile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 735; goto __pyx_L1;}
  __pyx_7 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_7) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 739; goto __pyx_L1;}
  __pyx_8 = PyTuple_New(1); if (!__pyx_8) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 739; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->skfile);
  PyTuple_SET_ITEM(__pyx_8, 0, __pyx_v_self->skfile);
  __pyx_9 = PyObject_CallObject(__pyx_7, __pyx_8); if (!__pyx_9) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 739; goto __pyx_L1;}
  Py_DECREF(__pyx_7); __pyx_7 = 0;
  Py_DECREF(__pyx_8); __pyx_8 = 0;
  __pyx_16 = PyInt_AsUnsignedLongMask(__pyx_9); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 739; goto __pyx_L1;}
  Py_DECREF(__pyx_9); __pyx_9 = 0;
  FC_FUNC_(scan_skew, SCAN_SKEW)((&__pyx_v_self->numrot),(&__pyx_v_self->kr),__pyx_v_rotation_units,__pyx_15,(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_rotation_units)),__pyx_16,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 731; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":741 */
  __pyx_2 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 741; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":742 */
  (__pyx_v_rotation_units[((sizeof(__pyx_v_rotation_units)) - 1)]) = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":744 */
  __pyx_14 = (__pyx_v_self->numrot != 0);
  if (__pyx_14) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":745 */
    __pyx_1 = PyObject_GetAttr(__pyx_v_uparser, __pyx_n_parse); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 745; goto __pyx_L1;}
    __pyx_4 = __Pyx_GetName(__pyx_b, __pyx_n_str); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 745; goto __pyx_L1;}
    __pyx_10 = PyString_FromString(__pyx_v_rotation_units); if (!__pyx_10) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 745; goto __pyx_L1;}
    __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 745; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_10);
    __pyx_10 = 0;
    __pyx_6 = PyObject_CallObject(__pyx_4, __pyx_3); if (!__pyx_6) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 745; goto __pyx_L1;}
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_5 = PyObject_GetAttr(__pyx_6, __pyx_n_strip); if (!__pyx_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 745; goto __pyx_L1;}
    Py_DECREF(__pyx_6); __pyx_6 = 0;
    __pyx_11 = PyObject_CallObject(__pyx_5, 0); if (!__pyx_11) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 745; goto __pyx_L1;}
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    __pyx_7 = PyTuple_New(1); if (!__pyx_7) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 745; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_7, 0, __pyx_11);
    __pyx_11 = 0;
    __pyx_8 = PyObject_CallObject(__pyx_1, __pyx_7); if (!__pyx_8) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 745; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_7); __pyx_7 = 0;
    __pyx_9 = PyObject_GetAttr(__pyx_8, __pyx_n_value); if (!__pyx_9) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 745; goto __pyx_L1;}
    Py_DECREF(__pyx_8); __pyx_8 = 0;
    __pyx_17 = PyFloat_AsDouble(__pyx_9); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 745; goto __pyx_L1;}
    Py_DECREF(__pyx_9); __pyx_9 = 0;
    __pyx_v_self->runits = __pyx_17;
    goto __pyx_L5;
  }
  /*else*/ {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":747 */
    __pyx_v_self->runits = 0.0;
  }
  __pyx_L5:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":750 */
  __pyx_15 = PyString_AsString(__pyx_v_self->timeStepInputFile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 755; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 759; goto __pyx_L1;}
  __pyx_10 = PyTuple_New(1); if (!__pyx_10) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 759; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->timeStepInputFile);
  PyTuple_SET_ITEM(__pyx_10, 0, __pyx_v_self->timeStepInputFile);
  __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_10); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 759; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_10); __pyx_10 = 0;
  __pyx_16 = PyInt_AsUnsignedLongMask(__pyx_4); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 759; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  FC_FUNC_(scan_timdat, SCAN_TIMDAT)((&__pyx_v_self->lastep),(&__pyx_v_self->nintg),(&__pyx_v_self->kr),__pyx_v_time_units,__pyx_15,(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_time_units)),__pyx_16,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 750; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":761 */
  __pyx_3 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 761; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":762 */
  (__pyx_v_time_units[((sizeof(__pyx_v_time_units)) - 1)]) = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":764 */
  __pyx_6 = PyObject_GetAttr(__pyx_v_uparser, __pyx_n_parse); if (!__pyx_6) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 764; goto __pyx_L1;}
  __pyx_5 = __Pyx_GetName(__pyx_b, __pyx_n_str); if (!__pyx_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 764; goto __pyx_L1;}
  __pyx_11 = PyString_FromString(__pyx_v_time_units); if (!__pyx_11) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 764; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 764; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_11);
  __pyx_11 = 0;
  __pyx_7 = PyObject_CallObject(__pyx_5, __pyx_1); if (!__pyx_7) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 764; goto __pyx_L1;}
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_8 = PyObject_GetAttr(__pyx_7, __pyx_n_strip); if (!__pyx_8) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 764; goto __pyx_L1;}
  Py_DECREF(__pyx_7); __pyx_7 = 0;
  __pyx_9 = PyObject_CallObject(__pyx_8, 0); if (!__pyx_9) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 764; goto __pyx_L1;}
  Py_DECREF(__pyx_8); __pyx_8 = 0;
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 764; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_9);
  __pyx_9 = 0;
  __pyx_10 = PyObject_CallObject(__pyx_6, __pyx_2); if (!__pyx_10) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 764; goto __pyx_L1;}
  Py_DECREF(__pyx_6); __pyx_6 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_4 = PyObject_GetAttr(__pyx_10, __pyx_n_value); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 764; goto __pyx_L1;}
  Py_DECREF(__pyx_10); __pyx_10 = 0;
  __pyx_17 = PyFloat_AsDouble(__pyx_4); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 764; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  __pyx_v_self->tunits = __pyx_17;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":766 */
  __pyx_15 = PyString_AsString(__pyx_v_self->fofile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 771; goto __pyx_L1;}
  __pyx_3 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 774; goto __pyx_L1;}
  __pyx_11 = PyTuple_New(1); if (!__pyx_11) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 774; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->fofile);
  PyTuple_SET_ITEM(__pyx_11, 0, __pyx_v_self->fofile);
  __pyx_5 = PyObject_CallObject(__pyx_3, __pyx_11); if (!__pyx_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 774; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_11); __pyx_11 = 0;
  __pyx_16 = PyInt_AsUnsignedLongMask(__pyx_5); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 774; goto __pyx_L1;}
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  FC_FUNC_(scan_fuldat, SCAN_FULDAT)((&__pyx_v_self->icode),(&__pyx_v_self->lastep),(&__pyx_v_self->icontr),(&__pyx_v_self->kr),__pyx_15,(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_16,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 766; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":776 */
  __pyx_1 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 776; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":778 */
  __pyx_15 = PyString_AsString(__pyx_v_self->hfile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 781; goto __pyx_L1;}
  __pyx_7 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_7) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 784; goto __pyx_L1;}
  __pyx_8 = PyTuple_New(1); if (!__pyx_8) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 784; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->hfile);
  PyTuple_SET_ITEM(__pyx_8, 0, __pyx_v_self->hfile);
  __pyx_9 = PyObject_CallObject(__pyx_7, __pyx_8); if (!__pyx_9) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 784; goto __pyx_L1;}
  Py_DECREF(__pyx_7); __pyx_7 = 0;
  Py_DECREF(__pyx_8); __pyx_8 = 0;
  __pyx_16 = PyInt_AsUnsignedLongMask(__pyx_9); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 784; goto __pyx_L1;}
  Py_DECREF(__pyx_9); __pyx_9 = 0;
  FC_FUNC_(scan_hist, SCAN_HIST)((&__pyx_v_self->nhist),(&__pyx_v_self->kr),__pyx_15,(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_16,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 778; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":786 */
  __pyx_6 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_6) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 786; goto __pyx_L1;}
  Py_DECREF(__pyx_6); __pyx_6 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":788 */
  __pyx_2 = ((struct __pyx_vtabstruct_9PyLithLib_PyLith *)__pyx_v_self->__pyx_vtab)->scan_connect(__pyx_v_self); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 788; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":790 */
  __pyx_12 = __pyx_e_9PyLithLib_prestress;
  if (__pyx_12) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":804 */
    __pyx_10 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_10) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 804; goto __pyx_L1;}
    Py_DECREF(__pyx_10); __pyx_10 = 0;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":805 */
    __pyx_v_self->nprestr = 0;
    goto __pyx_L6;
  }
  /*else*/ {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":807 */
    __pyx_v_self->nprestr = 0;
  }
  __pyx_L6:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":811 */
  __pyx_v_nsnodesmax = __pyx_e_9constants_nsnodesmax;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":812 */
  __pyx_15 = PyString_AsString(__pyx_v_self->tractionInputFile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 818; goto __pyx_L1;}
  __pyx_4 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 822; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 822; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->tractionInputFile);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_self->tractionInputFile);
  __pyx_11 = PyObject_CallObject(__pyx_4, __pyx_3); if (!__pyx_11) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 822; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_16 = PyInt_AsUnsignedLongMask(__pyx_11); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 822; goto __pyx_L1;}
  Py_DECREF(__pyx_11); __pyx_11 = 0;
  FC_FUNC_(scan_tractions, SCAN_TRACTIONS)((&__pyx_v_self->numtractions),(&__pyx_v_nsnodesmax),(&__pyx_v_self->kr),(&__pyx_v_self->ietypev),__pyx_v_traction_units,__pyx_15,(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_traction_units)),__pyx_16,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 812; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":824 */
  __pyx_5 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 824; goto __pyx_L1;}
  Py_DECREF(__pyx_5); __pyx_5 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":825 */
  (__pyx_v_traction_units[((sizeof(__pyx_v_traction_units)) - 1)]) = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":827 */
  __pyx_14 = (__pyx_v_self->numtractions != 0);
  if (__pyx_14) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":828 */
    __pyx_1 = PyObject_GetAttr(__pyx_v_uparser, __pyx_n_parse); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 828; goto __pyx_L1;}
    __pyx_7 = __Pyx_GetName(__pyx_b, __pyx_n_str); if (!__pyx_7) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 828; goto __pyx_L1;}
    __pyx_8 = PyString_FromString(__pyx_v_traction_units); if (!__pyx_8) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 828; goto __pyx_L1;}
    __pyx_9 = PyTuple_New(1); if (!__pyx_9) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 828; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_9, 0, __pyx_8);
    __pyx_8 = 0;
    __pyx_6 = PyObject_CallObject(__pyx_7, __pyx_9); if (!__pyx_6) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 828; goto __pyx_L1;}
    Py_DECREF(__pyx_7); __pyx_7 = 0;
    Py_DECREF(__pyx_9); __pyx_9 = 0;
    __pyx_2 = PyObject_GetAttr(__pyx_6, __pyx_n_strip); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 828; goto __pyx_L1;}
    Py_DECREF(__pyx_6); __pyx_6 = 0;
    __pyx_10 = PyObject_CallObject(__pyx_2, 0); if (!__pyx_10) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 828; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 828; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_4, 0, __pyx_10);
    __pyx_10 = 0;
    __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_4); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 828; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    __pyx_11 = PyObject_GetAttr(__pyx_3, __pyx_n_value); if (!__pyx_11) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 828; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_17 = PyFloat_AsDouble(__pyx_11); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 828; goto __pyx_L1;}
    Py_DECREF(__pyx_11); __pyx_11 = 0;
    __pyx_v_self->tscale = __pyx_17;
    goto __pyx_L7;
  }
  /*else*/ {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":830 */
    __pyx_v_self->tscale = 0.0;
  }
  __pyx_L7:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":832 */
  __pyx_15 = PyString_AsString(__pyx_v_self->spfile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 835; goto __pyx_L1;}
  __pyx_5 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 838; goto __pyx_L1;}
  __pyx_8 = PyTuple_New(1); if (!__pyx_8) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 838; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->spfile);
  PyTuple_SET_ITEM(__pyx_8, 0, __pyx_v_self->spfile);
  __pyx_7 = PyObject_CallObject(__pyx_5, __pyx_8); if (!__pyx_7) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 838; goto __pyx_L1;}
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  Py_DECREF(__pyx_8); __pyx_8 = 0;
  __pyx_16 = PyInt_AsUnsignedLongMask(__pyx_7); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 838; goto __pyx_L1;}
  Py_DECREF(__pyx_7); __pyx_7 = 0;
  FC_FUNC_(scan_split, SCAN_SPLIT)((&__pyx_v_self->numfn),(&__pyx_v_self->kr),__pyx_15,(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_16,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 832; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":840 */
  __pyx_9 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_9) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 840; goto __pyx_L1;}
  Py_DECREF(__pyx_9); __pyx_9 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":842 */
  __pyx_15 = PyString_AsString(__pyx_v_self->slfile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 845; goto __pyx_L1;}
  __pyx_6 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_6) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 848; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 848; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->slfile);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_self->slfile);
  __pyx_10 = PyObject_CallObject(__pyx_6, __pyx_2); if (!__pyx_10) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 848; goto __pyx_L1;}
  Py_DECREF(__pyx_6); __pyx_6 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_16 = PyInt_AsUnsignedLongMask(__pyx_10); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 848; goto __pyx_L1;}
  Py_DECREF(__pyx_10); __pyx_10 = 0;
  FC_FUNC_(scan_slip, SCAN_SLIP)((&__pyx_v_self->numslp),(&__pyx_v_self->kr),__pyx_15,(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_16,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 842; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":850 */
  __pyx_1 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 850; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":852 */
  __pyx_15 = PyString_AsString(__pyx_v_self->difile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 856; goto __pyx_L1;}
  __pyx_4 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 859; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 859; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->difile);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_self->difile);
  __pyx_11 = PyObject_CallObject(__pyx_4, __pyx_3); if (!__pyx_11) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 859; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_16 = PyInt_AsUnsignedLongMask(__pyx_11); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 859; goto __pyx_L1;}
  Py_DECREF(__pyx_11); __pyx_11 = 0;
  FC_FUNC_(scan_diff, SCAN_DIFF)((&__pyx_v_self->numslp),(&__pyx_v_self->numdif),(&__pyx_v_self->kr),__pyx_15,(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_16,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 852; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":861 */
  __pyx_5 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_5) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 861; goto __pyx_L1;}
  Py_DECREF(__pyx_5); __pyx_5 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":863 */
  __pyx_15 = PyString_AsString(__pyx_v_self->wxfile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 868; goto __pyx_L1;}
  __pyx_8 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_8) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 871; goto __pyx_L1;}
  __pyx_7 = PyTuple_New(1); if (!__pyx_7) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 871; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->wxfile);
  PyTuple_SET_ITEM(__pyx_7, 0, __pyx_v_self->wxfile);
  __pyx_9 = PyObject_CallObject(__pyx_8, __pyx_7); if (!__pyx_9) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 871; goto __pyx_L1;}
  Py_DECREF(__pyx_8); __pyx_8 = 0;
  Py_DECREF(__pyx_7); __pyx_7 = 0;
  __pyx_16 = PyInt_AsUnsignedLongMask(__pyx_9); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 871; goto __pyx_L1;}
  Py_DECREF(__pyx_9); __pyx_9 = 0;
  FC_FUNC_(scan_winkx, SCAN_WINKX)((&__pyx_v_self->numslp),(&__pyx_v_self->nwinkxe),(&__pyx_v_self->nwinkx),(&__pyx_v_self->kr),__pyx_15,(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_16,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 863; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":873 */
  __pyx_6 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_6) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 873; goto __pyx_L1;}
  Py_DECREF(__pyx_6); __pyx_6 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":875 */
  __pyx_2 = PyObject_GetAttr(__pyx_v_self->trace, __pyx_n_log); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 875; goto __pyx_L1;}
  __pyx_10 = PyTuple_New(1); if (!__pyx_10) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 875; goto __pyx_L1;}
  Py_INCREF(__pyx_k47p);
  PyTuple_SET_ITEM(__pyx_10, 0, __pyx_k47p);
  __pyx_1 = PyObject_CallObject(__pyx_2, __pyx_10); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 875; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_10); __pyx_10 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":877 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  Py_XDECREF(__pyx_6);
  Py_XDECREF(__pyx_7);
  Py_XDECREF(__pyx_8);
  Py_XDECREF(__pyx_9);
  Py_XDECREF(__pyx_10);
  Py_XDECREF(__pyx_11);
  __Pyx_AddTraceback("PyLithLib.PyLith.scan");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_pyre);
  Py_DECREF(__pyx_v_uparser);
  Py_DECREF(__pyx_v_neni);
  Py_DECREF(__pyx_v_i);
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_9PyLithLib_6PyLith_scan_connect(struct __pyx_obj_9PyLithLib_PyLith *__pyx_v_self) {
  int __pyx_v_errorcode;
  char (__pyx_v_errorstring[__pyx_e_9PyLithLib_errorstring_size]);
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  char (*__pyx_3);
  PyObject *__pyx_4 = 0;
  size_t __pyx_5;
  Py_INCREF(__pyx_v_self);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":884 */
  __pyx_v_errorcode = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":889 */
  __pyx_v_self->maxvfamilies = (__pyx_e_9constants_numberAllowedVolumeElementTypes * __pyx_v_self->numat);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":892 */
  __pyx_1 = PyInt_FromLong((3 * __pyx_v_self->maxvfamilies)); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 892; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 892; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 892; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 892; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->ivflist));
  __pyx_v_self->ivflist = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":894 */
  __pyx_3 = PyString_AsString(__pyx_v_self->connectivityInputFile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 905; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 908; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 908; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->connectivityInputFile);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_self->connectivityInputFile);
  __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_1); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 908; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_5 = PyInt_AsUnsignedLongMask(__pyx_4); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 908; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  FC_FUNC_(scan_connect, SCAN_CONNECT)(__pyx_v_self->neni,__pyx_v_self->infmatmod,__pyx_v_self->_infmat->ptr,__pyx_v_self->ivflist->ptr,(&__pyx_v_self->maxvfamilies),(&__pyx_v_self->numat),(&__pyx_v_self->numelv),(&__pyx_v_self->nvfamilies),(&__pyx_v_self->ietypev),(&__pyx_v_self->kr),__pyx_3,(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_5,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 894; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":910 */
  __pyx_2 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 910; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":912 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("PyLithLib.PyLith.scan_connect");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_k48p;
static PyObject *__pyx_k49p;
static PyObject *__pyx_k50p;

static char (__pyx_k48[]) = "Hello from pl3dsetup.read (begin)!";
static char (__pyx_k49[]) = "Reading problem definition and allocating necessary storage.";
static char (__pyx_k50[]) = "Hello from pl3dsetup.read (end)!";

static PyObject *__pyx_f_9PyLithLib_6PyLith_read(struct __pyx_obj_9PyLithLib_PyLith *__pyx_v_self) {
  int __pyx_v_errorcode;
  char (__pyx_v_errorstring[__pyx_e_9PyLithLib_errorstring_size]);
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  char (*__pyx_4);
  size_t __pyx_5;
  int __pyx_6;
  Py_INCREF(__pyx_v_self);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":927 */
  __pyx_v_errorcode = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":931 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self->trace, __pyx_n_log); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 931; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 931; goto __pyx_L1;}
  Py_INCREF(__pyx_k48p);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k48p);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 931; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":933 */
  if (__Pyx_PrintItem(__pyx_k49p) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 933; goto __pyx_L1;}
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 933; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":936 */
  __pyx_1 = ((struct __pyx_vtabstruct_9PyLithLib_PyLith *)__pyx_v_self->__pyx_vtab)->getdef(__pyx_v_self); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 936; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":942 */
  __pyx_2 = PyInt_FromLong((__pyx_e_9constants_numberSpaceDimensions * __pyx_v_self->numnp)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 942; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 942; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 942; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 942; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->x));
  __pyx_v_self->x = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":943 */
  __pyx_4 = PyString_AsString(__pyx_v_self->coordinateInputFile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 948; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 951; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 951; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->coordinateInputFile);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_self->coordinateInputFile);
  __pyx_1 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 951; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_5 = PyInt_AsUnsignedLongMask(__pyx_1); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 951; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  FC_FUNC_(read_coords, READ_COORDS)(__pyx_v_self->x->ptr,(&__pyx_v_self->cscale),(&__pyx_v_self->numnp),(&__pyx_v_self->kr),__pyx_4,(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_5,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 943; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":953 */
  __pyx_2 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 953; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":955 */
  __pyx_3 = PyInt_FromLong((__pyx_e_9constants_numberDegreesFreedom * __pyx_v_self->numnp)); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 955; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 955; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_3);
  __pyx_3 = 0;
  __pyx_2 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 955; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 955; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->ibond));
  __pyx_v_self->ibond = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":956 */
  __pyx_3 = PyInt_FromLong((__pyx_e_9constants_numberDegreesFreedom * __pyx_v_self->numnp)); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 956; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 956; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_3);
  __pyx_3 = 0;
  __pyx_2 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 956; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 956; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->bond));
  __pyx_v_self->bond = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":957 */
  __pyx_4 = PyString_AsString(__pyx_v_self->bcfile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 967; goto __pyx_L1;}
  __pyx_3 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 970; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 970; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->bcfile);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_self->bcfile);
  __pyx_2 = PyObject_CallObject(__pyx_3, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 970; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_5 = PyInt_AsUnsignedLongMask(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 970; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  FC_FUNC_(read_bc, READ_BC)(__pyx_v_self->bond->ptr,(&__pyx_v_self->dscale),(&__pyx_v_self->vscale),(&__pyx_v_self->fscale),__pyx_v_self->ibond->ptr,(&__pyx_v_self->numnp),(&__pyx_v_self->numbc),(&__pyx_v_self->numberConcForces),(&__pyx_v_self->kr),__pyx_4,(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_5,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 957; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":972 */
  __pyx_3 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 972; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":974 */
  __pyx_1 = PyInt_FromLong((__pyx_e_9constants_numberSkewDimensions * __pyx_v_self->numnp)); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 974; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 974; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_3 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 974; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_3, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 974; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->skew));
  __pyx_v_self->skew = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_3);
  __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":975 */
  __pyx_4 = PyString_AsString(__pyx_v_self->skfile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 982; goto __pyx_L1;}
  __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 985; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 985; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->skfile);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_self->skfile);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 985; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_5 = PyInt_AsUnsignedLongMask(__pyx_3); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 985; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  FC_FUNC_(read_skew, READ_SKEW)(__pyx_v_self->skew->ptr,(&__pyx_v_self->runits),(&__pyx_v_self->numrot),(&__pyx_v_self->numnp),(&__pyx_v_self->iskopt),(&__pyx_v_self->kr),__pyx_4,(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_5,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 975; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":987 */
  __pyx_1 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 987; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":993 */
  __pyx_2 = PyInt_FromLong(__pyx_v_self->nintg); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 993; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 993; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 993; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 993; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->delt));
  __pyx_v_self->delt = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":994 */
  __pyx_2 = PyInt_FromLong(__pyx_v_self->nintg); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 994; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 994; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 994; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 994; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->alfa));
  __pyx_v_self->alfa = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":995 */
  __pyx_2 = PyInt_FromLong(__pyx_v_self->nintg); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 995; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 995; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 995; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 995; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->utol));
  __pyx_v_self->utol = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":996 */
  __pyx_2 = PyInt_FromLong(__pyx_v_self->nintg); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 996; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 996; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 996; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 996; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->ftol));
  __pyx_v_self->ftol = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":997 */
  __pyx_2 = PyInt_FromLong(__pyx_v_self->nintg); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 997; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 997; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 997; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 997; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->etol));
  __pyx_v_self->etol = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":999 */
  __pyx_2 = PyInt_FromLong((__pyx_v_self->lastep + 1)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 999; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 999; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 999; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 999; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->times));
  __pyx_v_self->times = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1000 */
  __pyx_2 = PyInt_FromLong(__pyx_v_self->nintg); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1000; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1000; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1000; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1000; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->maxstp));
  __pyx_v_self->maxstp = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1001 */
  __pyx_2 = PyInt_FromLong(__pyx_v_self->nintg); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1001; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1001; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1001; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1001; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->maxit));
  __pyx_v_self->maxit = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1002 */
  __pyx_2 = PyInt_FromLong(__pyx_v_self->nintg); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1002; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1002; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1002; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1002; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->ntdinit));
  __pyx_v_self->ntdinit = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1003 */
  __pyx_2 = PyInt_FromLong(__pyx_v_self->nintg); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1003; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1003; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1003; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1003; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->lgdef));
  __pyx_v_self->lgdef = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1004 */
  __pyx_2 = PyInt_FromLong(__pyx_v_self->nintg); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1004; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1004; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1004; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1004; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->itmax));
  __pyx_v_self->itmax = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1005 */
  __pyx_4 = PyString_AsString(__pyx_v_self->timeStepInputFile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1021; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1024; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1024; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->timeStepInputFile);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_self->timeStepInputFile);
  __pyx_1 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1024; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_5 = PyInt_AsUnsignedLongMask(__pyx_1); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1024; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  FC_FUNC_(read_timdat, READ_TIMDAT)(__pyx_v_self->delt->ptr,__pyx_v_self->alfa->ptr,__pyx_v_self->utol->ptr,__pyx_v_self->ftol->ptr,__pyx_v_self->etol->ptr,__pyx_v_self->times->ptr,(&__pyx_v_self->tunits),__pyx_v_self->maxstp->ptr,__pyx_v_self->maxit->ptr,__pyx_v_self->ntdinit->ptr,__pyx_v_self->lgdef->ptr,__pyx_v_self->itmax->ptr,(&__pyx_v_self->nintg),(&__pyx_v_self->lastep),(&__pyx_v_self->kr),__pyx_4,(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_5,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1005; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1026 */
  __pyx_2 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1026; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1028 */
  __pyx_3 = PyInt_FromLong(__pyx_v_self->icontr); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1028; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1028; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_3);
  __pyx_3 = 0;
  __pyx_2 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1028; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1028; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->iprint));
  __pyx_v_self->iprint = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1029 */
  __pyx_4 = PyString_AsString(__pyx_v_self->fofile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1036; goto __pyx_L1;}
  __pyx_3 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1039; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1039; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->fofile);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_self->fofile);
  __pyx_2 = PyObject_CallObject(__pyx_3, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1039; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_5 = PyInt_AsUnsignedLongMask(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1039; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  FC_FUNC_(read_fuldat, READ_FULDAT)(__pyx_v_self->iprint->ptr,(&__pyx_v_self->icontr),(&__pyx_v_self->icode),(&__pyx_v_self->ncycle),(&__pyx_v_self->lastep),(&__pyx_v_self->kr),__pyx_4,(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_5,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1029; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1041 */
  __pyx_3 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1041; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1043 */
  __pyx_4 = PyString_AsString(__pyx_v_self->stfile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1047; goto __pyx_L1;}
  __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1050; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1050; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->stfile);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_self->stfile);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1050; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_5 = PyInt_AsUnsignedLongMask(__pyx_3); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1050; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  FC_FUNC_(read_stateout, READ_STATEOUT)(__pyx_v_self->istatout,__pyx_v_self->nstatout,(&__pyx_v_self->kr),__pyx_4,(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_5,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1043; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1052 */
  __pyx_1 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1052; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1054 */
  __pyx_2 = PyInt_FromLong(((__pyx_v_self->lastep + 1) * __pyx_v_self->nhist)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1054; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1054; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1054; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1054; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->histry));
  __pyx_v_self->histry = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1055 */
  __pyx_4 = PyString_AsString(__pyx_v_self->hfile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1061; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1064; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1064; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->hfile);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_self->hfile);
  __pyx_1 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1064; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_5 = PyInt_AsUnsignedLongMask(__pyx_1); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1064; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  FC_FUNC_(read_hist, READ_HIST)(__pyx_v_self->histry->ptr,__pyx_v_self->times->ptr,(&__pyx_v_self->nhist),(&__pyx_v_self->lastep),(&__pyx_v_self->kr),__pyx_4,(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_5,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1055; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1066 */
  __pyx_2 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1066; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1072 */
  __pyx_6 = (__pyx_v_self->nprestr != 0);
  if (!__pyx_6) {
    __pyx_6 = (__pyx_v_self->ipstrs != 0);
  }
  if (__pyx_6) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1073 */
    __pyx_v_self->nprestrflag = 1;
    goto __pyx_L2;
  }
  /*else*/ {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1075 */
    __pyx_v_self->nprestrflag = 0;
  }
  __pyx_L2:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1077 */
  __pyx_3 = PyInt_FromLong((__pyx_v_self->nen * __pyx_v_self->numelv)); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1077; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1077; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_3);
  __pyx_3 = 0;
  __pyx_2 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1077; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1077; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->ien));
  __pyx_v_self->ien = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1078 */
  __pyx_3 = PyInt_FromLong(__pyx_v_self->numelv); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1078; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1078; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_3);
  __pyx_3 = 0;
  __pyx_2 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1078; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1078; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->mat));
  __pyx_v_self->mat = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1079 */
  __pyx_4 = PyString_AsString(__pyx_v_self->connectivityInputFile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1087; goto __pyx_L1;}
  __pyx_3 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1090; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1090; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->connectivityInputFile);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_self->connectivityInputFile);
  __pyx_2 = PyObject_CallObject(__pyx_3, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1090; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_5 = PyInt_AsUnsignedLongMask(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1090; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  FC_FUNC_(read_connect, READ_CONNECT)(__pyx_v_self->ien->ptr,__pyx_v_self->mat->ptr,(&__pyx_v_self->nen),(&__pyx_v_self->numelv),(&__pyx_v_self->numnp),(&__pyx_v_self->nvfamilies),(&__pyx_v_self->kr),__pyx_4,(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_5,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1079; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1092 */
  __pyx_3 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1092; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1094 */
  __pyx_6 = __pyx_e_9PyLithLib_prestress;
  if (__pyx_6) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1110 */
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1113 */
  __pyx_1 = PyInt_FromLong((__pyx_v_self->nsnodes * __pyx_v_self->numtractions)); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1113; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1113; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_3 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1113; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_3, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1113; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->tractionverts));
  __pyx_v_self->tractionverts = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_3);
  __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1114 */
  __pyx_1 = PyInt_FromLong((__pyx_e_9constants_numberDegreesFreedom * __pyx_v_self->numtractions)); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1114; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1114; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_3 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1114; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_3, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1114; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->tractionvals));
  __pyx_v_self->tractionvals = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_3);
  __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1115 */
  __pyx_4 = PyString_AsString(__pyx_v_self->tractionInputFile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1122; goto __pyx_L1;}
  __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1125; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1125; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->tractionInputFile);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_self->tractionInputFile);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1125; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_5 = PyInt_AsUnsignedLongMask(__pyx_3); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1125; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  FC_FUNC_(read_tractions, READ_TRACTIONS)(__pyx_v_self->tractionverts->ptr,__pyx_v_self->tractionvals->ptr,(&__pyx_v_self->tscale),(&__pyx_v_self->numtractions),(&__pyx_v_self->nsnodes),(&__pyx_v_self->kr),__pyx_4,(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_5,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1115; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1127 */
  __pyx_1 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1127; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1130 */
  __pyx_2 = PyInt_FromLong((3 * __pyx_v_self->numfn)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1130; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1130; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1130; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1130; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->nfault));
  __pyx_v_self->nfault = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1131 */
  __pyx_2 = PyInt_FromLong((__pyx_e_9constants_numberDegreesFreedom * __pyx_v_self->numfn)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1131; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1131; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1131; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1131; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->fault));
  __pyx_v_self->fault = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1132 */
  __pyx_4 = PyString_AsString(__pyx_v_self->spfile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1140; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1143; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1143; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->spfile);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_self->spfile);
  __pyx_1 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1143; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_5 = PyInt_AsUnsignedLongMask(__pyx_1); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1143; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  FC_FUNC_(read_split, READ_SPLIT)(__pyx_v_self->fault->ptr,__pyx_v_self->nfault->ptr,(&__pyx_v_self->numfn),(&__pyx_v_self->numflt),(&__pyx_v_self->numnp),(&__pyx_v_self->numelv),(&__pyx_v_self->kr),__pyx_4,(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_5,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1132; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1145 */
  __pyx_2 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1145; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1150 */
  __pyx_3 = PyInt_FromLong((__pyx_e_9constants_numberSlipDimensions * __pyx_v_self->numslp)); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1150; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1150; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_3);
  __pyx_3 = 0;
  __pyx_2 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1150; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1150; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->nslip));
  __pyx_v_self->nslip = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1151 */
  __pyx_4 = PyString_AsString(__pyx_v_self->slfile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1158; goto __pyx_L1;}
  __pyx_3 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1161; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1161; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->slfile);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_self->slfile);
  __pyx_2 = PyObject_CallObject(__pyx_3, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1161; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_5 = PyInt_AsUnsignedLongMask(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1161; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  FC_FUNC_(read_slip, READ_SLIP)(__pyx_v_self->nslip->ptr,(&__pyx_v_self->numslp),(&__pyx_v_self->numsn),(&__pyx_v_self->numnp),(&__pyx_v_self->iskopt),(&__pyx_v_self->kr),__pyx_4,(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_5,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1151; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1163 */
  __pyx_3 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1163; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1165 */
  __pyx_1 = PyInt_FromLong(__pyx_v_self->numnp); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1165; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1165; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_3 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1165; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_3, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1165; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->idhist));
  __pyx_v_self->idhist = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_3);
  __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1166 */
  __pyx_1 = PyInt_FromLong((__pyx_e_9constants_numberDegreesFreedom * __pyx_v_self->numnp)); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1166; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1166; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_3 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1166; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_3, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1166; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->diforc));
  __pyx_v_self->diforc = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_3);
  __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1167 */
  __pyx_4 = PyString_AsString(__pyx_v_self->difile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1175; goto __pyx_L1;}
  __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1178; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1178; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->difile);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_self->difile);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1178; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_5 = PyInt_AsUnsignedLongMask(__pyx_3); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1178; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  FC_FUNC_(read_diff, READ_DIFF)(__pyx_v_self->diforc->ptr,__pyx_v_self->nslip->ptr,__pyx_v_self->idhist->ptr,(&__pyx_v_self->numslp),(&__pyx_v_self->numdif),(&__pyx_v_self->numnp),(&__pyx_v_self->kr),__pyx_4,(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_5,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1167; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1180 */
  __pyx_1 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1180; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1184 */
  __pyx_2 = PyInt_FromLong((__pyx_e_9constants_numberDegreesFreedom * __pyx_v_self->nwinke)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1184; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1184; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1184; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1184; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->iwinkdef));
  __pyx_v_self->iwinkdef = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1185 */
  __pyx_2 = PyInt_FromLong(__pyx_v_self->nwinke); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1185; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1185; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1185; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1185; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->iwinkid));
  __pyx_v_self->iwinkid = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1186 */
  __pyx_2 = PyInt_FromLong((__pyx_e_9constants_numberDegreesFreedom * __pyx_v_self->nwinke)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1186; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1186; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1186; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1186; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->winkdef));
  __pyx_v_self->winkdef = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1187 */
  __pyx_4 = PyString_AsString(__pyx_v_self->wfile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1195; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1198; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1198; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->wfile);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_self->wfile);
  __pyx_1 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1198; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_5 = PyInt_AsUnsignedLongMask(__pyx_1); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1198; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  FC_FUNC_(read_wink, READ_WINK)(__pyx_v_self->winkdef->ptr,__pyx_v_self->_wscal,__pyx_v_self->iwinkdef->ptr,__pyx_v_self->iwinkid->ptr,(&__pyx_v_self->nwink),(&__pyx_v_self->nwinke),(&__pyx_v_self->kr),__pyx_4,(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_5,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1187; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1200 */
  __pyx_2 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1200; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1202 */
  __pyx_3 = PyInt_FromLong((__pyx_e_9constants_numberDegreesFreedom * __pyx_v_self->nwinkxe)); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1202; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1202; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_3);
  __pyx_3 = 0;
  __pyx_2 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1202; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1202; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->iwinkxdef));
  __pyx_v_self->iwinkxdef = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1203 */
  __pyx_3 = PyInt_FromLong(__pyx_v_self->nwinkxe); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1203; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1203; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_3);
  __pyx_3 = 0;
  __pyx_2 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1203; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1203; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->iwinkxid));
  __pyx_v_self->iwinkxid = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1204 */
  __pyx_3 = PyInt_FromLong((__pyx_e_9constants_numberDegreesFreedom * __pyx_v_self->nwinkxe)); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1204; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1204; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_3);
  __pyx_3 = 0;
  __pyx_2 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1204; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1204; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->winkxdef));
  __pyx_v_self->winkxdef = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1205 */
  __pyx_4 = PyString_AsString(__pyx_v_self->wxfile); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1213; goto __pyx_L1;}
  __pyx_3 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1216; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1216; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->wxfile);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_self->wxfile);
  __pyx_2 = PyObject_CallObject(__pyx_3, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1216; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_5 = PyInt_AsUnsignedLongMask(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1216; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  FC_FUNC_(read_wink, READ_WINK)(__pyx_v_self->winkxdef->ptr,__pyx_v_self->_wxscal,__pyx_v_self->iwinkxdef->ptr,__pyx_v_self->iwinkxid->ptr,(&__pyx_v_self->nwinkx),(&__pyx_v_self->nwinkxe),(&__pyx_v_self->kr),__pyx_4,(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_5,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1205; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1218 */
  __pyx_3 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1218; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1220 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self->trace, __pyx_n_log); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1220; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1220; goto __pyx_L1;}
  Py_INCREF(__pyx_k50p);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k50p);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1220; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1222 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("PyLithLib.PyLith.read");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_n_intord;

static PyObject *__pyx_k51p;

static char (__pyx_k51[]) = "intord (%d) is not in [1, 2, 3]";

static PyObject *__pyx_f_9PyLithLib_6PyLith_getdef(struct __pyx_obj_9PyLithLib_PyLith *__pyx_v_self) {
  int __pyx_v_errorcode;
  char (__pyx_v_errorstring[__pyx_e_9PyLithLib_errorstring_size]);
  struct ElementType (*__pyx_v_elementType);
  int __pyx_v_nsgauss;
  int __pyx_v_nsd;
  int __pyx_v_nsd1;
  int __pyx_v_nec;
  int (*__pyx_v_infetype);
  int __pyx_v_numberSurfaceElementEquations;
  int __pyx_v_numberSurfaceElementCoordinates;
  int (*__pyx_v_infetype2d);
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1227 */
  if (!(__pyx_v_self->ietypev <= numElementTypes)) {
    PyErr_SetNone(PyExc_AssertionError);
    {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1227; goto __pyx_L1;}
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1231 */
  __pyx_v_errorcode = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1236 */
  __pyx_v_elementType = (&(elementTypes[(__pyx_v_self->ietypev - 1)]));

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1238 */
  __pyx_v_self->nen = __pyx_v_elementType->nodes;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1239 */
  __pyx_v_self->nsnodes = __pyx_v_elementType->nodes2d;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1241 */
  __pyx_1 = (__pyx_v_self->intord == 1);
  if (__pyx_1) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1242 */
    __pyx_v_self->ngauss = __pyx_v_elementType->fullGauss;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1243 */
    __pyx_v_nsgauss = __pyx_v_elementType->fullGauss2d;
    goto __pyx_L2;
  }
  __pyx_1 = (__pyx_v_self->intord == 2);
  if (__pyx_1) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1245 */
    __pyx_v_self->ngauss = __pyx_v_elementType->reducedGauss;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1246 */
    __pyx_v_nsgauss = __pyx_v_elementType->reducedGauss2d;
    goto __pyx_L2;
  }
  __pyx_1 = (__pyx_v_self->intord == 3);
  if (__pyx_1) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1248 */
    __pyx_v_self->ngauss = __pyx_v_elementType->fullGauss;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1249 */
    __pyx_v_nsgauss = __pyx_v_elementType->fullGauss2d;
    goto __pyx_L2;
  }
  /*else*/ {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1251 */
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1251; goto __pyx_L1;}
    __pyx_3 = __Pyx_GetName(__pyx_b, __pyx_n_intord); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1251; goto __pyx_L1;}
    __pyx_4 = PyNumber_Remainder(__pyx_k51p, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1251; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1251; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_4);
    __pyx_4 = 0;
    __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1251; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __Pyx_Raise(__pyx_4, 0, 0);
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1251; goto __pyx_L1;}
  }
  __pyx_L2:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1254 */
  __pyx_v_nsd = __pyx_e_9constants_numberSpaceDimensions;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1255 */
  __pyx_v_nsd1 = (__pyx_v_nsd + 1);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1257 */
  __pyx_2 = PyInt_FromLong(((__pyx_v_nsd1 * __pyx_v_self->nen) * __pyx_v_self->ngauss)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1257; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1257; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_4 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1257; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_4, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1257; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->sh));
  __pyx_v_self->sh = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_4);
  __pyx_4 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1258 */
  __pyx_2 = PyInt_FromLong(((__pyx_v_nsd1 * __pyx_v_self->nen) * __pyx_v_self->ngauss)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1258; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1258; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_4 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1258; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_4, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1258; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->shj));
  __pyx_v_self->shj = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_4);
  __pyx_4 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1259 */
  __pyx_2 = PyInt_FromLong((__pyx_v_nsd1 * __pyx_v_self->ngauss)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1259; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1259; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_4 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1259; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_4, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1259; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->gauss));
  __pyx_v_self->gauss = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_4);
  __pyx_4 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1261 */
  FC_FUNC(preshape, PRESHAPE)(__pyx_v_self->sh->ptr,__pyx_v_self->shj->ptr,__pyx_v_self->gauss->ptr,(&__pyx_v_self->intord),(&__pyx_v_self->ietypev),(&__pyx_v_self->nen),(&__pyx_v_self->ngauss),(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1261; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1272 */
  __pyx_2 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1272; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1274 */
  __pyx_3 = PyInt_FromLong(((__pyx_v_nsd * __pyx_v_self->nsnodes) * __pyx_v_nsgauss)); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1274; goto __pyx_L1;}
  __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1274; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_4, 0, __pyx_3);
  __pyx_3 = 0;
  __pyx_2 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_4); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1274; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1274; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->sh2d));
  __pyx_v_self->sh2d = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1275 */
  __pyx_3 = PyInt_FromLong((__pyx_v_nsd * __pyx_v_nsgauss)); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1275; goto __pyx_L1;}
  __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1275; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_4, 0, __pyx_3);
  __pyx_3 = 0;
  __pyx_2 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_4); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1275; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1275; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->gauss2d));
  __pyx_v_self->gauss2d = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1277 */
  FC_FUNC(preshape2d, PRESHAPE2D)(__pyx_v_self->sh2d->ptr,__pyx_v_self->gauss2d->ptr,(&__pyx_v_self->intord),(&__pyx_v_self->ietypev),(&__pyx_v_self->nsnodes),(&__pyx_v_nsgauss),(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1277; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1287 */
  __pyx_3 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1287; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1289 */
  __pyx_v_self->connectivitySize = (__pyx_v_self->numelv * __pyx_v_self->nen);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1295 */
  __pyx_v_self->nee = (__pyx_e_9constants_numberDegreesFreedom * __pyx_v_self->nen);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1297 */
  __pyx_v_nec = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1300 */
  __pyx_v_infetype = ((&(__pyx_v_self->infetype[0])) - 1);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1301 */
  (__pyx_v_infetype[1]) = __pyx_v_self->nen;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1302 */
  (__pyx_v_infetype[2]) = __pyx_v_self->ngauss;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1303 */
  (__pyx_v_infetype[3]) = __pyx_v_self->nee;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1304 */
  (__pyx_v_infetype[4]) = __pyx_v_nec;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1305 */
  if (!(4 == ((sizeof(__pyx_v_self->infetype)) / (sizeof((__pyx_v_self->infetype[0])))))) {
    PyErr_SetNone(PyExc_AssertionError);
    {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1305; goto __pyx_L1;}
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1312 */
  __pyx_v_numberSurfaceElementEquations = (__pyx_e_9constants_numberDegreesFreedom * __pyx_v_self->nsnodes);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1314 */
  __pyx_v_numberSurfaceElementCoordinates = (__pyx_e_9constants_numberSpaceDimensions * __pyx_v_self->nsnodes);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1318 */
  __pyx_v_infetype2d = ((&(__pyx_v_self->infetype2d[0])) - 1);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1319 */
  (__pyx_v_infetype2d[1]) = __pyx_v_self->nsnodes;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1320 */
  (__pyx_v_infetype2d[2]) = __pyx_v_nsgauss;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1321 */
  (__pyx_v_infetype2d[3]) = __pyx_v_numberSurfaceElementEquations;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1322 */
  (__pyx_v_infetype2d[4]) = __pyx_v_numberSurfaceElementCoordinates;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1323 */
  if (!(4 == ((sizeof(__pyx_v_self->infetype2d)) / (sizeof((__pyx_v_self->infetype2d[0])))))) {
    PyErr_SetNone(PyExc_AssertionError);
    {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1323; goto __pyx_L1;}
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1325 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("PyLithLib.PyLith.getdef");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_k52p;
static PyObject *__pyx_k53p;
static PyObject *__pyx_k54p;

static char (__pyx_k52[]) = "Hello from pl3dsetup.numberequations (begin)!";
static char (__pyx_k53[]) = "Numbering global equations.";
static char (__pyx_k54[]) = "Hello from pl3dsetup.numberequations (end)!";

static PyObject *__pyx_f_9PyLithLib_6PyLith_numberequations(struct __pyx_obj_9PyLithLib_PyLith *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  Py_INCREF(__pyx_v_self);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1332 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self->trace, __pyx_n_log); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1332; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1332; goto __pyx_L1;}
  Py_INCREF(__pyx_k52p);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k52p);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1332; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1334 */
  if (__Pyx_PrintItem(__pyx_k53p) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1334; goto __pyx_L1;}
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1334; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1338 */
  __pyx_1 = PyInt_FromLong(__pyx_v_self->numflt); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1338; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1338; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_3 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1338; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_3, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1338; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->idftn));
  __pyx_v_self->idftn = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_3);
  __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1340 */
  FC_FUNC_(id_split, ID_SPLIT)(__pyx_v_self->nfault->ptr,__pyx_v_self->idftn->ptr,(&__pyx_v_self->numnp),(&__pyx_v_self->numfn),(&__pyx_v_self->numflt)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1340; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1348 */
  __pyx_1 = PyInt_FromLong((__pyx_e_9constants_numberSpaceDimensions * __pyx_v_self->numnp)); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1348; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1348; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_3 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1348; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_3, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1348; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->id));
  __pyx_v_self->id = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_3);
  __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1349 */
  __pyx_1 = PyInt_FromLong((__pyx_e_9constants_numberSpaceDimensions * __pyx_v_self->numnp)); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1349; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1349; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_3 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1349; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_3, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1349; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->idx));
  __pyx_v_self->idx = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_3);
  __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1350 */
  __pyx_1 = PyInt_FromLong(__pyx_v_self->numnp); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1350; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1350; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_3 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1350; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_3, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1350; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->idslp));
  __pyx_v_self->idslp = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_3);
  __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1354 */
  FC_FUNC_(create_id, CREATE_ID)(__pyx_v_self->id->ptr,__pyx_v_self->idx->ptr,__pyx_v_self->ibond->ptr,__pyx_v_self->nslip->ptr,__pyx_v_self->idslp->ptr,(&__pyx_v_self->numslp),(&__pyx_v_self->numnp),(&__pyx_v_self->numsn),(&__pyx_v_self->neq)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1354; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1366 */
  __pyx_1 = PyInt_FromLong((__pyx_e_9constants_numberSlipNeighbors * __pyx_v_self->numsn)); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1366; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1366; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_3 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1366; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_3, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1366; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->ipslp));
  __pyx_v_self->ipslp = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_3);
  __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1371 */
  __pyx_4 = (__pyx_v_self->numsn != 0);
  if (__pyx_4) {
    __pyx_4 = (__pyx_v_self->iskopt == 2);
  }
  if (__pyx_4) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1372 */
    __pyx_1 = ((struct __pyx_vtabstruct_9PyLithLib_PyLith *)__pyx_v_self->__pyx_vtab)->nfind(__pyx_v_self); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1372; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1376 */
  __pyx_2 = PyInt_FromLong(__pyx_v_self->nwink); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1376; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1376; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1376; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1376; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->wink));
  __pyx_v_self->wink = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1377 */
  __pyx_2 = PyInt_FromLong((2 * __pyx_v_self->nwink)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1377; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1377; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1377; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1377; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->iwink));
  __pyx_v_self->iwink = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1379 */
  FC_FUNC_(assign_wink, ASSIGN_WINK)(__pyx_v_self->winkdef->ptr,__pyx_v_self->wink->ptr,__pyx_v_self->iwinkdef->ptr,__pyx_v_self->iwinkid->ptr,__pyx_v_self->iwink->ptr,__pyx_v_self->id->ptr,(&__pyx_v_self->numnp),(&__pyx_v_self->nwink),(&__pyx_v_self->nwinke)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1379; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1392 */
  __pyx_2 = PyInt_FromLong(__pyx_v_self->nwinkx); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1392; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1392; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1392; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1392; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->winkx));
  __pyx_v_self->winkx = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1393 */
  __pyx_2 = PyInt_FromLong((2 * __pyx_v_self->nwinkx)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1393; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1393; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1393; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1393; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->iwinkx));
  __pyx_v_self->iwinkx = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1395 */
  FC_FUNC_(assign_wink, ASSIGN_WINK)(__pyx_v_self->winkxdef->ptr,__pyx_v_self->winkx->ptr,__pyx_v_self->iwinkxdef->ptr,__pyx_v_self->iwinkxid->ptr,__pyx_v_self->iwinkx->ptr,__pyx_v_self->idx->ptr,(&__pyx_v_self->numnp),(&__pyx_v_self->nwinkx),(&__pyx_v_self->nwinkxe)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1395; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1406 */
  __pyx_2 = PyObject_GetAttr(__pyx_v_self->trace, __pyx_n_log); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1406; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1406; goto __pyx_L1;}
  Py_INCREF(__pyx_k54p);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_k54p);
  __pyx_1 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1406; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1408 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("PyLithLib.PyLith.numberequations");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_9PyLithLib_6PyLith_nfind(struct __pyx_obj_9PyLithLib_PyLith *__pyx_v_self) {
  struct __pyx_obj_9PyLithLib_DoubleArray *__pyx_v_xtmp;
  struct __pyx_obj_9PyLithLib_IntArray *__pyx_v_itmp;
  struct __pyx_obj_9PyLithLib_IntArray *__pyx_v_itmp1;
  struct __pyx_obj_9PyLithLib_IntArray *__pyx_v_itmp2;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  Py_INCREF(__pyx_v_self);
  __pyx_v_xtmp = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  __pyx_v_itmp = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  __pyx_v_itmp1 = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  __pyx_v_itmp2 = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1417 */
  __pyx_1 = PyInt_FromLong(__pyx_v_self->numsn); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1417; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1417; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1417; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1417; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_xtmp));
  __pyx_v_xtmp = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1418 */
  __pyx_2 = PyInt_FromLong(__pyx_v_self->numsn); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1418; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1418; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_2 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1418; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1418; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_itmp));
  __pyx_v_itmp = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1419 */
  __pyx_1 = PyInt_FromLong(__pyx_v_self->numsn); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1419; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1419; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1419; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1419; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_itmp1));
  __pyx_v_itmp1 = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1420 */
  __pyx_2 = PyInt_FromLong(__pyx_v_self->numsn); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1420; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1420; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_2 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1420; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1420; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_itmp2));
  __pyx_v_itmp2 = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1422 */
  FC_FUNC(nfind, NFIND)(__pyx_v_self->x->ptr,__pyx_v_xtmp->ptr,__pyx_v_self->idslp->ptr,__pyx_v_self->ipslp->ptr,__pyx_v_itmp->ptr,__pyx_v_itmp1->ptr,__pyx_v_itmp2->ptr,__pyx_v_self->nslip->ptr,(&__pyx_v_self->numslp),(&__pyx_v_self->numsn),(&__pyx_v_self->numnp)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1422; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1435 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("PyLithLib.PyLith.nfind");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_xtmp);
  Py_DECREF(__pyx_v_itmp);
  Py_DECREF(__pyx_v_itmp1);
  Py_DECREF(__pyx_v_itmp2);
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_k55p;
static PyObject *__pyx_k56p;
static PyObject *__pyx_k57p;

static char (__pyx_k55[]) = "Hello from pl3dsetup.sortmesh (begin)!";
static char (__pyx_k56[]) = "Renumbering elements, split nodes, and slippery nodes.";
static char (__pyx_k57[]) = "Hello from pl3dsetup.sortmesh (end)!";

static PyObject *__pyx_f_9PyLithLib_6PyLith_sortmesh(struct __pyx_obj_9PyLithLib_PyLith *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1443 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self->trace, __pyx_n_log); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1443; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1443; goto __pyx_L1;}
  Py_INCREF(__pyx_k55p);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k55p);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1443; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1445 */
  if (__Pyx_PrintItem(__pyx_k56p) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1445; goto __pyx_L1;}
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1445; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1447 */
  __pyx_1 = ((struct __pyx_vtabstruct_9PyLithLib_PyLith *)__pyx_v_self->__pyx_vtab)->sort_elements(__pyx_v_self); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1447; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1450 */
  FC_FUNC_(sort_split_nodes, SORT_SPLIT_NODES)(__pyx_v_self->nfault->ptr,__pyx_v_self->indxiel->ptr,(&__pyx_v_self->numfn),(&__pyx_v_self->numelv)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1450; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1457 */
  FC_FUNC_(sort_slip_nodes, SORT_SLIP_NODES)(__pyx_v_self->nslip->ptr,__pyx_v_self->indxiel->ptr,(&__pyx_v_self->numslp),(&__pyx_v_self->numelv)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1457; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1463 */
  __pyx_2 = PyObject_GetAttr(__pyx_v_self->trace, __pyx_n_log); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1463; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1463; goto __pyx_L1;}
  Py_INCREF(__pyx_k57p);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_k57p);
  __pyx_1 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1463; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1465 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("PyLithLib.PyLith.sortmesh");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_9PyLithLib_6PyLith_sort_elements(struct __pyx_obj_9PyLithLib_PyLith *__pyx_v_self) {
  struct __pyx_obj_9PyLithLib_IntArray *__pyx_v_ivftmp;
  int __pyx_v_errorcode;
  char (__pyx_v_errorstring[__pyx_e_9PyLithLib_errorstring_size]);
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  Py_INCREF(__pyx_v_self);
  __pyx_v_ivftmp = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1475 */
  __pyx_1 = PyInt_FromLong((__pyx_v_self->nen * __pyx_v_self->numelv)); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1475; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1475; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1475; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1475; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->iens));
  __pyx_v_self->iens = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1476 */
  __pyx_2 = PyInt_FromLong((6 * __pyx_v_self->nvfamilies)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1476; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1476; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_2 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1476; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1476; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->ivfamily));
  __pyx_v_self->ivfamily = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1477 */
  __pyx_1 = PyInt_FromLong(__pyx_v_self->numelv); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1477; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1477; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1477; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1477; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->indxiel));
  __pyx_v_self->indxiel = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1478 */
  __pyx_2 = PyInt_FromLong(__pyx_v_self->numelv); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1478; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1478; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_2 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1478; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1478; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->ielindx));
  __pyx_v_self->ielindx = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1481 */
  __pyx_1 = PyInt_FromLong(__pyx_v_self->nvfamilies); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1481; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1481; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1481; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1481; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_ivftmp));
  __pyx_v_ivftmp = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1485 */
  __pyx_v_errorcode = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1487 */
  FC_FUNC_(sort_elements, SORT_ELEMENTS)(__pyx_v_self->ien->ptr,__pyx_v_self->mat->ptr,__pyx_v_self->infmatmod,__pyx_v_self->ivflist->ptr,__pyx_v_self->ivfamily->ptr,__pyx_v_self->iens->ptr,__pyx_v_ivftmp->ptr,__pyx_v_self->indxiel->ptr,__pyx_v_self->ielindx->ptr,(&__pyx_v_self->nen),(&__pyx_v_self->ngauss),(&__pyx_v_self->maxvfamilies),(&__pyx_v_self->nvfamilies),(&__pyx_v_self->nprestrflag),(&__pyx_v_self->numelv),(&__pyx_v_self->numnp),(&__pyx_v_self->nstatesz),(&__pyx_v_self->nstatesz0),(&__pyx_v_self->npropsz),(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1487; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1510 */
  __pyx_2 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1510; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1512 */
  Py_INCREF(Py_None);
  Py_DECREF(((PyObject *)__pyx_v_self->ien));
  __pyx_v_self->ien = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1513 */
  Py_INCREF(Py_None);
  Py_DECREF(((PyObject *)__pyx_v_self->mat));
  __pyx_v_self->mat = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1514 */
  Py_INCREF(Py_None);
  Py_DECREF(((PyObject *)__pyx_v_self->ivflist));
  __pyx_v_self->ivflist = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1516 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("PyLithLib.PyLith.sort_elements");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_ivftmp);
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_n_Iterate;

static PyObject *__pyx_k58p;
static PyObject *__pyx_k59p;
static PyObject *__pyx_k60p;

static char (__pyx_k58[]) = "AutoPrestress Solve";
static char (__pyx_k59[]) = "Elastic Solve";
static char (__pyx_k60[]) = "Viscous Solve";

static PyObject *__pyx_f_9PyLithLib_6PyLith_setupPETScLogging(struct __pyx_obj_9PyLithLib_PyLith *__pyx_v_self) {
  PyObject *__pyx_r;
  Py_INCREF(__pyx_v_self);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1521 */
  __pyx_v_self->autoprestrStage = __pyx_f_9PyLithLib_PetscLogStageRegister(__pyx_k58p);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1522 */
  __pyx_v_self->elasticStage = __pyx_f_9PyLithLib_PetscLogStageRegister(__pyx_k59p);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1523 */
  __pyx_v_self->viscousStage = __pyx_f_9PyLithLib_PetscLogStageRegister(__pyx_k60p);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1525 */
  __pyx_v_self->iterateEvent = __pyx_f_9PyLithLib_PetscLogEventRegister(__pyx_n_Iterate,KSP_COOKIE);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1527 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_n_False;

static PyObject *__pyx_k62p;
static PyObject *__pyx_k63p;
static PyObject *__pyx_k64p;
static PyObject *__pyx_k65p;
static PyObject *__pyx_k66p;
static PyObject *__pyx_k67p;
static PyObject *__pyx_k68p;
static PyObject *__pyx_k69p;
static PyObject *__pyx_k70p;
static PyObject *__pyx_k71p;
static PyObject *__pyx_k72p;
static PyObject *__pyx_k73p;
static PyObject *__pyx_k74p;
static PyObject *__pyx_k75p;
static PyObject *__pyx_k76p;

static char (__pyx_k62[]) = "Hello from pl3dsetup.sparsesetup (begin)!";
static char (__pyx_k63[]) = "Setting up sparse matrix storage.";
static char (__pyx_k64[]) = "";
static char (__pyx_k65[]) = "";
static char (__pyx_k66[]) = "Sparse matrix information:";
static char (__pyx_k67[]) = "";
static char (__pyx_k68[]) = "numberGlobalEquations:     %i";
static char (__pyx_k69[]) = "workingArraySize:          %i";
static char (__pyx_k70[]) = "stiffnessMatrixSize:       %i";
static char (__pyx_k71[]) = "stiffnessOffDiagonalSize:  %i";
static char (__pyx_k72[]) = "minimumNonzeroTermsPerRow: %i";
static char (__pyx_k73[]) = "maximumNonzeroTermsPerRow: %i";
static char (__pyx_k74[]) = "averageNonzeroTermsPerRow: %g";
static char (__pyx_k75[]) = "";
static char (__pyx_k76[]) = "Hello from pl3dsetup.sparsesetup (end)!";

static PyObject *__pyx_f_9PyLithLib_6PyLith_sparsesetup(struct __pyx_obj_9PyLithLib_PyLith *__pyx_v_self) {
  int __pyx_v_errorcode;
  char (__pyx_v_errorstring[__pyx_e_9PyLithLib_errorstring_size]);
  int __pyx_v_iwork;
  struct __pyx_obj_9PyLithLib_IntArray *__pyx_v_indx;
  struct __pyx_obj_9PyLithLib_IntArray *__pyx_v_link;
  struct __pyx_obj_9PyLithLib_IntArray *__pyx_v_nbrs;
  int __pyx_v_nsizea;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  Py_INCREF(__pyx_v_self);
  __pyx_v_indx = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  __pyx_v_link = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  __pyx_v_nbrs = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1536 */
  __pyx_v_errorcode = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1538 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self->trace, __pyx_n_log); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1538; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1538; goto __pyx_L1;}
  Py_INCREF(__pyx_k62p);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k62p);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1538; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1540 */
  if (__Pyx_PrintItem(__pyx_k63p) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1540; goto __pyx_L1;}
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1540; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1542 */
  __pyx_1 = ((struct __pyx_vtabstruct_9PyLithLib_PyLith *)__pyx_v_self->__pyx_vtab)->setupPETScLogging(__pyx_v_self); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1542; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1547 */
  __pyx_2 = PyInt_FromLong((__pyx_e_9constants_numberDegreesFreedom * __pyx_v_self->connectivitySize)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1547; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1547; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1547; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1547; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->lm));
  __pyx_v_self->lm = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1548 */
  FC_FUNC(local, LOCAL)(__pyx_v_self->id->ptr,(&__pyx_v_self->numnp),__pyx_v_self->iens->ptr,__pyx_v_self->lm->ptr,(&__pyx_v_self->numelv),(&__pyx_v_self->nen)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1548; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1556 */
  __pyx_2 = PyInt_FromLong(__pyx_v_self->connectivitySize); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1556; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1556; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1556; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1556; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->lmf));
  __pyx_v_self->lmf = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1557 */
  FC_FUNC(localf, LOCALF)(__pyx_v_self->iens->ptr,__pyx_v_self->lmf->ptr,(&__pyx_v_self->numelv),__pyx_v_self->nfault->ptr,(&__pyx_v_self->numfn),(&__pyx_v_self->nen)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1557; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1565 */
  __pyx_2 = PyInt_FromLong((__pyx_e_9constants_numberDegreesFreedom * __pyx_v_self->connectivitySize)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1565; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1565; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1565; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1565; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->lmx));
  __pyx_v_self->lmx = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1566 */
  FC_FUNC(localx, LOCALX)(__pyx_v_self->idx->ptr,(&__pyx_v_self->numnp),__pyx_v_self->iens->ptr,__pyx_v_self->lmx->ptr,(&__pyx_v_self->numelv),__pyx_v_self->nslip->ptr,(&__pyx_v_self->numslp),(&__pyx_v_self->nen)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1566; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1577 */
  __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_False); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1577; goto __pyx_L1;}
  __pyx_4 = PyObject_IsTrue(__pyx_2); if (__pyx_4 < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1577; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (__pyx_4) {
    Py_INCREF(Py_None);
    Py_DECREF(((PyObject *)__pyx_v_self->nslip));
    __pyx_v_self->nslip = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None);
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1582 */
  __pyx_v_iwork = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1583 */
  FC_FUNC_(cmp_stiffsz, CMP_STIFFSZ)((&__pyx_v_self->neq),__pyx_v_self->lm->ptr,__pyx_v_self->lmx->ptr,(&__pyx_v_self->numelv),(&__pyx_v_iwork),(&__pyx_v_self->numsn),(&__pyx_v_self->nen),(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1583; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1594 */
  __pyx_3 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1594; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1598 */
  __pyx_1 = PyInt_FromLong(__pyx_v_self->neq); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1598; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1598; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_3 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1598; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_3, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1598; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_indx));
  __pyx_v_indx = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_3);
  __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1599 */
  __pyx_1 = PyInt_FromLong(__pyx_v_iwork); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1599; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1599; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_3 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1599; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_3, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1599; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_link));
  __pyx_v_link = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_3);
  __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1600 */
  __pyx_1 = PyInt_FromLong(__pyx_v_iwork); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1600; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1600; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_3 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_IntArray), __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1600; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_3, __pyx_ptype_9PyLithLib_IntArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1600; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_nbrs));
  __pyx_v_nbrs = ((struct __pyx_obj_9PyLithLib_IntArray *)__pyx_3);
  __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1604 */
  FC_FUNC(lnklst, LNKLST)((&__pyx_v_self->neq),__pyx_v_self->lm->ptr,__pyx_v_self->lmx->ptr,(&__pyx_v_self->numelv),(&__pyx_v_self->nen),(&__pyx_v_self->nee),__pyx_v_indx->ptr,__pyx_v_link->ptr,__pyx_v_nbrs->ptr,(&__pyx_v_iwork),(&__pyx_v_nsizea),(&__pyx_v_self->nnz),(&__pyx_v_self->numsn),(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1604; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1621 */
  __pyx_1 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1621; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1623 */
  __pyx_2 = ((struct __pyx_vtabstruct_13PyLithMeshLib_Mesh *)__pyx_v_self->_mesh->__pyx_vtab)->createMat(__pyx_v_self->_mesh); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1623; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1625 */
  FC_FUNC(makemsr, MAKEMSR)((&__pyx_v_self->_mesh->A),__pyx_v_indx->ptr,__pyx_v_link->ptr,__pyx_v_nbrs->ptr,(&__pyx_v_self->neq),(&__pyx_v_self->nnz),(&__pyx_v_iwork),(&__pyx_v_self->nmin),(&__pyx_v_self->nmax),(&__pyx_v_self->wavg)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1625; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1637 */
  if (__Pyx_PrintItem(__pyx_k64p) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1637; goto __pyx_L1;}
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1637; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1638 */
  if (__Pyx_PrintItem(__pyx_k65p) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1638; goto __pyx_L1;}
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1638; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1639 */
  if (__Pyx_PrintItem(__pyx_k66p) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1639; goto __pyx_L1;}
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1639; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1640 */
  if (__Pyx_PrintItem(__pyx_k67p) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1640; goto __pyx_L1;}
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1640; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1641 */
  __pyx_3 = PyInt_FromLong(__pyx_v_self->neq); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1641; goto __pyx_L1;}
  __pyx_1 = PyNumber_Remainder(__pyx_k68p, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1641; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (__Pyx_PrintItem(__pyx_1) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1641; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1641; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1642 */
  __pyx_2 = PyInt_FromLong(__pyx_v_iwork); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1642; goto __pyx_L1;}
  __pyx_3 = PyNumber_Remainder(__pyx_k69p, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1642; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (__Pyx_PrintItem(__pyx_3) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1642; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1642; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1643 */
  __pyx_1 = PyInt_FromLong((__pyx_v_self->nnz - 1)); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1643; goto __pyx_L1;}
  __pyx_2 = PyNumber_Remainder(__pyx_k70p, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1643; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (__Pyx_PrintItem(__pyx_2) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1643; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1643; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1644 */
  __pyx_3 = PyInt_FromLong(__pyx_v_nsizea); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1644; goto __pyx_L1;}
  __pyx_1 = PyNumber_Remainder(__pyx_k71p, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1644; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (__Pyx_PrintItem(__pyx_1) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1644; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1644; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1645 */
  __pyx_2 = PyInt_FromLong(__pyx_v_self->nmin); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1645; goto __pyx_L1;}
  __pyx_3 = PyNumber_Remainder(__pyx_k72p, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1645; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (__Pyx_PrintItem(__pyx_3) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1645; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1645; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1646 */
  __pyx_1 = PyInt_FromLong(__pyx_v_self->nmax); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1646; goto __pyx_L1;}
  __pyx_2 = PyNumber_Remainder(__pyx_k73p, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1646; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (__Pyx_PrintItem(__pyx_2) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1646; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1646; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1647 */
  __pyx_3 = PyFloat_FromDouble(__pyx_v_self->wavg); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1647; goto __pyx_L1;}
  __pyx_1 = PyNumber_Remainder(__pyx_k74p, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1647; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (__Pyx_PrintItem(__pyx_1) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1647; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1647; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1648 */
  if (__Pyx_PrintItem(__pyx_k75p) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1648; goto __pyx_L1;}
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1648; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1650 */
  __pyx_2 = PyObject_GetAttr(__pyx_v_self->trace, __pyx_n_log); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1650; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1650; goto __pyx_L1;}
  Py_INCREF(__pyx_k76p);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_k76p);
  __pyx_1 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1650; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1652 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("PyLithLib.PyLith.sparsesetup");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_indx);
  Py_DECREF(__pyx_v_link);
  Py_DECREF(__pyx_v_nbrs);
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_k77p;
static PyObject *__pyx_k78p;
static PyObject *__pyx_k79p;

static char (__pyx_k77[]) = "Hello from pl3dsetup.allocateremaining (begin)!";
static char (__pyx_k78[]) = "Allocating remaining storage.";
static char (__pyx_k79[]) = "Hello from pl3dsetup.allocateremaining (end)!";

static PyObject *__pyx_f_9PyLithLib_6PyLith_allocateremaining(struct __pyx_obj_9PyLithLib_PyLith *__pyx_v_self) {
  int __pyx_v_ntractflag;
  int __pyx_v_ngravflag;
  int __pyx_v_nconcflag;
  int __pyx_v_nextflag;
  int __pyx_v_nwinkflag;
  int __pyx_v_nwinkxflag;
  int __pyx_v_dim;
  PyObject *__pyx_v_i;
  PyObject *__pyx_v_listIddmat;
  int (*__pyx_v_nforce);
  int (*__pyx_v_ncodat);
  int (*__pyx_v_npar);
  int (*__pyx_v_nprint);
  int (*__pyx_v_nsysdat);
  int (*__pyx_v_nunits);
  int (*__pyx_v_nvisdat);
  double (*__pyx_v_rgiter);
  double (*__pyx_v_rtimdat);
  double __pyx_v_deltp;
  double __pyx_v_alfap;
  int (*__pyx_v_ntimdat);
  int __pyx_v_nstep;
  int __pyx_v_maxitp;
  int __pyx_v_ntdinitp;
  int __pyx_v_lgdefp;
  int __pyx_v_itmaxp;
  int __pyx_v_nittot;
  int __pyx_v_nrftot;
  int __pyx_v_ireform;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  long __pyx_5;
  int __pyx_6;
  PyObject *__pyx_7 = 0;
  PyObject *__pyx_8 = 0;
  PyObject *__pyx_9 = 0;
  PyObject *__pyx_10 = 0;
  PyObject *__pyx_11 = 0;
  PyObject *__pyx_12 = 0;
  PyObject *__pyx_13 = 0;
  PyObject *__pyx_14 = 0;
  PyObject *__pyx_15 = 0;
  PyObject *__pyx_16 = 0;
  PyObject *__pyx_17 = 0;
  PyObject *__pyx_18 = 0;
  PyObject *__pyx_19 = 0;
  PyObject *__pyx_20 = 0;
  PyObject *__pyx_21 = 0;
  PyObject *__pyx_22 = 0;
  PyObject *__pyx_23 = 0;
  PyObject *__pyx_24 = 0;
  PyObject *__pyx_25 = 0;
  PyObject *__pyx_26 = 0;
  PyObject *__pyx_27 = 0;
  PyObject *__pyx_28 = 0;
  PyObject *__pyx_29 = 0;
  PyObject *__pyx_30 = 0;
  PyObject *__pyx_31 = 0;
  PyObject *__pyx_32 = 0;
  PyObject *__pyx_33 = 0;
  PyObject *__pyx_34 = 0;
  PyObject *__pyx_35 = 0;
  PyObject *__pyx_36 = 0;
  PyObject *__pyx_37 = 0;
  PyObject *__pyx_38 = 0;
  PyObject *__pyx_39 = 0;
  PyObject *__pyx_40 = 0;
  Py_INCREF(__pyx_v_self);
  __pyx_v_i = Py_None; Py_INCREF(Py_None);
  __pyx_v_listIddmat = Py_None; Py_INCREF(Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1659 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self->trace, __pyx_n_log); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1659; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1659; goto __pyx_L1;}
  Py_INCREF(__pyx_k77p);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k77p);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1659; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1661 */
  if (__Pyx_PrintItem(__pyx_k78p) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1661; goto __pyx_L1;}
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1661; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1670 */
  __pyx_4 = (__pyx_v_self->numtractions != 0);
  if (__pyx_4) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1671 */
    __pyx_v_ntractflag = 1;
    goto __pyx_L2;
  }
  /*else*/ {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1673 */
    __pyx_v_ntractflag = 0;
  }
  __pyx_L2:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1675 */
  __pyx_v_ngravflag = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1676 */
  __pyx_v_dim = ((sizeof(__pyx_v_self->_grav)) / (sizeof((__pyx_v_self->_grav[0]))));

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1677 */
  for (__pyx_5 = 0; __pyx_5 < __pyx_v_dim; ++__pyx_5) {
    __pyx_1 = PyInt_FromLong(__pyx_5); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1677; goto __pyx_L1;}
    Py_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_1;
    __pyx_1 = 0;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1678 */
    __pyx_4 = PyInt_AsLong(__pyx_v_i); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1678; goto __pyx_L1;}
    __pyx_6 = ((__pyx_v_self->_grav[__pyx_4]) != 0.0);
    if (__pyx_6) {

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1679 */
      __pyx_v_ngravflag = 1;

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1680 */
      goto __pyx_L4;
      goto __pyx_L5;
    }
    __pyx_L5:;
  }
  __pyx_L4:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1682 */
  __pyx_4 = (__pyx_v_self->numberConcForces != 0);
  if (!__pyx_4) {
    __pyx_4 = (__pyx_v_self->numdif != 0);
  }
  if (__pyx_4) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1683 */
    __pyx_v_nconcflag = 1;
    goto __pyx_L6;
  }
  /*else*/ {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1685 */
    __pyx_v_nconcflag = 0;
  }
  __pyx_L6:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1686 */
  __pyx_6 = (__pyx_v_ntractflag != 0);
  if (!__pyx_6) {
    __pyx_6 = (__pyx_v_ngravflag != 0);
    if (!__pyx_6) {
      __pyx_6 = (__pyx_v_nconcflag != 0);
    }
  }
  if (__pyx_6) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1687 */
    __pyx_v_nextflag = 1;
    goto __pyx_L7;
  }
  /*else*/ {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1689 */
    __pyx_v_nextflag = 0;
  }
  __pyx_L7:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1690 */
  __pyx_4 = (__pyx_v_self->nwink != 0);
  if (__pyx_4) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1691 */
    __pyx_v_nwinkflag = 1;
    goto __pyx_L8;
  }
  /*else*/ {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1693 */
    __pyx_v_nwinkflag = 0;
  }
  __pyx_L8:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1694 */
  __pyx_6 = (__pyx_v_self->nwinkx != 0);
  if (__pyx_6) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1695 */
    __pyx_v_nwinkxflag = 1;
    goto __pyx_L9;
  }
  /*else*/ {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1697 */
    __pyx_v_nwinkxflag = 0;
  }
  __pyx_L9:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1699 */
  __pyx_2 = PyInt_FromLong((__pyx_v_nextflag * __pyx_v_self->neq)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1699; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1699; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1699; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1699; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->bextern));
  __pyx_v_self->bextern = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1700 */
  __pyx_2 = PyInt_FromLong((__pyx_v_ntractflag * __pyx_v_self->neq)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1700; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1700; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1700; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1700; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->btraction));
  __pyx_v_self->btraction = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1701 */
  __pyx_2 = PyInt_FromLong((__pyx_v_ngravflag * __pyx_v_self->neq)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1701; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1701; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1701; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1701; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->bgravity));
  __pyx_v_self->bgravity = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1702 */
  __pyx_2 = PyInt_FromLong((__pyx_v_nconcflag * __pyx_v_self->neq)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1702; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1702; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1702; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1702; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->bconcForce));
  __pyx_v_self->bconcForce = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1703 */
  __pyx_2 = PyInt_FromLong((__pyx_v_nwinkflag * __pyx_v_self->neq)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1703; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1703; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1703; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1703; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->bwink));
  __pyx_v_self->bwink = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1704 */
  __pyx_2 = PyInt_FromLong((__pyx_v_nwinkxflag * __pyx_v_self->neq)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1704; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1704; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1704; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1704; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->bwinkx));
  __pyx_v_self->bwinkx = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1705 */
  __pyx_2 = PyInt_FromLong(__pyx_v_self->neq); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1705; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1705; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1705; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1705; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->bintern));
  __pyx_v_self->bintern = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1706 */
  __pyx_2 = PyInt_FromLong(__pyx_v_self->neq); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1706; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1706; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1706; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1706; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->bresid));
  __pyx_v_self->bresid = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1707 */
  __pyx_2 = PyInt_FromLong(__pyx_v_self->neq); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1707; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1707; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1707; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1707; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->dispVec));
  __pyx_v_self->dispVec = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1708 */
  __pyx_2 = PyInt_FromLong((__pyx_v_self->nprevdflag * __pyx_v_self->neq)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1708; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1708; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1708; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1708; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->dprev));
  __pyx_v_self->dprev = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1711 */
  __pyx_2 = PyInt_FromLong((__pyx_e_9constants_numberDegreesFreedom * __pyx_v_self->numnp)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1711; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1711; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1711; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1711; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->d));
  __pyx_v_self->d = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1712 */
  __pyx_2 = PyInt_FromLong((__pyx_e_9constants_numberDegreesFreedom * __pyx_v_self->numnp)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1712; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1712; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1712; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1712; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->deld));
  __pyx_v_self->deld = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1713 */
  __pyx_2 = PyInt_FromLong((__pyx_e_9constants_numberDegreesFreedom * __pyx_v_self->numnp)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1713; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1713; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1713; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1713; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->dcur));
  __pyx_v_self->dcur = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1716 */
  __pyx_2 = PyInt_FromLong((__pyx_e_9constants_numberDegreesFreedom * __pyx_v_self->numnp)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1716; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1716; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1716; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1716; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->dx));
  __pyx_v_self->dx = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1717 */
  __pyx_2 = PyInt_FromLong((__pyx_e_9constants_numberDegreesFreedom * __pyx_v_self->numnp)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1717; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1717; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1717; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1717; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->deldx));
  __pyx_v_self->deldx = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1718 */
  __pyx_2 = PyInt_FromLong((__pyx_e_9constants_numberDegreesFreedom * __pyx_v_self->numnp)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1718; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1718; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1718; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1718; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->dxcur));
  __pyx_v_self->dxcur = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1721 */
  __pyx_2 = PyInt_FromLong((__pyx_e_9constants_numberDegreesFreedom * __pyx_v_self->numfn)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1721; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1721; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1721; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1721; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->dfault));
  __pyx_v_self->dfault = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1722 */
  __pyx_2 = PyInt_FromLong((__pyx_e_9constants_numberDegreesFreedom * __pyx_v_self->numfn)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1722; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1722; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1722; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1722; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->tfault));
  __pyx_v_self->tfault = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1725 */
  __pyx_2 = PyInt_FromLong((__pyx_v_self->maxElementEquations * __pyx_v_self->maxElementEquations)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1725; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1725; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1725; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1725; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->s));
  __pyx_v_self->s = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1726 */
  __pyx_2 = PyInt_FromLong((__pyx_v_self->maxElementEquations * __pyx_v_self->maxElementEquations)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1726; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1726; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1726; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1726; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->stemp));
  __pyx_v_self->stemp = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1729 */
  __pyx_2 = PyInt_FromLong(__pyx_v_self->nstatesz); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1729; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1729; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1729; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1729; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->state));
  __pyx_v_self->state = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1730 */
  __pyx_2 = PyInt_FromLong(__pyx_v_self->nstatesz); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1730; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1730; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1730; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1730; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->dstate));
  __pyx_v_self->dstate = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1731 */
  __pyx_2 = PyInt_FromLong(((__pyx_e_9constants_materialMatrixDimension * __pyx_v_self->ngauss) * __pyx_v_self->numelv)); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1732; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1731; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1731; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1731; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->dmat));
  __pyx_v_self->dmat = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1736 */
  __pyx_2 = PyInt_FromLong(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1737; goto __pyx_L1;}
  __pyx_3 = PyInt_FromLong(2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1737; goto __pyx_L1;}
  __pyx_1 = PyInt_FromLong(4); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1737; goto __pyx_L1;}
  __pyx_7 = PyInt_FromLong(7); if (!__pyx_7) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1737; goto __pyx_L1;}
  __pyx_8 = PyInt_FromLong(11); if (!__pyx_8) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1737; goto __pyx_L1;}
  __pyx_9 = PyInt_FromLong(16); if (!__pyx_9) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1737; goto __pyx_L1;}
  __pyx_10 = PyInt_FromLong(2); if (!__pyx_10) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1738; goto __pyx_L1;}
  __pyx_11 = PyInt_FromLong(3); if (!__pyx_11) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1738; goto __pyx_L1;}
  __pyx_12 = PyInt_FromLong(5); if (!__pyx_12) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1738; goto __pyx_L1;}
  __pyx_13 = PyInt_FromLong(8); if (!__pyx_13) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1738; goto __pyx_L1;}
  __pyx_14 = PyInt_FromLong(12); if (!__pyx_14) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1738; goto __pyx_L1;}
  __pyx_15 = PyInt_FromLong(17); if (!__pyx_15) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1738; goto __pyx_L1;}
  __pyx_16 = PyInt_FromLong(4); if (!__pyx_16) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1739; goto __pyx_L1;}
  __pyx_17 = PyInt_FromLong(5); if (!__pyx_17) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1739; goto __pyx_L1;}
  __pyx_18 = PyInt_FromLong(6); if (!__pyx_18) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1739; goto __pyx_L1;}
  __pyx_19 = PyInt_FromLong(9); if (!__pyx_19) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1739; goto __pyx_L1;}
  __pyx_20 = PyInt_FromLong(13); if (!__pyx_20) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1739; goto __pyx_L1;}
  __pyx_21 = PyInt_FromLong(18); if (!__pyx_21) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1739; goto __pyx_L1;}
  __pyx_22 = PyInt_FromLong(7); if (!__pyx_22) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1740; goto __pyx_L1;}
  __pyx_23 = PyInt_FromLong(8); if (!__pyx_23) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1740; goto __pyx_L1;}
  __pyx_24 = PyInt_FromLong(9); if (!__pyx_24) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1740; goto __pyx_L1;}
  __pyx_25 = PyInt_FromLong(10); if (!__pyx_25) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1740; goto __pyx_L1;}
  __pyx_26 = PyInt_FromLong(14); if (!__pyx_26) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1740; goto __pyx_L1;}
  __pyx_27 = PyInt_FromLong(19); if (!__pyx_27) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1740; goto __pyx_L1;}
  __pyx_28 = PyInt_FromLong(11); if (!__pyx_28) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1741; goto __pyx_L1;}
  __pyx_29 = PyInt_FromLong(12); if (!__pyx_29) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1741; goto __pyx_L1;}
  __pyx_30 = PyInt_FromLong(13); if (!__pyx_30) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1741; goto __pyx_L1;}
  __pyx_31 = PyInt_FromLong(14); if (!__pyx_31) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1741; goto __pyx_L1;}
  __pyx_32 = PyInt_FromLong(15); if (!__pyx_32) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1741; goto __pyx_L1;}
  __pyx_33 = PyInt_FromLong(20); if (!__pyx_33) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1741; goto __pyx_L1;}
  __pyx_34 = PyInt_FromLong(16); if (!__pyx_34) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1742; goto __pyx_L1;}
  __pyx_35 = PyInt_FromLong(17); if (!__pyx_35) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1742; goto __pyx_L1;}
  __pyx_36 = PyInt_FromLong(18); if (!__pyx_36) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1742; goto __pyx_L1;}
  __pyx_37 = PyInt_FromLong(19); if (!__pyx_37) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1742; goto __pyx_L1;}
  __pyx_38 = PyInt_FromLong(20); if (!__pyx_38) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1742; goto __pyx_L1;}
  __pyx_39 = PyInt_FromLong(21); if (!__pyx_39) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1742; goto __pyx_L1;}
  __pyx_40 = PyList_New(36); if (!__pyx_40) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1736; goto __pyx_L1;}
  PyList_SET_ITEM(__pyx_40, 0, __pyx_2);
  PyList_SET_ITEM(__pyx_40, 1, __pyx_3);
  PyList_SET_ITEM(__pyx_40, 2, __pyx_1);
  PyList_SET_ITEM(__pyx_40, 3, __pyx_7);
  PyList_SET_ITEM(__pyx_40, 4, __pyx_8);
  PyList_SET_ITEM(__pyx_40, 5, __pyx_9);
  PyList_SET_ITEM(__pyx_40, 6, __pyx_10);
  PyList_SET_ITEM(__pyx_40, 7, __pyx_11);
  PyList_SET_ITEM(__pyx_40, 8, __pyx_12);
  PyList_SET_ITEM(__pyx_40, 9, __pyx_13);
  PyList_SET_ITEM(__pyx_40, 10, __pyx_14);
  PyList_SET_ITEM(__pyx_40, 11, __pyx_15);
  PyList_SET_ITEM(__pyx_40, 12, __pyx_16);
  PyList_SET_ITEM(__pyx_40, 13, __pyx_17);
  PyList_SET_ITEM(__pyx_40, 14, __pyx_18);
  PyList_SET_ITEM(__pyx_40, 15, __pyx_19);
  PyList_SET_ITEM(__pyx_40, 16, __pyx_20);
  PyList_SET_ITEM(__pyx_40, 17, __pyx_21);
  PyList_SET_ITEM(__pyx_40, 18, __pyx_22);
  PyList_SET_ITEM(__pyx_40, 19, __pyx_23);
  PyList_SET_ITEM(__pyx_40, 20, __pyx_24);
  PyList_SET_ITEM(__pyx_40, 21, __pyx_25);
  PyList_SET_ITEM(__pyx_40, 22, __pyx_26);
  PyList_SET_ITEM(__pyx_40, 23, __pyx_27);
  PyList_SET_ITEM(__pyx_40, 24, __pyx_28);
  PyList_SET_ITEM(__pyx_40, 25, __pyx_29);
  PyList_SET_ITEM(__pyx_40, 26, __pyx_30);
  PyList_SET_ITEM(__pyx_40, 27, __pyx_31);
  PyList_SET_ITEM(__pyx_40, 28, __pyx_32);
  PyList_SET_ITEM(__pyx_40, 29, __pyx_33);
  PyList_SET_ITEM(__pyx_40, 30, __pyx_34);
  PyList_SET_ITEM(__pyx_40, 31, __pyx_35);
  PyList_SET_ITEM(__pyx_40, 32, __pyx_36);
  PyList_SET_ITEM(__pyx_40, 33, __pyx_37);
  PyList_SET_ITEM(__pyx_40, 34, __pyx_38);
  PyList_SET_ITEM(__pyx_40, 35, __pyx_39);
  __pyx_2 = 0;
  __pyx_3 = 0;
  __pyx_1 = 0;
  __pyx_7 = 0;
  __pyx_8 = 0;
  __pyx_9 = 0;
  __pyx_10 = 0;
  __pyx_11 = 0;
  __pyx_12 = 0;
  __pyx_13 = 0;
  __pyx_14 = 0;
  __pyx_15 = 0;
  __pyx_16 = 0;
  __pyx_17 = 0;
  __pyx_18 = 0;
  __pyx_19 = 0;
  __pyx_20 = 0;
  __pyx_21 = 0;
  __pyx_22 = 0;
  __pyx_23 = 0;
  __pyx_24 = 0;
  __pyx_25 = 0;
  __pyx_26 = 0;
  __pyx_27 = 0;
  __pyx_28 = 0;
  __pyx_29 = 0;
  __pyx_30 = 0;
  __pyx_31 = 0;
  __pyx_32 = 0;
  __pyx_33 = 0;
  __pyx_34 = 0;
  __pyx_35 = 0;
  __pyx_36 = 0;
  __pyx_37 = 0;
  __pyx_38 = 0;
  __pyx_39 = 0;
  Py_DECREF(__pyx_v_listIddmat);
  __pyx_v_listIddmat = __pyx_40;
  __pyx_40 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1744 */
  __pyx_v_dim = ((sizeof(__pyx_v_self->iddmat)) / (sizeof((__pyx_v_self->iddmat[0]))));

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1745 */
  __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1745; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1745; goto __pyx_L1;}
  Py_INCREF(__pyx_v_listIddmat);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_listIddmat);
  __pyx_1 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1745; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_7 = PyInt_FromLong(__pyx_v_dim); if (!__pyx_7) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1745; goto __pyx_L1;}
  if (PyObject_Cmp(__pyx_1, __pyx_7, &__pyx_4) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1745; goto __pyx_L1;}
  __pyx_4 = __pyx_4 == 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_7); __pyx_7 = 0;
  if (!__pyx_4) {
    PyErr_SetNone(PyExc_AssertionError);
    {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1745; goto __pyx_L1;}
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1746 */
  for (__pyx_5 = 0; __pyx_5 < __pyx_v_dim; ++__pyx_5) {
    __pyx_8 = PyInt_FromLong(__pyx_5); if (!__pyx_8) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1746; goto __pyx_L1;}
    Py_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_8;
    __pyx_8 = 0;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1747 */
    __pyx_9 = PyObject_GetItem(__pyx_v_listIddmat, __pyx_v_i); if (!__pyx_9) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1747; goto __pyx_L1;}
    __pyx_6 = PyInt_AsLong(__pyx_9); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1747; goto __pyx_L1;}
    Py_DECREF(__pyx_9); __pyx_9 = 0;
    __pyx_4 = PyInt_AsLong(__pyx_v_i); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1747; goto __pyx_L1;}
    (__pyx_v_self->iddmat[__pyx_4]) = __pyx_6;
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1749 */
  __pyx_10 = PyInt_FromLong(__pyx_v_self->nstatesz0); if (!__pyx_10) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1749; goto __pyx_L1;}
  __pyx_11 = PyTuple_New(1); if (!__pyx_11) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1749; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_11, 0, __pyx_10);
  __pyx_10 = 0;
  __pyx_12 = PyObject_CallObject(((PyObject*)__pyx_ptype_9PyLithLib_DoubleArray), __pyx_11); if (!__pyx_12) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1749; goto __pyx_L1;}
  Py_DECREF(__pyx_11); __pyx_11 = 0;
  if (!__Pyx_TypeTest(__pyx_12, __pyx_ptype_9PyLithLib_DoubleArray)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1749; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_self->state0));
  __pyx_v_self->state0 = ((struct __pyx_obj_9PyLithLib_DoubleArray *)__pyx_12);
  __pyx_12 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1755 */
  __pyx_v_nforce = ((&(__pyx_v_self->nforce[0])) - 1);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1756 */
  (__pyx_v_nforce[1]) = __pyx_v_nextflag;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1757 */
  (__pyx_v_nforce[2]) = __pyx_v_ntractflag;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1758 */
  (__pyx_v_nforce[3]) = __pyx_v_ngravflag;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1759 */
  (__pyx_v_nforce[4]) = __pyx_v_nconcflag;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1760 */
  (__pyx_v_nforce[5]) = __pyx_v_self->nprestrflag;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1761 */
  (__pyx_v_nforce[6]) = __pyx_v_nwinkflag;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1762 */
  (__pyx_v_nforce[7]) = __pyx_v_nwinkxflag;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1763 */
  (__pyx_v_nforce[8]) = __pyx_v_self->nprevdflag;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1764 */
  if (!(8 == ((sizeof(__pyx_v_self->nforce)) / (sizeof((__pyx_v_self->nforce[0])))))) {
    PyErr_SetNone(PyExc_AssertionError);
    {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1764; goto __pyx_L1;}
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1768 */
  __pyx_v_ncodat = ((&(__pyx_v_self->ncodat[0])) - 1);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1769 */
  (__pyx_v_ncodat[1]) = __pyx_v_self->icode;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1770 */
  (__pyx_v_ncodat[2]) = __pyx_v_self->idebug;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1771 */
  if (!(2 == ((sizeof(__pyx_v_self->ncodat)) / (sizeof((__pyx_v_self->ncodat[0])))))) {
    PyErr_SetNone(PyExc_AssertionError);
    {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1771; goto __pyx_L1;}
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1775 */
  __pyx_v_npar = ((&(__pyx_v_self->npar[0])) - 1);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1776 */
  (__pyx_v_npar[1]) = __pyx_v_self->numelv;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1777 */
  (__pyx_v_npar[2]) = __pyx_v_self->numat;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1778 */
  (__pyx_v_npar[3]) = __pyx_v_self->numtractions;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1779 */
  (__pyx_v_npar[4]) = __pyx_v_self->numslp;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1780 */
  (__pyx_v_npar[5]) = __pyx_v_self->numfn;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1781 */
  (__pyx_v_npar[6]) = __pyx_v_self->ipstrs;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1782 */
  (__pyx_v_npar[7]) = __pyx_v_self->ipauto;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1783 */
  (__pyx_v_npar[8]) = __pyx_v_self->nstatesz;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1784 */
  (__pyx_v_npar[9]) = __pyx_v_self->nstatesz0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1785 */
  (__pyx_v_npar[10]) = __pyx_v_self->nvfamilies;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1786 */
  (__pyx_v_npar[11]) = __pyx_v_self->numdif;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1787 */
  (__pyx_v_npar[12]) = __pyx_v_self->intord;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1788 */
  if (!(12 == ((sizeof(__pyx_v_self->npar)) / (sizeof((__pyx_v_self->npar[0])))))) {
    PyErr_SetNone(PyExc_AssertionError);
    {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1788; goto __pyx_L1;}
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1792 */
  __pyx_v_nprint = ((&(__pyx_v_self->nprint[0])) - 1);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1793 */
  (__pyx_v_nprint[1]) = __pyx_v_self->icontr;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1794 */
  (__pyx_v_nprint[2]) = __pyx_v_self->idout;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1795 */
  (__pyx_v_nprint[3]) = __pyx_v_self->idsk;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1796 */
  (__pyx_v_nprint[4]) = __pyx_v_self->iucd;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1797 */
  if (!(4 == ((sizeof(__pyx_v_self->nprint)) / (sizeof((__pyx_v_self->nprint[0])))))) {
    PyErr_SetNone(PyExc_AssertionError);
    {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1797; goto __pyx_L1;}
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1801 */
  __pyx_v_nsysdat = ((&(__pyx_v_self->nsysdat[0])) - 1);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1802 */
  (__pyx_v_nsysdat[1]) = __pyx_v_self->numnp;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1803 */
  (__pyx_v_nsysdat[2]) = __pyx_v_self->neq;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1804 */
  (__pyx_v_nsysdat[3]) = __pyx_v_self->nnz;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1805 */
  (__pyx_v_nsysdat[4]) = __pyx_v_self->numrot;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1806 */
  (__pyx_v_nsysdat[5]) = __pyx_v_self->nprestr;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1807 */
  (__pyx_v_nsysdat[6]) = __pyx_v_self->numsn;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1808 */
  (__pyx_v_nsysdat[7]) = __pyx_v_self->numflt;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1809 */
  (__pyx_v_nsysdat[8]) = __pyx_v_self->npropsz;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1810 */
  (__pyx_v_nsysdat[9]) = __pyx_v_self->nwink;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1811 */
  (__pyx_v_nsysdat[10]) = __pyx_v_self->nwinkx;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1812 */
  (__pyx_v_nsysdat[11]) = __pyx_v_self->iskopt;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1813 */
  if (!(11 == ((sizeof(__pyx_v_self->nsysdat)) / (sizeof((__pyx_v_self->nsysdat[0])))))) {
    PyErr_SetNone(PyExc_AssertionError);
    {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1813; goto __pyx_L1;}
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1817 */
  __pyx_v_nunits = ((&(__pyx_v_self->nunits[0])) - 1);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1818 */
  (__pyx_v_nunits[1]) = __pyx_v_self->kti;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1819 */
  (__pyx_v_nunits[2]) = __pyx_v_self->kto;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1820 */
  (__pyx_v_nunits[3]) = __pyx_v_self->kr;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1821 */
  (__pyx_v_nunits[4]) = __pyx_v_self->kw;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1822 */
  (__pyx_v_nunits[5]) = __pyx_v_self->kp;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1823 */
  (__pyx_v_nunits[6]) = __pyx_v_self->kucd;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1824 */
  if (!(6 == ((sizeof(__pyx_v_self->nunits)) / (sizeof((__pyx_v_self->nunits[0])))))) {
    PyErr_SetNone(PyExc_AssertionError);
    {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1824; goto __pyx_L1;}
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1828 */
  __pyx_v_nvisdat = ((&(__pyx_v_self->nvisdat[0])) - 1);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1829 */
  (__pyx_v_nvisdat[1]) = __pyx_v_self->ncycle;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1830 */
  (__pyx_v_nvisdat[2]) = __pyx_v_self->nintg;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1831 */
  (__pyx_v_nvisdat[3]) = __pyx_v_self->lastep;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1832 */
  (__pyx_v_nvisdat[4]) = __pyx_v_self->nhist;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1833 */
  if (!(4 == ((sizeof(__pyx_v_self->nvisdat)) / (sizeof((__pyx_v_self->nvisdat[0])))))) {
    PyErr_SetNone(PyExc_AssertionError);
    {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1833; goto __pyx_L1;}
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1837 */
  __pyx_v_rgiter = ((&(__pyx_v_self->rgiter[0])) - 1);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1838 */
  (__pyx_v_rgiter[1]) = __pyx_v_self->stol;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1839 */
  (__pyx_v_rgiter[2]) = __pyx_v_self->dtol;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1840 */
  (__pyx_v_rgiter[3]) = __pyx_v_self->epert;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1841 */
  if (!(3 == ((sizeof(__pyx_v_self->rgiter)) / (sizeof((__pyx_v_self->rgiter[0])))))) {
    PyErr_SetNone(PyExc_AssertionError);
    {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1841; goto __pyx_L1;}
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1845 */
  __pyx_v_rtimdat = ((&(__pyx_v_self->rtimdat[0])) - 1);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1847 */
  __pyx_v_deltp = 0.0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1847 */
  __pyx_v_alfap = 0.0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1848 */
  (__pyx_v_rtimdat[1]) = __pyx_v_deltp;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1849 */
  (__pyx_v_rtimdat[2]) = __pyx_v_alfap;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1850 */
  (__pyx_v_rtimdat[3]) = __pyx_v_self->tpois;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1851 */
  (__pyx_v_rtimdat[4]) = __pyx_v_self->tyoungs;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1852 */
  if (!(4 == ((sizeof(__pyx_v_self->rtimdat)) / (sizeof((__pyx_v_self->rtimdat[0])))))) {
    PyErr_SetNone(PyExc_AssertionError);
    {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1852; goto __pyx_L1;}
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1859 */
  __pyx_v_ntimdat = ((&(__pyx_v_self->ntimdat[0])) - 1);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1860 */
  __pyx_v_nstep = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1860 */
  __pyx_v_maxitp = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1860 */
  __pyx_v_ntdinitp = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1861 */
  __pyx_v_lgdefp = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1861 */
  __pyx_v_itmaxp = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1861 */
  __pyx_v_nittot = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1862 */
  __pyx_v_nrftot = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1862 */
  __pyx_v_ireform = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1863 */
  (__pyx_v_ntimdat[1]) = __pyx_v_nstep;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1864 */
  (__pyx_v_ntimdat[2]) = __pyx_v_maxitp;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1865 */
  (__pyx_v_ntimdat[3]) = __pyx_v_ntdinitp;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1866 */
  (__pyx_v_ntimdat[4]) = __pyx_v_lgdefp;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1867 */
  (__pyx_v_ntimdat[5]) = __pyx_v_itmaxp;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1868 */
  (__pyx_v_ntimdat[6]) = __pyx_v_nittot;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1869 */
  (__pyx_v_ntimdat[7]) = __pyx_v_nrftot;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1870 */
  (__pyx_v_ntimdat[8]) = __pyx_v_ireform;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1871 */
  if (!(8 == ((sizeof(__pyx_v_self->ntimdat)) / (sizeof((__pyx_v_self->ntimdat[0])))))) {
    PyErr_SetNone(PyExc_AssertionError);
    {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1871; goto __pyx_L1;}
  }

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1873 */
  __pyx_13 = PyObject_GetAttr(__pyx_v_self->trace, __pyx_n_log); if (!__pyx_13) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1873; goto __pyx_L1;}
  __pyx_14 = PyTuple_New(1); if (!__pyx_14) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1873; goto __pyx_L1;}
  Py_INCREF(__pyx_k79p);
  PyTuple_SET_ITEM(__pyx_14, 0, __pyx_k79p);
  __pyx_15 = PyObject_CallObject(__pyx_13, __pyx_14); if (!__pyx_15) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1873; goto __pyx_L1;}
  Py_DECREF(__pyx_13); __pyx_13 = 0;
  Py_DECREF(__pyx_14); __pyx_14 = 0;
  Py_DECREF(__pyx_15); __pyx_15 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1875 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_7);
  Py_XDECREF(__pyx_8);
  Py_XDECREF(__pyx_9);
  Py_XDECREF(__pyx_10);
  Py_XDECREF(__pyx_11);
  Py_XDECREF(__pyx_12);
  Py_XDECREF(__pyx_13);
  Py_XDECREF(__pyx_14);
  Py_XDECREF(__pyx_15);
  Py_XDECREF(__pyx_16);
  Py_XDECREF(__pyx_17);
  Py_XDECREF(__pyx_18);
  Py_XDECREF(__pyx_19);
  Py_XDECREF(__pyx_20);
  Py_XDECREF(__pyx_21);
  Py_XDECREF(__pyx_22);
  Py_XDECREF(__pyx_23);
  Py_XDECREF(__pyx_24);
  Py_XDECREF(__pyx_25);
  Py_XDECREF(__pyx_26);
  Py_XDECREF(__pyx_27);
  Py_XDECREF(__pyx_28);
  Py_XDECREF(__pyx_29);
  Py_XDECREF(__pyx_30);
  Py_XDECREF(__pyx_31);
  Py_XDECREF(__pyx_32);
  Py_XDECREF(__pyx_33);
  Py_XDECREF(__pyx_34);
  Py_XDECREF(__pyx_35);
  Py_XDECREF(__pyx_36);
  Py_XDECREF(__pyx_37);
  Py_XDECREF(__pyx_38);
  Py_XDECREF(__pyx_39);
  Py_XDECREF(__pyx_40);
  __Pyx_AddTraceback("PyLithLib.PyLith.allocateremaining");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_i);
  Py_DECREF(__pyx_v_listIddmat);
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_k80p;
static PyObject *__pyx_k81p;
static PyObject *__pyx_k82p;

static char (__pyx_k80[]) = "Hello from pl3dsetup.meshwriteascii (begin)!";
static char (__pyx_k81[]) = "Outputting Ascii mesh information.";
static char (__pyx_k82[]) = "Hello from pl3dsetup.meshwrite (end)!";

static PyObject *__pyx_f_9PyLithLib_6PyLith_meshwrite(struct __pyx_obj_9PyLithLib_PyLith *__pyx_v_self) {
  int __pyx_v_errorcode;
  char (__pyx_v_errorstring[__pyx_e_9PyLithLib_errorstring_size]);
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  char (*__pyx_4);
  size_t __pyx_5;
  int __pyx_6;
  Py_INCREF(__pyx_v_self);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1886 */
  __pyx_v_errorcode = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1888 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self->trace, __pyx_n_log); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1888; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1888; goto __pyx_L1;}
  Py_INCREF(__pyx_k80p);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k80p);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1888; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1890 */
  if (__Pyx_PrintItem(__pyx_k81p) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1890; goto __pyx_L1;}
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1890; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1893 */
  __pyx_4 = PyString_AsString(__pyx_v_self->title); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1894; goto __pyx_L1;}
  __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1902; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1902; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->title);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_self->title);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1902; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_5 = PyInt_AsUnsignedLongMask(__pyx_3); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1902; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  FC_FUNC_(write_global_info, WRITE_GLOBAL_INFO)(__pyx_4,(&__pyx_v_self->idout),(&__pyx_v_self->idsk),(&__pyx_v_self->numnp),(&__pyx_v_self->icode),(&__pyx_v_self->idebug),(&__pyx_v_self->kw),(&__pyx_v_self->kp),__pyx_5); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1893; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1905 */
  FC_FUNC_(write_coords, WRITE_COORDS)(__pyx_v_self->x->ptr,(&__pyx_v_self->numnp),(&__pyx_v_self->kw),(&__pyx_v_self->kp),(&__pyx_v_self->idout),(&__pyx_v_self->idsk),(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1905; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1915 */
  __pyx_1 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1915; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1918 */
  FC_FUNC_(write_bc, WRITE_BC)(__pyx_v_self->bond->ptr,__pyx_v_self->ibond->ptr,(&__pyx_v_self->numnp),(&__pyx_v_self->kw),(&__pyx_v_self->idout),(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1918; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1927 */
  __pyx_2 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1927; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1930 */
  FC_FUNC_(write_skew, WRITE_SKEW)(__pyx_v_self->skew->ptr,(&__pyx_v_self->numrot),(&__pyx_v_self->iskopt),(&__pyx_v_self->numnp),(&__pyx_v_self->kw),(&__pyx_v_self->idout),(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1930; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1940 */
  __pyx_3 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1940; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1943 */
  FC_FUNC_(write_strscomp, WRITE_STRSCOMP)((&__pyx_v_self->stol),(&__pyx_v_self->dtol),(&__pyx_v_self->epert),(&__pyx_v_self->kw),(&__pyx_v_self->idout)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1943; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1950 */
  FC_FUNC_(write_subiter, WRITE_SUBITER)((&__pyx_v_self->nprevdflag),(&__pyx_v_self->kw),(&__pyx_v_self->idout)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1950; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1956 */
  FC_FUNC_(write_timdat, WRITE_TIMDAT)(__pyx_v_self->delt->ptr,__pyx_v_self->alfa->ptr,__pyx_v_self->utol->ptr,__pyx_v_self->ftol->ptr,__pyx_v_self->etol->ptr,__pyx_v_self->times->ptr,__pyx_v_self->maxstp->ptr,__pyx_v_self->maxit->ptr,__pyx_v_self->ntdinit->ptr,__pyx_v_self->lgdef->ptr,__pyx_v_self->itmax->ptr,(&__pyx_v_self->nintg),(&__pyx_v_self->lastep),(&__pyx_v_self->kw),(&__pyx_v_self->idout),(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1956; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1975 */
  __pyx_1 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1975; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1978 */
  FC_FUNC_(write_fuldat, WRITE_FULDAT)(__pyx_v_self->iprint->ptr,(&__pyx_v_self->icontr),(&__pyx_v_self->icode),(&__pyx_v_self->ncycle),(&__pyx_v_self->lastep),(&__pyx_v_self->kw),(&__pyx_v_self->kp),(&__pyx_v_self->idout),(&__pyx_v_self->idsk),(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1978; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1991 */
  __pyx_2 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1991; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":1994 */
  FC_FUNC_(write_stateout, WRITE_STATEOUT)(__pyx_v_self->istatout,__pyx_v_self->nstatout,(&__pyx_v_self->kw),(&__pyx_v_self->kp),(&__pyx_v_self->idout),(&__pyx_v_self->idsk),(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 1994; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2004 */
  __pyx_3 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2004; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2007 */
  FC_FUNC_(write_hist, WRITE_HIST)(__pyx_v_self->histry->ptr,__pyx_v_self->times->ptr,(&__pyx_v_self->nhist),(&__pyx_v_self->lastep),(&__pyx_v_self->kw),(&__pyx_v_self->idout),(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2007; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2017 */
  __pyx_1 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2017; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2019 */
  Py_INCREF(Py_None);
  Py_DECREF(((PyObject *)__pyx_v_self->times));
  __pyx_v_self->times = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2022 */
  FC_FUNC_(write_element_info, WRITE_ELEMENT_INFO)((&__pyx_v_self->numelv),(&__pyx_v_self->nen),(&__pyx_v_self->ngauss),(&__pyx_v_self->ietypev),(&__pyx_v_self->intord),(&__pyx_v_self->ipstrs),(&__pyx_v_self->ipauto),(&__pyx_v_self->tpois),(&__pyx_v_self->tyoungs),(&__pyx_v_self->kw),(&__pyx_v_self->idout)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2022; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2036 */
  FC_FUNC_(write_connect, WRITE_CONNECT)(__pyx_v_self->iens->ptr,__pyx_v_self->ivfamily->ptr,__pyx_v_self->indxiel->ptr,(&__pyx_v_self->nen),(&__pyx_v_self->ngauss),(&__pyx_v_self->numelv),(&__pyx_v_self->ietypev),(&__pyx_v_self->nvfamilies),(&__pyx_v_self->kw),(&__pyx_v_self->kp),(&__pyx_v_self->idout),(&__pyx_v_self->idsk),(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2036; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2052 */
  __pyx_2 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2052; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2054 */
  Py_INCREF(Py_None);
  Py_DECREF(((PyObject *)__pyx_v_self->indxiel));
  __pyx_v_self->indxiel = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2057 */
  FC_FUNC_(write_props, WRITE_PROPS)(__pyx_v_self->_prop->ptr,__pyx_v_self->_grav,__pyx_v_self->ivfamily->ptr,__pyx_v_self->infmatmod,(&__pyx_v_self->nvfamilies),(&__pyx_v_self->npropsz),(&__pyx_v_self->idout),(&__pyx_v_self->idsk),(&__pyx_v_self->kw),(&__pyx_v_self->kp),(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2057; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2071 */
  __pyx_3 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2071; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2074 */
  __pyx_6 = (__pyx_v_self->iucd >= 0);
  if (__pyx_6) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2075 */
    __pyx_4 = PyString_AsString(__pyx_v_self->ucdroot); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2090; goto __pyx_L1;}
    __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2091; goto __pyx_L1;}
    __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2091; goto __pyx_L1;}
    Py_INCREF(__pyx_v_self->ucdroot);
    PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_self->ucdroot);
    __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2091; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_5 = PyInt_AsUnsignedLongMask(__pyx_3); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2091; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    FC_FUNC_(write_ucd_mesh, WRITE_UCD_MESH)(__pyx_v_self->x->ptr,(&__pyx_v_self->numnp),__pyx_v_self->iens->ptr,__pyx_v_self->ivfamily->ptr,(&__pyx_v_self->numelv),(&__pyx_v_self->nvfamilies),__pyx_v_self->sh->ptr,(&__pyx_v_self->nen),(&__pyx_v_self->ngauss),(&__pyx_v_self->ietypev),__pyx_v_self->istatout,__pyx_v_self->nstatout,(&__pyx_v_self->kucd),(&__pyx_v_self->iucd),__pyx_4,__pyx_5); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2075; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2094 */
  FC_FUNC_(write_tractions, WRITE_TRACTIONS)(__pyx_v_self->tractionverts->ptr,__pyx_v_self->tractionvals->ptr,(&__pyx_v_self->numtractions),(&__pyx_v_self->nsnodes),(&__pyx_v_self->kw),(&__pyx_v_self->idout),(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2094; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2104 */
  __pyx_1 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2104; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2107 */
  FC_FUNC_(write_split, WRITE_SPLIT)(__pyx_v_self->fault->ptr,__pyx_v_self->nfault->ptr,(&__pyx_v_self->numfn),(&__pyx_v_self->kw),(&__pyx_v_self->kp),(&__pyx_v_self->idout),(&__pyx_v_self->idsk),(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2107; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2118 */
  __pyx_2 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2118; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2121 */
  FC_FUNC_(write_slip, WRITE_SLIP)(__pyx_v_self->nslip->ptr,(&__pyx_v_self->numslp),(&__pyx_v_self->numsn),(&__pyx_v_self->kw),(&__pyx_v_self->kp),(&__pyx_v_self->idout),(&__pyx_v_self->idsk),(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2121; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2132 */
  __pyx_3 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2132; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2135 */
  FC_FUNC_(write_diff, WRITE_DIFF)(__pyx_v_self->diforc->ptr,__pyx_v_self->nslip->ptr,__pyx_v_self->idhist->ptr,(&__pyx_v_self->numslp),(&__pyx_v_self->numdif),(&__pyx_v_self->numnp),(&__pyx_v_self->kw),(&__pyx_v_self->idout),(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2135; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2147 */
  __pyx_1 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2147; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2149 */
  Py_INCREF(Py_None);
  Py_DECREF(((PyObject *)__pyx_v_self->nslip));
  __pyx_v_self->nslip = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2152 */
  FC_FUNC_(write_split_plot, WRITE_SPLIT_PLOT)(__pyx_v_self->idftn->ptr,(&__pyx_v_self->numflt),(&__pyx_v_self->kp),(&__pyx_v_self->idsk)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2152; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2158 */
  Py_INCREF(Py_None);
  Py_DECREF(((PyObject *)__pyx_v_self->idftn));
  __pyx_v_self->idftn = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2161 */
  FC_FUNC_(write_wink, WRITE_WINK)(__pyx_v_self->winkdef->ptr,__pyx_v_self->iwinkdef->ptr,__pyx_v_self->iwinkid->ptr,(&__pyx_v_self->nwinke),(&__pyx_v_self->kw),(&__pyx_v_self->idout),(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2161; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2171 */
  __pyx_2 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2171; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2173 */
  Py_INCREF(Py_None);
  Py_DECREF(((PyObject *)__pyx_v_self->winkdef));
  __pyx_v_self->winkdef = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2174 */
  Py_INCREF(Py_None);
  Py_DECREF(((PyObject *)__pyx_v_self->iwinkdef));
  __pyx_v_self->iwinkdef = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2177 */
  FC_FUNC_(write_winkx, WRITE_WINKX)(__pyx_v_self->winkxdef->ptr,__pyx_v_self->iwinkxdef->ptr,__pyx_v_self->iwinkxid->ptr,(&__pyx_v_self->nwinkxe),(&__pyx_v_self->kw),(&__pyx_v_self->idout),(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2177; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2187 */
  __pyx_3 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2187; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2189 */
  Py_INCREF(Py_None);
  Py_DECREF(((PyObject *)__pyx_v_self->winkxdef));
  __pyx_v_self->winkxdef = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2190 */
  Py_INCREF(Py_None);
  Py_DECREF(((PyObject *)__pyx_v_self->iwinkxdef));
  __pyx_v_self->iwinkxdef = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2193 */
  FC_FUNC_(write_sparse_info, WRITE_SPARSE_INFO)((&__pyx_v_self->neq),(&__pyx_v_self->nnz),(&__pyx_v_self->nmin),(&__pyx_v_self->nmax),(&__pyx_v_self->wavg),(&__pyx_v_self->idout),(&__pyx_v_self->kw)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2193; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2202 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self->trace, __pyx_n_log); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2202; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2202; goto __pyx_L1;}
  Py_INCREF(__pyx_k82p);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k82p);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2202; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2204 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("PyLithLib.PyLith.meshwrite");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_9PyLithLib_6PyLith_solveElastic(struct __pyx_obj_9PyLithLib_PyLith *__pyx_v_self) {
  int __pyx_v_errorcode;
  char (__pyx_v_errorstring[__pyx_e_9PyLithLib_errorstring_size]);
  PyObject *__pyx_r;
  char (*__pyx_1);
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  size_t __pyx_5;
  Py_INCREF(__pyx_v_self);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2216 */
  __pyx_v_errorcode = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2218 */
  __pyx_1 = PyString_AsString(__pyx_v_self->ucdroot); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2304; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2309; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2309; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self->ucdroot);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_self->ucdroot);
  __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2309; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_5 = PyInt_AsUnsignedLongMask(__pyx_4); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2309; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  FC_FUNC(elastc, ELASTC)((&__pyx_v_self->_mesh->A),(&__pyx_v_self->_mesh->rhs),(&__pyx_v_self->_mesh->sol),__pyx_v_self->bextern->ptr,__pyx_v_self->btraction->ptr,__pyx_v_self->bgravity->ptr,__pyx_v_self->bconcForce->ptr,__pyx_v_self->bintern->ptr,__pyx_v_self->bresid->ptr,__pyx_v_self->bwink->ptr,__pyx_v_self->bwinkx->ptr,__pyx_v_self->dispVec->ptr,__pyx_v_self->dprev->ptr,__pyx_v_self->nforce,__pyx_v_self->_grav,__pyx_v_self->x->ptr,__pyx_v_self->d->ptr,__pyx_v_self->deld->ptr,__pyx_v_self->dcur->ptr,__pyx_v_self->id->ptr,__pyx_v_self->iwink->ptr,__pyx_v_self->wink->ptr,__pyx_v_self->nsysdat,__pyx_v_self->iddmat,__pyx_v_self->ibond->ptr,__pyx_v_self->bond->ptr,__pyx_v_self->dx->ptr,__pyx_v_self->deldx->ptr,__pyx_v_self->dxcur->ptr,__pyx_v_self->diforc->ptr,__pyx_v_self->idx->ptr,__pyx_v_self->iwinkx->ptr,__pyx_v_self->winkx->ptr,__pyx_v_self->idslp->ptr,__pyx_v_self->ipslp->ptr,__pyx_v_self->idhist->ptr,__pyx_v_self->fault->ptr,__pyx_v_self->nfault->ptr,__pyx_v_self->dfault->ptr,__pyx_v_self->tfault->ptr,__pyx_v_self->s->ptr,__pyx_v_self->stemp->ptr,__pyx_v_self->state->ptr,__pyx_v_self->dstate->ptr,__pyx_v_self->state0->ptr,__pyx_v_self->dmat->ptr,__pyx_v_self->iens->ptr,__pyx_v_self->lm->ptr,__pyx_v_self->lmx->ptr,__pyx_v_self->lmf->ptr,__pyx_v_self->ivfamily->ptr,__pyx_v_self->npar,__pyx_v_self->ielindx->ptr,__pyx_v_self->tractionverts->ptr,__pyx_v_self->tractionvals->ptr,__pyx_v_self->gauss2d->ptr,__pyx_v_self->sh2d->ptr,__pyx_v_self->infetype2d,__pyx_v_self->_prop->ptr,__pyx_v_self->infmatmod,__pyx_v_self->gauss->ptr,__pyx_v_self->sh->ptr,__pyx_v_self->shj->ptr,__pyx_v_self->infetype,__pyx_v_self->histry->ptr,__pyx_v_self->rtimdat,__pyx_v_self->ntimdat,__pyx_v_self->nvisdat,__pyx_v_self->maxstp->ptr,__pyx_v_self->delt->ptr,__pyx_v_self->alfa->ptr,__pyx_v_self->maxit->ptr,__pyx_v_self->ntdinit->ptr,__pyx_v_self->lgdef->ptr,__pyx_v_self->utol->ptr,__pyx_v_self->ftol->ptr,__pyx_v_self->etol->ptr,__pyx_v_self->itmax->ptr,__pyx_v_self->rgiter,__pyx_v_self->skew->ptr,__pyx_v_self->ncodat,__pyx_v_self->nunits,__pyx_v_self->nprint,__pyx_v_self->istatout,__pyx_v_self->nstatout,__pyx_1,(&__pyx_v_self->elasticStage),(&__pyx_v_self->iterateEvent),(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_5,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2218; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2311 */
  __pyx_2 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2311; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2313 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("PyLithLib.PyLith.solveElastic");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_n_interpolatePoints;

static PyObject *__pyx_f_9PyLithLib_6PyLith_interpolatePoints(struct __pyx_obj_9PyLithLib_PyLith *__pyx_v_self,PyObject *__pyx_v_points) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_points);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2317 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_self->_mesh), __pyx_n_interpolatePoints); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2317; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2317; goto __pyx_L1;}
  Py_INCREF(__pyx_v_points);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_points);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2317; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_r = __pyx_3;
  __pyx_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("PyLithLib.PyLith.interpolatePoints");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_points);
  return __pyx_r;
}

static PyObject *__pyx_n_float;
static PyObject *__pyx_n_abs;

static PyObject *__pyx_k83p;
static PyObject *__pyx_k84p;
static PyObject *__pyx_k85p;
static PyObject *__pyx_k86p;
static PyObject *__pyx_k87p;
static PyObject *__pyx_k88p;
static PyObject *__pyx_k89p;
static PyObject *__pyx_k90p;

static char (__pyx_k83[]) = "Hello from pl3drun.run (begin)!";
static char (__pyx_k84[]) = "Beginning problem solution.";
static char (__pyx_k85[]) = "Approximate memory allocation for f77 arrays: %g MB";
static char (__pyx_k86[]) = "     working on cycle %d";
static char (__pyx_k87[]) = ".";
static char (__pyx_k88[]) = " Total number of equilibrium iterations        =";
static char (__pyx_k89[]) = " Total number of stiffness matrix reformations =";
static char (__pyx_k90[]) = "Hello from pl3drun.run (end)!";

static PyObject *__pyx_f_9PyLithLib_6PyLith_runSimulation(struct __pyx_obj_9PyLithLib_PyLith *__pyx_v_self) {
  int __pyx_v_errorcode;
  char (__pyx_v_errorstring[__pyx_e_9PyLithLib_errorstring_size]);
  PyObject *__pyx_v_memoryUsageMB;
  int __pyx_v_numCycles;
  int __pyx_v_numTimeStepGroups;
  int __pyx_v_numslp;
  int __pyx_v_iskopt;
  int __pyx_v_icontr;
  int __pyx_v_indexx;
  int __pyx_v_ntot;
  int __pyx_v_nextStartStep;
  int __pyx_v_timeStep;
  int __pyx_v_startStep;
  double __pyx_v_time;
  int __pyx_v_maxitp;
  int __pyx_v_ntdinitp;
  int __pyx_v_lgdefp;
  int __pyx_v_itmaxp;
  double __pyx_v_dt;
  double __pyx_v_alfap;
  double (__pyx_v_gtol[3]);
  int __pyx_v_ltim;
  int __pyx_v_cycle;
  int __pyx_v_tsGroup;
  int __pyx_v_j;
  int __pyx_v_skc;
  int __pyx_v_fulout;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  char (*__pyx_5);
  size_t __pyx_6;
  long __pyx_7;
  PyObject *__pyx_8 = 0;
  Py_INCREF(__pyx_v_self);
  __pyx_v_memoryUsageMB = Py_None; Py_INCREF(Py_None);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2328 */
  __pyx_v_errorcode = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2330 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self->trace, __pyx_n_log); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2330; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2330; goto __pyx_L1;}
  Py_INCREF(__pyx_k83p);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k83p);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2330; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2332 */
  if (__Pyx_PrintItem(__pyx_k84p) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2332; goto __pyx_L1;}
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2332; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2336 */
  __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_float); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2336; goto __pyx_L1;}
  __pyx_2 = PyInt_FromLong(__pyx_v_9PyLithLib_memoryUsage); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2336; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2336; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2336; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_1 = PyFloat_FromDouble((1024.0 * 1024.0)); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2336; goto __pyx_L1;}
  __pyx_3 = PyNumber_Divide(__pyx_2, __pyx_1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2336; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_v_memoryUsageMB);
  __pyx_v_memoryUsageMB = __pyx_3;
  __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2337 */
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2337; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2338 */
  __pyx_2 = PyNumber_Remainder(__pyx_k85p, __pyx_v_memoryUsageMB); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2338; goto __pyx_L1;}
  if (__Pyx_PrintItem(__pyx_2) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2338; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2338; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2339 */
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2339; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2342 */
  __pyx_4 = (__pyx_v_self->icode == 2);
  if (!__pyx_4) {
    __pyx_4 = (__pyx_v_self->icode == 3);
  }
  if (__pyx_4) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2343 */
    __pyx_4 = (__pyx_v_self->ipstrs == 1);
    if (__pyx_4) {

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2344 */
      __pyx_5 = PyString_AsString(__pyx_v_self->ucdroot); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2430; goto __pyx_L1;}
      __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2435; goto __pyx_L1;}
      __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2435; goto __pyx_L1;}
      Py_INCREF(__pyx_v_self->ucdroot);
      PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_self->ucdroot);
      __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2435; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      __pyx_6 = PyInt_AsUnsignedLongMask(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2435; goto __pyx_L1;}
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      FC_FUNC(autoprestr, AUTOPRESTR)((&__pyx_v_self->_mesh->A),(&__pyx_v_self->_mesh->rhs),(&__pyx_v_self->_mesh->sol),__pyx_v_self->bextern->ptr,__pyx_v_self->btraction->ptr,__pyx_v_self->bgravity->ptr,__pyx_v_self->bconcForce->ptr,__pyx_v_self->bintern->ptr,__pyx_v_self->bresid->ptr,__pyx_v_self->bwink->ptr,__pyx_v_self->bwinkx->ptr,__pyx_v_self->dispVec->ptr,__pyx_v_self->dprev->ptr,__pyx_v_self->nforce,__pyx_v_self->_grav,__pyx_v_self->x->ptr,__pyx_v_self->d->ptr,__pyx_v_self->deld->ptr,__pyx_v_self->dcur->ptr,__pyx_v_self->id->ptr,__pyx_v_self->iwink->ptr,__pyx_v_self->wink->ptr,__pyx_v_self->nsysdat,__pyx_v_self->iddmat,__pyx_v_self->ibond->ptr,__pyx_v_self->bond->ptr,__pyx_v_self->dx->ptr,__pyx_v_self->deldx->ptr,__pyx_v_self->dxcur->ptr,__pyx_v_self->diforc->ptr,__pyx_v_self->idx->ptr,__pyx_v_self->iwinkx->ptr,__pyx_v_self->winkx->ptr,__pyx_v_self->idslp->ptr,__pyx_v_self->ipslp->ptr,__pyx_v_self->idhist->ptr,__pyx_v_self->fault->ptr,__pyx_v_self->nfault->ptr,__pyx_v_self->dfault->ptr,__pyx_v_self->tfault->ptr,__pyx_v_self->s->ptr,__pyx_v_self->stemp->ptr,__pyx_v_self->state->ptr,__pyx_v_self->dstate->ptr,__pyx_v_self->state0->ptr,__pyx_v_self->dmat->ptr,__pyx_v_self->iens->ptr,__pyx_v_self->lm->ptr,__pyx_v_self->lmx->ptr,__pyx_v_self->lmf->ptr,__pyx_v_self->ivfamily->ptr,__pyx_v_self->npar,__pyx_v_self->ielindx->ptr,__pyx_v_self->tractionverts->ptr,__pyx_v_self->tractionvals->ptr,__pyx_v_self->gauss2d->ptr,__pyx_v_self->sh2d->ptr,__pyx_v_self->infetype2d,__pyx_v_self->_prop->ptr,__pyx_v_self->infmatmod,__pyx_v_self->gauss->ptr,__pyx_v_self->sh->ptr,__pyx_v_self->shj->ptr,__pyx_v_self->infetype,__pyx_v_self->histry->ptr,__pyx_v_self->rtimdat,__pyx_v_self->ntimdat,__pyx_v_self->nvisdat,__pyx_v_self->maxstp->ptr,__pyx_v_self->delt->ptr,__pyx_v_self->alfa->ptr,__pyx_v_self->maxit->ptr,__pyx_v_self->ntdinit->ptr,__pyx_v_self->lgdef->ptr,__pyx_v_self->utol->ptr,__pyx_v_self->ftol->ptr,__pyx_v_self->etol->ptr,__pyx_v_self->itmax->ptr,__pyx_v_self->rgiter,__pyx_v_self->skew->ptr,__pyx_v_self->ncodat,__pyx_v_self->nunits,__pyx_v_self->nprint,__pyx_v_self->istatout,__pyx_v_self->nstatout,__pyx_5,(&__pyx_v_self->autoprestrStage),(&__pyx_v_self->iterateEvent),(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_6,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2344; goto __pyx_L1;}

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2437 */
      __pyx_1 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2437; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2440 */
    __pyx_3 = ((struct __pyx_vtabstruct_9PyLithLib_PyLith *)__pyx_v_self->__pyx_vtab)->solveElastic(__pyx_v_self); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2440; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2441 */
    __pyx_2 = ((struct __pyx_vtabstruct_13PyLithMeshLib_Mesh *)__pyx_v_self->_mesh->__pyx_vtab)->outputMesh(__pyx_v_self->_mesh,__pyx_v_self->fileRoot); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2441; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2456 */
  __pyx_4 = (__pyx_v_self->icode == 3);
  if (__pyx_4) {
    __pyx_4 = (__pyx_v_self->nintg > 1);
  }
  if (__pyx_4) {

    /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2457 */
    __pyx_4 = __pyx_v_self->pythonTimestep;
    if (__pyx_4) {

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2458 */
      __pyx_1 = __pyx_f_9PyLithLib_PetscLogStagePush(__pyx_v_self->viscousStage); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2458; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2460 */
      __pyx_v_numCycles = (__pyx_v_self->nvisdat[0]);

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2461 */
      __pyx_v_numTimeStepGroups = (__pyx_v_self->nvisdat[1]);

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2462 */
      __pyx_v_numslp = (__pyx_v_self->npar[3]);

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2463 */
      __pyx_v_iskopt = (__pyx_v_self->nsysdat[10]);

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2464 */
      __pyx_v_icontr = (__pyx_v_self->nprint[0]);

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2465 */
      __pyx_v_indexx = 1;

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2466 */
      __pyx_v_ntot = 0;

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2468 */
      for (__pyx_v_cycle = 0; __pyx_v_cycle < __pyx_v_numCycles; ++__pyx_v_cycle) {

        /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2470 */
        __pyx_4 = (__pyx_v_numCycles > 1);
        if (__pyx_4) {
          __pyx_3 = PyInt_FromLong(__pyx_v_cycle); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2470; goto __pyx_L1;}
          __pyx_2 = PyNumber_Remainder(__pyx_k86p, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2470; goto __pyx_L1;}
          Py_DECREF(__pyx_3); __pyx_3 = 0;
          if (__Pyx_PrintItem(__pyx_2) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2470; goto __pyx_L1;}
          Py_DECREF(__pyx_2); __pyx_2 = 0;
          if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2470; goto __pyx_L1;}
          goto __pyx_L8;
        }
        __pyx_L8:;

        /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2471 */
        __pyx_v_nextStartStep = 0;

        /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2472 */
        __pyx_v_timeStep = 0;

        /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2473 */
        __pyx_v_startStep = 0;

        /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2474 */
        __pyx_v_time = 0.0;

        /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2476 */
        for (__pyx_v_tsGroup = 1; __pyx_v_tsGroup < __pyx_v_numTimeStepGroups; ++__pyx_v_tsGroup) {

          /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2478 */
          __pyx_v_dt = (__pyx_v_self->delt->ptr[__pyx_v_tsGroup]);

          /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2479 */
          (__pyx_v_self->rtimdat[0]) = __pyx_v_dt;

          /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2480 */
          __pyx_v_alfap = (__pyx_v_self->alfa->ptr[__pyx_v_tsGroup]);

          /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2481 */
          (__pyx_v_self->rtimdat[1]) = __pyx_v_alfap;

          /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2482 */
          (__pyx_v_self->ntimdat[0]) = __pyx_v_timeStep;

          /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2483 */
          __pyx_v_maxitp = (__pyx_v_self->maxit->ptr[__pyx_v_tsGroup]);

          /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2484 */
          (__pyx_v_self->ntimdat[1]) = __pyx_v_maxitp;

          /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2485 */
          __pyx_v_ntdinitp = (__pyx_v_self->ntdinit->ptr[__pyx_v_tsGroup]);

          /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2486 */
          (__pyx_v_self->ntimdat[2]) = __pyx_v_ntdinitp;

          /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2487 */
          __pyx_v_lgdefp = (__pyx_v_self->lgdef->ptr[__pyx_v_tsGroup]);

          /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2488 */
          (__pyx_v_self->ntimdat[3]) = __pyx_v_lgdefp;

          /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2489 */
          __pyx_v_itmaxp = (__pyx_v_self->itmax->ptr[__pyx_v_tsGroup]);

          /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2490 */
          (__pyx_v_self->ntimdat[4]) = __pyx_v_itmaxp;

          /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2491 */
          (__pyx_v_gtol[0]) = (__pyx_v_self->utol->ptr[__pyx_v_tsGroup]);

          /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2492 */
          (__pyx_v_gtol[1]) = (__pyx_v_self->ftol->ptr[__pyx_v_tsGroup]);

          /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2493 */
          (__pyx_v_gtol[2]) = (__pyx_v_self->etol->ptr[__pyx_v_tsGroup]);

          /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2494 */
          __pyx_v_startStep = (__pyx_v_nextStartStep + 1);

          /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2495 */
          __pyx_v_nextStartStep = ((__pyx_v_startStep + (__pyx_v_self->maxstp->ptr[__pyx_v_tsGroup])) - 1);

          /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2497 */
          __pyx_v_ltim = 1;

          /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2499 */
          __pyx_7 = (__pyx_v_nextStartStep + 1);
          for (__pyx_v_j = __pyx_v_startStep; __pyx_v_j < __pyx_7; ++__pyx_v_j) {

            /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2500 */
            __pyx_v_ntot = (__pyx_v_ntot + 1);

            /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2501 */
            __pyx_v_timeStep = (__pyx_v_timeStep + 1);

            /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2502 */
            (__pyx_v_self->ntimdat[0]) = __pyx_v_timeStep;

            /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2503 */
            __pyx_v_time = (__pyx_v_time + __pyx_v_dt);

            /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2504 */
            __pyx_4 = (__pyx_v_numslp != 0);
            if (__pyx_4) {
              __pyx_4 = (__pyx_v_iskopt == 2);
              if (!__pyx_4) {
                __pyx_4 = (__pyx_v_iskopt <= 0);
                if (__pyx_4) {
                  __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_abs); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2504; goto __pyx_L1;}
                  __pyx_3 = PyInt_FromLong(__pyx_v_iskopt); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2504; goto __pyx_L1;}
                  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2504; goto __pyx_L1;}
                  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_3);
                  __pyx_3 = 0;
                  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2504; goto __pyx_L1;}
                  Py_DECREF(__pyx_1); __pyx_1 = 0;
                  Py_DECREF(__pyx_2); __pyx_2 = 0;
                  __pyx_1 = PyInt_FromLong(__pyx_v_timeStep); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2504; goto __pyx_L1;}
                  if (PyObject_Cmp(__pyx_3, __pyx_1, &__pyx_4) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2504; goto __pyx_L1;}
                  __pyx_4 = __pyx_4 == 0;
                  Py_DECREF(__pyx_3); __pyx_3 = 0;
                  Py_DECREF(__pyx_1); __pyx_1 = 0;
                }
              }
            }
            __pyx_v_skc = __pyx_4;

            /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2505 */
            __pyx_v_fulout = 0;

            /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2507 */
            __pyx_5 = PyString_AsString(__pyx_v_self->ucdroot); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2594; goto __pyx_L1;}
            __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2613; goto __pyx_L1;}
            __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2613; goto __pyx_L1;}
            Py_INCREF(__pyx_v_self->ucdroot);
            PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_self->ucdroot);
            __pyx_1 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2613; goto __pyx_L1;}
            Py_DECREF(__pyx_2); __pyx_2 = 0;
            Py_DECREF(__pyx_3); __pyx_3 = 0;
            __pyx_6 = PyInt_AsUnsignedLongMask(__pyx_1); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2613; goto __pyx_L1;}
            Py_DECREF(__pyx_1); __pyx_1 = 0;
            FC_FUNC_(viscos_step, VISCOS_STEP)((&__pyx_v_self->_mesh->A),(&__pyx_v_self->_mesh->rhs),(&__pyx_v_self->_mesh->sol),__pyx_v_self->bextern->ptr,__pyx_v_self->btraction->ptr,__pyx_v_self->bgravity->ptr,__pyx_v_self->bconcForce->ptr,__pyx_v_self->bintern->ptr,__pyx_v_self->bresid->ptr,__pyx_v_self->bwink->ptr,__pyx_v_self->bwinkx->ptr,__pyx_v_self->dispVec->ptr,__pyx_v_self->dprev->ptr,__pyx_v_self->nforce,__pyx_v_self->_grav,__pyx_v_self->x->ptr,__pyx_v_self->d->ptr,__pyx_v_self->deld->ptr,__pyx_v_self->dcur->ptr,__pyx_v_self->id->ptr,__pyx_v_self->iwink->ptr,__pyx_v_self->wink->ptr,__pyx_v_self->nsysdat,__pyx_v_self->iddmat,__pyx_v_self->ibond->ptr,__pyx_v_self->bond->ptr,__pyx_v_self->dx->ptr,__pyx_v_self->deldx->ptr,__pyx_v_self->dxcur->ptr,__pyx_v_self->diforc->ptr,__pyx_v_self->idx->ptr,__pyx_v_self->iwinkx->ptr,__pyx_v_self->winkx->ptr,__pyx_v_self->idslp->ptr,__pyx_v_self->ipslp->ptr,__pyx_v_self->idhist->ptr,__pyx_v_self->fault->ptr,__pyx_v_self->nfault->ptr,__pyx_v_self->dfault->ptr,__pyx_v_self->tfault->ptr,__pyx_v_self->s->ptr,__pyx_v_self->stemp->ptr,__pyx_v_self->state->ptr,__pyx_v_self->dstate->ptr,__pyx_v_self->state0->ptr,__pyx_v_self->dmat->ptr,__pyx_v_self->iens->ptr,__pyx_v_self->lm->ptr,__pyx_v_self->lmx->ptr,__pyx_v_self->lmf->ptr,__pyx_v_self->ivfamily->ptr,__pyx_v_self->npar,__pyx_v_self->ielindx->ptr,__pyx_v_self->tractionverts->ptr,__pyx_v_self->tractionvals->ptr,__pyx_v_self->gauss2d->ptr,__pyx_v_self->sh2d->ptr,__pyx_v_self->infetype2d,__pyx_v_self->_prop->ptr,__pyx_v_self->infmatmod,__pyx_v_self->gauss->ptr,__pyx_v_self->sh->ptr,__pyx_v_self->shj->ptr,__pyx_v_self->infetype,__pyx_v_self->histry->ptr,__pyx_v_self->rtimdat,__pyx_v_self->ntimdat,__pyx_v_self->nvisdat,__pyx_v_self->maxstp->ptr,__pyx_v_self->delt->ptr,__pyx_v_self->alfa->ptr,__pyx_v_self->maxit->ptr,__pyx_v_self->ntdinit->ptr,__pyx_v_self->lgdef->ptr,__pyx_v_self->utol->ptr,__pyx_v_self->ftol->ptr,__pyx_v_self->etol->ptr,__pyx_v_self->itmax->ptr,__pyx_v_self->rgiter,__pyx_v_self->skew->ptr,__pyx_v_self->iprint->ptr,__pyx_v_self->ncodat,__pyx_v_self->nunits,__pyx_v_self->nprint,__pyx_v_self->istatout,__pyx_v_self->nstatout,__pyx_5,(&__pyx_v_self->viscousStage),(&__pyx_v_self->iterateEvent),(&__pyx_v_ntot),(&__pyx_v_ltim),(&__pyx_v_indexx),(&__pyx_v_cycle),(&__pyx_v_tsGroup),(&__pyx_v_j),(&__pyx_v_skc),(&__pyx_v_startStep),(&__pyx_v_timeStep),(&__pyx_v_fulout),(&__pyx_v_time),(&__pyx_v_dt),(&__pyx_v_lgdefp),__pyx_v_gtol,(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_6,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2507; goto __pyx_L1;}

            /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2615 */
            __pyx_2 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2615; goto __pyx_L1;}
            Py_DECREF(__pyx_2); __pyx_2 = 0;

            /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2617 */
            __pyx_v_ltim = 0;

            /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2618 */
            __pyx_4 = __pyx_v_fulout;
            if (__pyx_4) {

              /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2619 */
              __pyx_3 = PyNumber_Add(__pyx_v_self->fileRoot, __pyx_k87p); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2619; goto __pyx_L1;}
              __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_str); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2619; goto __pyx_L1;}
              __pyx_2 = PyInt_FromLong(__pyx_v_ntot); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2619; goto __pyx_L1;}
              __pyx_8 = PyTuple_New(1); if (!__pyx_8) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2619; goto __pyx_L1;}
              PyTuple_SET_ITEM(__pyx_8, 0, __pyx_2);
              __pyx_2 = 0;
              __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_8); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2619; goto __pyx_L1;}
              Py_DECREF(__pyx_1); __pyx_1 = 0;
              Py_DECREF(__pyx_8); __pyx_8 = 0;
              __pyx_1 = PyNumber_Add(__pyx_3, __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2619; goto __pyx_L1;}
              Py_DECREF(__pyx_3); __pyx_3 = 0;
              Py_DECREF(__pyx_2); __pyx_2 = 0;
              __pyx_8 = ((struct __pyx_vtabstruct_13PyLithMeshLib_Mesh *)__pyx_v_self->_mesh->__pyx_vtab)->outputMesh(__pyx_v_self->_mesh,__pyx_1); if (!__pyx_8) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2619; goto __pyx_L1;}
              Py_DECREF(__pyx_1); __pyx_1 = 0;
              Py_DECREF(__pyx_8); __pyx_8 = 0;
              goto __pyx_L13;
            }
            __pyx_L13:;

            /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2620 */
            __pyx_4 = (__pyx_v_indexx > __pyx_v_icontr);
            if (__pyx_4) {

              /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2621 */
              __pyx_v_indexx = __pyx_v_icontr;
              goto __pyx_L14;
            }
            __pyx_L14:;
          }
        }
      }

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2624 */
      if (__Pyx_PrintItem(__pyx_k88p) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2624; goto __pyx_L1;}
      __pyx_3 = PyInt_FromLong((__pyx_v_self->ntimdat[5])); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2624; goto __pyx_L1;}
      if (__Pyx_PrintItem(__pyx_3) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2624; goto __pyx_L1;}
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2624; goto __pyx_L1;}

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2625 */
      if (__Pyx_PrintItem(__pyx_k89p) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2625; goto __pyx_L1;}
      __pyx_2 = PyInt_FromLong((__pyx_v_self->ntimdat[6])); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2625; goto __pyx_L1;}
      if (__Pyx_PrintItem(__pyx_2) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2625; goto __pyx_L1;}
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2625; goto __pyx_L1;}

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2627 */
      FC_FUNC_(viscos_cleanup, VISCOS_CLEANUP)(__pyx_v_self->ntimdat,__pyx_v_self->nprint,__pyx_v_self->nunits,(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2627; goto __pyx_L1;}

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2634 */
      __pyx_1 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2634; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2636 */
      __pyx_8 = __pyx_f_9PyLithLib_PetscLogStagePop(); if (!__pyx_8) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2636; goto __pyx_L1;}
      Py_DECREF(__pyx_8); __pyx_8 = 0;
      goto __pyx_L5;
    }
    /*else*/ {

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2640 */
      __pyx_5 = PyString_AsString(__pyx_v_self->ucdroot); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2727; goto __pyx_L1;}
      __pyx_3 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2732; goto __pyx_L1;}
      __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2732; goto __pyx_L1;}
      Py_INCREF(__pyx_v_self->ucdroot);
      PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_self->ucdroot);
      __pyx_1 = PyObject_CallObject(__pyx_3, __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2732; goto __pyx_L1;}
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      __pyx_6 = PyInt_AsUnsignedLongMask(__pyx_1); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2732; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      FC_FUNC(viscos, VISCOS)((&__pyx_v_self->_mesh->A),(&__pyx_v_self->_mesh->rhs),(&__pyx_v_self->_mesh->sol),__pyx_v_self->bextern->ptr,__pyx_v_self->btraction->ptr,__pyx_v_self->bgravity->ptr,__pyx_v_self->bconcForce->ptr,__pyx_v_self->bintern->ptr,__pyx_v_self->bresid->ptr,__pyx_v_self->bwink->ptr,__pyx_v_self->bwinkx->ptr,__pyx_v_self->dispVec->ptr,__pyx_v_self->dprev->ptr,__pyx_v_self->nforce,__pyx_v_self->_grav,__pyx_v_self->x->ptr,__pyx_v_self->d->ptr,__pyx_v_self->deld->ptr,__pyx_v_self->dcur->ptr,__pyx_v_self->id->ptr,__pyx_v_self->iwink->ptr,__pyx_v_self->wink->ptr,__pyx_v_self->nsysdat,__pyx_v_self->iddmat,__pyx_v_self->ibond->ptr,__pyx_v_self->bond->ptr,__pyx_v_self->dx->ptr,__pyx_v_self->deldx->ptr,__pyx_v_self->dxcur->ptr,__pyx_v_self->diforc->ptr,__pyx_v_self->idx->ptr,__pyx_v_self->iwinkx->ptr,__pyx_v_self->winkx->ptr,__pyx_v_self->idslp->ptr,__pyx_v_self->ipslp->ptr,__pyx_v_self->idhist->ptr,__pyx_v_self->fault->ptr,__pyx_v_self->nfault->ptr,__pyx_v_self->dfault->ptr,__pyx_v_self->tfault->ptr,__pyx_v_self->s->ptr,__pyx_v_self->stemp->ptr,__pyx_v_self->state->ptr,__pyx_v_self->dstate->ptr,__pyx_v_self->state0->ptr,__pyx_v_self->dmat->ptr,__pyx_v_self->iens->ptr,__pyx_v_self->lm->ptr,__pyx_v_self->lmx->ptr,__pyx_v_self->lmf->ptr,__pyx_v_self->ivfamily->ptr,__pyx_v_self->npar,__pyx_v_self->ielindx->ptr,__pyx_v_self->tractionverts->ptr,__pyx_v_self->tractionvals->ptr,__pyx_v_self->gauss2d->ptr,__pyx_v_self->sh2d->ptr,__pyx_v_self->infetype2d,__pyx_v_self->_prop->ptr,__pyx_v_self->infmatmod,__pyx_v_self->gauss->ptr,__pyx_v_self->sh->ptr,__pyx_v_self->shj->ptr,__pyx_v_self->infetype,__pyx_v_self->histry->ptr,__pyx_v_self->rtimdat,__pyx_v_self->ntimdat,__pyx_v_self->nvisdat,__pyx_v_self->maxstp->ptr,__pyx_v_self->delt->ptr,__pyx_v_self->alfa->ptr,__pyx_v_self->maxit->ptr,__pyx_v_self->ntdinit->ptr,__pyx_v_self->lgdef->ptr,__pyx_v_self->utol->ptr,__pyx_v_self->ftol->ptr,__pyx_v_self->etol->ptr,__pyx_v_self->itmax->ptr,__pyx_v_self->rgiter,__pyx_v_self->skew->ptr,__pyx_v_self->iprint->ptr,__pyx_v_self->ncodat,__pyx_v_self->nunits,__pyx_v_self->nprint,__pyx_v_self->istatout,__pyx_v_self->nstatout,__pyx_5,(&__pyx_v_self->viscousStage),(&__pyx_v_self->iterateEvent),(&__pyx_v_errorcode),__pyx_v_errorstring,__pyx_6,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2640; goto __pyx_L1;}

      /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2734 */
      __pyx_8 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_8) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2734; goto __pyx_L1;}
      Py_DECREF(__pyx_8); __pyx_8 = 0;
    }
    __pyx_L5:;
    goto __pyx_L4;
  }
  __pyx_L4:;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2736 */
  __pyx_3 = ((struct __pyx_vtabstruct_13PyLithMeshLib_Mesh *)__pyx_v_self->_mesh->__pyx_vtab)->destroyMat(__pyx_v_self->_mesh); if (!__pyx_3) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2736; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2738 */
  __pyx_2 = PyObject_GetAttr(__pyx_v_self->trace, __pyx_n_log); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2738; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2738; goto __pyx_L1;}
  Py_INCREF(__pyx_k90p);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_k90p);
  __pyx_8 = PyObject_CallObject(__pyx_2, __pyx_1); if (!__pyx_8) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2738; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_8); __pyx_8 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2740 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_8);
  __Pyx_AddTraceback("PyLithLib.PyLith.runSimulation");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_memoryUsageMB);
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_9PyLithLib_try_binio(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_9PyLithLib_try_binio(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_kucd = 0;
  int __pyx_v_u;
  int __pyx_v_errorcode;
  char (__pyx_v_errorstring[__pyx_e_9PyLithLib_errorstring_size]);
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  static char *__pyx_argnames[] = {"kucd",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_kucd)) return 0;
  Py_INCREF(__pyx_v_kucd);

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2749 */
  __pyx_1 = PyInt_AsLong(__pyx_v_kucd); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2749; goto __pyx_L1;}
  __pyx_v_u = __pyx_1;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2750 */
  __pyx_v_errorcode = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2752 */
  FC_FUNC_(try_binio, TRY_BINIO)((&__pyx_v_u),(&__pyx_v_errorcode),__pyx_v_errorstring,(sizeof(__pyx_v_errorstring))); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2752; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2753 */
  __pyx_2 = exceptionhandler(__pyx_v_errorcode,__pyx_v_errorstring); if (!__pyx_2) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 2753; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2755 */
  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("PyLithLib.try_binio");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_kucd);
  return __pyx_r;
}

static __Pyx_InternTabEntry __pyx_intern_tab[] = {
  {&__pyx_n_False, "False"},
  {&__pyx_n_IOError, "IOError"},
  {&__pyx_n_Iterate, "Iterate"},
  {&__pyx_n_MemoryError, "MemoryError"},
  {&__pyx_n_PetscFinalize, "PetscFinalize"},
  {&__pyx_n_PetscInitialize, "PetscInitialize"},
  {&__pyx_n_PyLithMeshLib, "PyLithMeshLib"},
  {&__pyx_n_RuntimeError, "RuntimeError"},
  {&__pyx_n_ValueError, "ValueError"},
  {&__pyx_n_abs, "abs"},
  {&__pyx_n_append, "append"},
  {&__pyx_n_close, "close"},
  {&__pyx_n_constants, "constants"},
  {&__pyx_n_debug, "debug"},
  {&__pyx_n_direct, "direct"},
  {&__pyx_n_elementtypes, "elementtypes"},
  {&__pyx_n_enumerate, "enumerate"},
  {&__pyx_n_f77close, "f77close"},
  {&__pyx_n_f77open, "f77open"},
  {&__pyx_n_file, "file"},
  {&__pyx_n_float, "float"},
  {&__pyx_n_form, "form"},
  {&__pyx_n_formatted, "formatted"},
  {&__pyx_n_gfile, "gfile"},
  {&__pyx_n_ghelp, "ghelp"},
  {&__pyx_n_idsk, "idsk"},
  {&__pyx_n_int, "int"},
  {&__pyx_n_interpolatePoints, "interpolatePoints"},
  {&__pyx_n_intord, "intord"},
  {&__pyx_n_isinstance, "isinstance"},
  {&__pyx_n_journal, "journal"},
  {&__pyx_n_len, "len"},
  {&__pyx_n_libpylith3d, "libpylith3d"},
  {&__pyx_n_log, "log"},
  {&__pyx_n_lower, "lower"},
  {&__pyx_n_new, "new"},
  {&__pyx_n_old, "old"},
  {&__pyx_n_parse, "parse"},
  {&__pyx_n_parser, "parser"},
  {&__pyx_n_petsc, "petsc"},
  {&__pyx_n_scratch, "scratch"},
  {&__pyx_n_sequential, "sequential"},
  {&__pyx_n_str, "str"},
  {&__pyx_n_strip, "strip"},
  {&__pyx_n_try_binio, "try_binio"},
  {&__pyx_n_unformatted, "unformatted"},
  {&__pyx_n_units, "units"},
  {&__pyx_n_unknown, "unknown"},
  {&__pyx_n_value, "value"},
  {&__pyx_n_w, "w"},
  {&__pyx_n_write, "write"},
  {0, 0}
};

static __Pyx_StringTabEntry __pyx_string_tab[] = {
  {&__pyx_k7p, __pyx_k7, sizeof(__pyx_k7)},
  {&__pyx_k8p, __pyx_k8, sizeof(__pyx_k8)},
  {&__pyx_k14p, __pyx_k14, sizeof(__pyx_k14)},
  {&__pyx_k17p, __pyx_k17, sizeof(__pyx_k17)},
  {&__pyx_k19p, __pyx_k19, sizeof(__pyx_k19)},
  {&__pyx_k20p, __pyx_k20, sizeof(__pyx_k20)},
  {&__pyx_k26p, __pyx_k26, sizeof(__pyx_k26)},
  {&__pyx_k27p, __pyx_k27, sizeof(__pyx_k27)},
  {&__pyx_k28p, __pyx_k28, sizeof(__pyx_k28)},
  {&__pyx_k29p, __pyx_k29, sizeof(__pyx_k29)},
  {&__pyx_k30p, __pyx_k30, sizeof(__pyx_k30)},
  {&__pyx_k31p, __pyx_k31, sizeof(__pyx_k31)},
  {&__pyx_k32p, __pyx_k32, sizeof(__pyx_k32)},
  {&__pyx_k33p, __pyx_k33, sizeof(__pyx_k33)},
  {&__pyx_k34p, __pyx_k34, sizeof(__pyx_k34)},
  {&__pyx_k37p, __pyx_k37, sizeof(__pyx_k37)},
  {&__pyx_k39p, __pyx_k39, sizeof(__pyx_k39)},
  {&__pyx_k42p, __pyx_k42, sizeof(__pyx_k42)},
  {&__pyx_k44p, __pyx_k44, sizeof(__pyx_k44)},
  {&__pyx_k45p, __pyx_k45, sizeof(__pyx_k45)},
  {&__pyx_k46p, __pyx_k46, sizeof(__pyx_k46)},
  {&__pyx_k47p, __pyx_k47, sizeof(__pyx_k47)},
  {&__pyx_k48p, __pyx_k48, sizeof(__pyx_k48)},
  {&__pyx_k49p, __pyx_k49, sizeof(__pyx_k49)},
  {&__pyx_k50p, __pyx_k50, sizeof(__pyx_k50)},
  {&__pyx_k51p, __pyx_k51, sizeof(__pyx_k51)},
  {&__pyx_k52p, __pyx_k52, sizeof(__pyx_k52)},
  {&__pyx_k53p, __pyx_k53, sizeof(__pyx_k53)},
  {&__pyx_k54p, __pyx_k54, sizeof(__pyx_k54)},
  {&__pyx_k55p, __pyx_k55, sizeof(__pyx_k55)},
  {&__pyx_k56p, __pyx_k56, sizeof(__pyx_k56)},
  {&__pyx_k57p, __pyx_k57, sizeof(__pyx_k57)},
  {&__pyx_k58p, __pyx_k58, sizeof(__pyx_k58)},
  {&__pyx_k59p, __pyx_k59, sizeof(__pyx_k59)},
  {&__pyx_k60p, __pyx_k60, sizeof(__pyx_k60)},
  {&__pyx_k62p, __pyx_k62, sizeof(__pyx_k62)},
  {&__pyx_k63p, __pyx_k63, sizeof(__pyx_k63)},
  {&__pyx_k64p, __pyx_k64, sizeof(__pyx_k64)},
  {&__pyx_k65p, __pyx_k65, sizeof(__pyx_k65)},
  {&__pyx_k66p, __pyx_k66, sizeof(__pyx_k66)},
  {&__pyx_k67p, __pyx_k67, sizeof(__pyx_k67)},
  {&__pyx_k68p, __pyx_k68, sizeof(__pyx_k68)},
  {&__pyx_k69p, __pyx_k69, sizeof(__pyx_k69)},
  {&__pyx_k70p, __pyx_k70, sizeof(__pyx_k70)},
  {&__pyx_k71p, __pyx_k71, sizeof(__pyx_k71)},
  {&__pyx_k72p, __pyx_k72, sizeof(__pyx_k72)},
  {&__pyx_k73p, __pyx_k73, sizeof(__pyx_k73)},
  {&__pyx_k74p, __pyx_k74, sizeof(__pyx_k74)},
  {&__pyx_k75p, __pyx_k75, sizeof(__pyx_k75)},
  {&__pyx_k76p, __pyx_k76, sizeof(__pyx_k76)},
  {&__pyx_k77p, __pyx_k77, sizeof(__pyx_k77)},
  {&__pyx_k78p, __pyx_k78, sizeof(__pyx_k78)},
  {&__pyx_k79p, __pyx_k79, sizeof(__pyx_k79)},
  {&__pyx_k80p, __pyx_k80, sizeof(__pyx_k80)},
  {&__pyx_k81p, __pyx_k81, sizeof(__pyx_k81)},
  {&__pyx_k82p, __pyx_k82, sizeof(__pyx_k82)},
  {&__pyx_k83p, __pyx_k83, sizeof(__pyx_k83)},
  {&__pyx_k84p, __pyx_k84, sizeof(__pyx_k84)},
  {&__pyx_k85p, __pyx_k85, sizeof(__pyx_k85)},
  {&__pyx_k86p, __pyx_k86, sizeof(__pyx_k86)},
  {&__pyx_k87p, __pyx_k87, sizeof(__pyx_k87)},
  {&__pyx_k88p, __pyx_k88, sizeof(__pyx_k88)},
  {&__pyx_k89p, __pyx_k89, sizeof(__pyx_k89)},
  {&__pyx_k90p, __pyx_k90, sizeof(__pyx_k90)},
  {0, 0, 0}
};
static struct __pyx_vtabstruct_9PyLithLib_IntArray __pyx_vtable_9PyLithLib_IntArray;

static PyObject *__pyx_tp_new_9PyLithLib_IntArray(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  struct __pyx_obj_9PyLithLib_IntArray *p = (struct __pyx_obj_9PyLithLib_IntArray *)o;
  *(struct __pyx_vtabstruct_9PyLithLib_IntArray **)&p->__pyx_vtab = __pyx_vtabptr_9PyLithLib_IntArray;
  if (__pyx_f_9PyLithLib_8IntArray___new__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_9PyLithLib_IntArray(PyObject *o) {
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++o->ob_refcnt;
    __pyx_f_9PyLithLib_8IntArray___dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --o->ob_refcnt;
    PyErr_Restore(etype, eval, etb);
  }
  (*o->ob_type->tp_free)(o);
}

static int __pyx_tp_traverse_9PyLithLib_IntArray(PyObject *o, visitproc v, void *a) {
  return 0;
}

static int __pyx_tp_clear_9PyLithLib_IntArray(PyObject *o) {
  return 0;
}

static struct PyMethodDef __pyx_methods_9PyLithLib_IntArray[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_IntArray = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  0, /*nb_divide*/
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  0, /*nb_coerce*/
  0, /*nb_int*/
  0, /*nb_long*/
  0, /*nb_float*/
  0, /*nb_oct*/
  0, /*nb_hex*/
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  0, /*nb_inplace_divide*/
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
};

static PySequenceMethods __pyx_tp_as_sequence_IntArray = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_IntArray = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_IntArray = {
  0, /*bf_getreadbuffer*/
  0, /*bf_getwritebuffer*/
  0, /*bf_getsegcount*/
  0, /*bf_getcharbuffer*/
};

PyTypeObject __pyx_type_9PyLithLib_IntArray = {
  PyObject_HEAD_INIT(0)
  0, /*ob_size*/
  "PyLithLib.IntArray", /*tp_name*/
  sizeof(struct __pyx_obj_9PyLithLib_IntArray), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_9PyLithLib_IntArray, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_IntArray, /*tp_as_number*/
  &__pyx_tp_as_sequence_IntArray, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_IntArray, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_IntArray, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_9PyLithLib_IntArray, /*tp_traverse*/
  __pyx_tp_clear_9PyLithLib_IntArray, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_9PyLithLib_IntArray, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_9PyLithLib_IntArray, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};
static struct __pyx_vtabstruct_9PyLithLib_DoubleArray __pyx_vtable_9PyLithLib_DoubleArray;

static PyObject *__pyx_tp_new_9PyLithLib_DoubleArray(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  struct __pyx_obj_9PyLithLib_DoubleArray *p = (struct __pyx_obj_9PyLithLib_DoubleArray *)o;
  *(struct __pyx_vtabstruct_9PyLithLib_DoubleArray **)&p->__pyx_vtab = __pyx_vtabptr_9PyLithLib_DoubleArray;
  if (__pyx_f_9PyLithLib_11DoubleArray___new__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_9PyLithLib_DoubleArray(PyObject *o) {
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++o->ob_refcnt;
    __pyx_f_9PyLithLib_11DoubleArray___dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --o->ob_refcnt;
    PyErr_Restore(etype, eval, etb);
  }
  (*o->ob_type->tp_free)(o);
}

static int __pyx_tp_traverse_9PyLithLib_DoubleArray(PyObject *o, visitproc v, void *a) {
  return 0;
}

static int __pyx_tp_clear_9PyLithLib_DoubleArray(PyObject *o) {
  return 0;
}

static struct PyMethodDef __pyx_methods_9PyLithLib_DoubleArray[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_DoubleArray = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  0, /*nb_divide*/
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  0, /*nb_coerce*/
  0, /*nb_int*/
  0, /*nb_long*/
  0, /*nb_float*/
  0, /*nb_oct*/
  0, /*nb_hex*/
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  0, /*nb_inplace_divide*/
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
};

static PySequenceMethods __pyx_tp_as_sequence_DoubleArray = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_DoubleArray = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_DoubleArray = {
  0, /*bf_getreadbuffer*/
  0, /*bf_getwritebuffer*/
  0, /*bf_getsegcount*/
  0, /*bf_getcharbuffer*/
};

PyTypeObject __pyx_type_9PyLithLib_DoubleArray = {
  PyObject_HEAD_INIT(0)
  0, /*ob_size*/
  "PyLithLib.DoubleArray", /*tp_name*/
  sizeof(struct __pyx_obj_9PyLithLib_DoubleArray), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_9PyLithLib_DoubleArray, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_DoubleArray, /*tp_as_number*/
  &__pyx_tp_as_sequence_DoubleArray, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_DoubleArray, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_DoubleArray, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_9PyLithLib_DoubleArray, /*tp_traverse*/
  __pyx_tp_clear_9PyLithLib_DoubleArray, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_9PyLithLib_DoubleArray, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_9PyLithLib_DoubleArray, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};
static struct __pyx_vtabstruct_9PyLithLib_PyLith __pyx_vtable_9PyLithLib_PyLith;

static PyObject *__pyx_tp_new_9PyLithLib_PyLith(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  struct __pyx_obj_9PyLithLib_PyLith *p = (struct __pyx_obj_9PyLithLib_PyLith *)o;
  *(struct __pyx_vtabstruct_9PyLithLib_PyLith **)&p->__pyx_vtab = __pyx_vtabptr_9PyLithLib_PyLith;
  p->title = Py_None; Py_INCREF(Py_None);
  p->fileRoot = Py_None; Py_INCREF(Py_None);
  p->ofile = Py_None; Py_INCREF(Py_None);
  p->pfile = Py_None; Py_INCREF(Py_None);
  p->ucdroot = Py_None; Py_INCREF(Py_None);
  p->coordinateInputFile = Py_None; Py_INCREF(Py_None);
  p->bcfile = Py_None; Py_INCREF(Py_None);
  p->timeStepInputFile = Py_None; Py_INCREF(Py_None);
  p->stfile = Py_None; Py_INCREF(Py_None);
  p->connectivityInputFile = Py_None; Py_INCREF(Py_None);
  p->fofile = Py_None; Py_INCREF(Py_None);
  p->sampleLocationFile = Py_None; Py_INCREF(Py_None);
  p->spfile = Py_None; Py_INCREF(Py_None);
  p->skfile = Py_None; Py_INCREF(Py_None);
  p->hfile = Py_None; Py_INCREF(Py_None);
  p->tractionInputFile = Py_None; Py_INCREF(Py_None);
  p->wfile = Py_None; Py_INCREF(Py_None);
  p->materialHistoryInputFile = Py_None; Py_INCREF(Py_None);
  p->prestressInputFile = Py_None; Py_INCREF(Py_None);
  p->slfile = Py_None; Py_INCREF(Py_None);
  p->difile = Py_None; Py_INCREF(Py_None);
  p->wxfile = Py_None; Py_INCREF(Py_None);
  p->_mesh = ((struct PyMeshObject *)Py_None); Py_INCREF(Py_None);
  p->_prop = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->_infmat = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->trace = Py_None; Py_INCREF(Py_None);
  p->ivflist = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->sh = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->shj = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->gauss = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->sh2d = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->gauss2d = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->x = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->bond = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->ibond = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->skew = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->delt = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->alfa = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->utol = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->ftol = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->etol = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->times = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->maxstp = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->maxit = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->ntdinit = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->lgdef = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->itmax = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->iprint = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->histry = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->ien = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->mat = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->tractionverts = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->tractionvals = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->nfault = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->fault = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->nslip = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->idhist = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->diforc = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->iwinkdef = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->iwinkid = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->winkdef = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->iwinkxdef = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->iwinkxid = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->winkxdef = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->idftn = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->id = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->idx = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->idslp = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->ipslp = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->wink = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->winkx = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->iwink = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->iwinkx = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->iens = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->ivfamily = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->indxiel = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->ielindx = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->lm = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->lmf = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->lmx = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  p->bextern = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->btraction = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->bgravity = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->bconcForce = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->bwink = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->bwinkx = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->bintern = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->bresid = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->dispVec = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->dprev = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->d = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->deld = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->dcur = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->dx = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->deldx = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->dxcur = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->dfault = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->tfault = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->s = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->stemp = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->state = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->dstate = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->dmat = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  p->state0 = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  if (__pyx_f_9PyLithLib_6PyLith___new__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_9PyLithLib_PyLith(PyObject *o) {
  struct __pyx_obj_9PyLithLib_PyLith *p = (struct __pyx_obj_9PyLithLib_PyLith *)o;
  Py_XDECREF(p->title);
  Py_XDECREF(p->fileRoot);
  Py_XDECREF(p->ofile);
  Py_XDECREF(p->pfile);
  Py_XDECREF(p->ucdroot);
  Py_XDECREF(p->coordinateInputFile);
  Py_XDECREF(p->bcfile);
  Py_XDECREF(p->timeStepInputFile);
  Py_XDECREF(p->stfile);
  Py_XDECREF(p->connectivityInputFile);
  Py_XDECREF(p->fofile);
  Py_XDECREF(p->sampleLocationFile);
  Py_XDECREF(p->spfile);
  Py_XDECREF(p->skfile);
  Py_XDECREF(p->hfile);
  Py_XDECREF(p->tractionInputFile);
  Py_XDECREF(p->wfile);
  Py_XDECREF(p->materialHistoryInputFile);
  Py_XDECREF(p->prestressInputFile);
  Py_XDECREF(p->slfile);
  Py_XDECREF(p->difile);
  Py_XDECREF(p->wxfile);
  Py_XDECREF(((PyObject *)p->_mesh));
  Py_XDECREF(((PyObject *)p->_prop));
  Py_XDECREF(((PyObject *)p->_infmat));
  Py_XDECREF(p->trace);
  Py_XDECREF(((PyObject *)p->ivflist));
  Py_XDECREF(((PyObject *)p->sh));
  Py_XDECREF(((PyObject *)p->shj));
  Py_XDECREF(((PyObject *)p->gauss));
  Py_XDECREF(((PyObject *)p->sh2d));
  Py_XDECREF(((PyObject *)p->gauss2d));
  Py_XDECREF(((PyObject *)p->x));
  Py_XDECREF(((PyObject *)p->bond));
  Py_XDECREF(((PyObject *)p->ibond));
  Py_XDECREF(((PyObject *)p->skew));
  Py_XDECREF(((PyObject *)p->delt));
  Py_XDECREF(((PyObject *)p->alfa));
  Py_XDECREF(((PyObject *)p->utol));
  Py_XDECREF(((PyObject *)p->ftol));
  Py_XDECREF(((PyObject *)p->etol));
  Py_XDECREF(((PyObject *)p->times));
  Py_XDECREF(((PyObject *)p->maxstp));
  Py_XDECREF(((PyObject *)p->maxit));
  Py_XDECREF(((PyObject *)p->ntdinit));
  Py_XDECREF(((PyObject *)p->lgdef));
  Py_XDECREF(((PyObject *)p->itmax));
  Py_XDECREF(((PyObject *)p->iprint));
  Py_XDECREF(((PyObject *)p->histry));
  Py_XDECREF(((PyObject *)p->ien));
  Py_XDECREF(((PyObject *)p->mat));
  Py_XDECREF(((PyObject *)p->tractionverts));
  Py_XDECREF(((PyObject *)p->tractionvals));
  Py_XDECREF(((PyObject *)p->nfault));
  Py_XDECREF(((PyObject *)p->fault));
  Py_XDECREF(((PyObject *)p->nslip));
  Py_XDECREF(((PyObject *)p->idhist));
  Py_XDECREF(((PyObject *)p->diforc));
  Py_XDECREF(((PyObject *)p->iwinkdef));
  Py_XDECREF(((PyObject *)p->iwinkid));
  Py_XDECREF(((PyObject *)p->winkdef));
  Py_XDECREF(((PyObject *)p->iwinkxdef));
  Py_XDECREF(((PyObject *)p->iwinkxid));
  Py_XDECREF(((PyObject *)p->winkxdef));
  Py_XDECREF(((PyObject *)p->idftn));
  Py_XDECREF(((PyObject *)p->id));
  Py_XDECREF(((PyObject *)p->idx));
  Py_XDECREF(((PyObject *)p->idslp));
  Py_XDECREF(((PyObject *)p->ipslp));
  Py_XDECREF(((PyObject *)p->wink));
  Py_XDECREF(((PyObject *)p->winkx));
  Py_XDECREF(((PyObject *)p->iwink));
  Py_XDECREF(((PyObject *)p->iwinkx));
  Py_XDECREF(((PyObject *)p->iens));
  Py_XDECREF(((PyObject *)p->ivfamily));
  Py_XDECREF(((PyObject *)p->indxiel));
  Py_XDECREF(((PyObject *)p->ielindx));
  Py_XDECREF(((PyObject *)p->lm));
  Py_XDECREF(((PyObject *)p->lmf));
  Py_XDECREF(((PyObject *)p->lmx));
  Py_XDECREF(((PyObject *)p->bextern));
  Py_XDECREF(((PyObject *)p->btraction));
  Py_XDECREF(((PyObject *)p->bgravity));
  Py_XDECREF(((PyObject *)p->bconcForce));
  Py_XDECREF(((PyObject *)p->bwink));
  Py_XDECREF(((PyObject *)p->bwinkx));
  Py_XDECREF(((PyObject *)p->bintern));
  Py_XDECREF(((PyObject *)p->bresid));
  Py_XDECREF(((PyObject *)p->dispVec));
  Py_XDECREF(((PyObject *)p->dprev));
  Py_XDECREF(((PyObject *)p->d));
  Py_XDECREF(((PyObject *)p->deld));
  Py_XDECREF(((PyObject *)p->dcur));
  Py_XDECREF(((PyObject *)p->dx));
  Py_XDECREF(((PyObject *)p->deldx));
  Py_XDECREF(((PyObject *)p->dxcur));
  Py_XDECREF(((PyObject *)p->dfault));
  Py_XDECREF(((PyObject *)p->tfault));
  Py_XDECREF(((PyObject *)p->s));
  Py_XDECREF(((PyObject *)p->stemp));
  Py_XDECREF(((PyObject *)p->state));
  Py_XDECREF(((PyObject *)p->dstate));
  Py_XDECREF(((PyObject *)p->dmat));
  Py_XDECREF(((PyObject *)p->state0));
  (*o->ob_type->tp_free)(o);
}

static int __pyx_tp_traverse_9PyLithLib_PyLith(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_9PyLithLib_PyLith *p = (struct __pyx_obj_9PyLithLib_PyLith *)o;
  if (p->title) {
    e = (*v)(p->title, a); if (e) return e;
  }
  if (p->fileRoot) {
    e = (*v)(p->fileRoot, a); if (e) return e;
  }
  if (p->ofile) {
    e = (*v)(p->ofile, a); if (e) return e;
  }
  if (p->pfile) {
    e = (*v)(p->pfile, a); if (e) return e;
  }
  if (p->ucdroot) {
    e = (*v)(p->ucdroot, a); if (e) return e;
  }
  if (p->coordinateInputFile) {
    e = (*v)(p->coordinateInputFile, a); if (e) return e;
  }
  if (p->bcfile) {
    e = (*v)(p->bcfile, a); if (e) return e;
  }
  if (p->timeStepInputFile) {
    e = (*v)(p->timeStepInputFile, a); if (e) return e;
  }
  if (p->stfile) {
    e = (*v)(p->stfile, a); if (e) return e;
  }
  if (p->connectivityInputFile) {
    e = (*v)(p->connectivityInputFile, a); if (e) return e;
  }
  if (p->fofile) {
    e = (*v)(p->fofile, a); if (e) return e;
  }
  if (p->sampleLocationFile) {
    e = (*v)(p->sampleLocationFile, a); if (e) return e;
  }
  if (p->spfile) {
    e = (*v)(p->spfile, a); if (e) return e;
  }
  if (p->skfile) {
    e = (*v)(p->skfile, a); if (e) return e;
  }
  if (p->hfile) {
    e = (*v)(p->hfile, a); if (e) return e;
  }
  if (p->tractionInputFile) {
    e = (*v)(p->tractionInputFile, a); if (e) return e;
  }
  if (p->wfile) {
    e = (*v)(p->wfile, a); if (e) return e;
  }
  if (p->materialHistoryInputFile) {
    e = (*v)(p->materialHistoryInputFile, a); if (e) return e;
  }
  if (p->prestressInputFile) {
    e = (*v)(p->prestressInputFile, a); if (e) return e;
  }
  if (p->slfile) {
    e = (*v)(p->slfile, a); if (e) return e;
  }
  if (p->difile) {
    e = (*v)(p->difile, a); if (e) return e;
  }
  if (p->wxfile) {
    e = (*v)(p->wxfile, a); if (e) return e;
  }
  if (p->_mesh) {
    e = (*v)(((PyObject*)p->_mesh), a); if (e) return e;
  }
  if (p->_prop) {
    e = (*v)(((PyObject*)p->_prop), a); if (e) return e;
  }
  if (p->_infmat) {
    e = (*v)(((PyObject*)p->_infmat), a); if (e) return e;
  }
  if (p->trace) {
    e = (*v)(p->trace, a); if (e) return e;
  }
  if (p->ivflist) {
    e = (*v)(((PyObject*)p->ivflist), a); if (e) return e;
  }
  if (p->sh) {
    e = (*v)(((PyObject*)p->sh), a); if (e) return e;
  }
  if (p->shj) {
    e = (*v)(((PyObject*)p->shj), a); if (e) return e;
  }
  if (p->gauss) {
    e = (*v)(((PyObject*)p->gauss), a); if (e) return e;
  }
  if (p->sh2d) {
    e = (*v)(((PyObject*)p->sh2d), a); if (e) return e;
  }
  if (p->gauss2d) {
    e = (*v)(((PyObject*)p->gauss2d), a); if (e) return e;
  }
  if (p->x) {
    e = (*v)(((PyObject*)p->x), a); if (e) return e;
  }
  if (p->bond) {
    e = (*v)(((PyObject*)p->bond), a); if (e) return e;
  }
  if (p->ibond) {
    e = (*v)(((PyObject*)p->ibond), a); if (e) return e;
  }
  if (p->skew) {
    e = (*v)(((PyObject*)p->skew), a); if (e) return e;
  }
  if (p->delt) {
    e = (*v)(((PyObject*)p->delt), a); if (e) return e;
  }
  if (p->alfa) {
    e = (*v)(((PyObject*)p->alfa), a); if (e) return e;
  }
  if (p->utol) {
    e = (*v)(((PyObject*)p->utol), a); if (e) return e;
  }
  if (p->ftol) {
    e = (*v)(((PyObject*)p->ftol), a); if (e) return e;
  }
  if (p->etol) {
    e = (*v)(((PyObject*)p->etol), a); if (e) return e;
  }
  if (p->times) {
    e = (*v)(((PyObject*)p->times), a); if (e) return e;
  }
  if (p->maxstp) {
    e = (*v)(((PyObject*)p->maxstp), a); if (e) return e;
  }
  if (p->maxit) {
    e = (*v)(((PyObject*)p->maxit), a); if (e) return e;
  }
  if (p->ntdinit) {
    e = (*v)(((PyObject*)p->ntdinit), a); if (e) return e;
  }
  if (p->lgdef) {
    e = (*v)(((PyObject*)p->lgdef), a); if (e) return e;
  }
  if (p->itmax) {
    e = (*v)(((PyObject*)p->itmax), a); if (e) return e;
  }
  if (p->iprint) {
    e = (*v)(((PyObject*)p->iprint), a); if (e) return e;
  }
  if (p->histry) {
    e = (*v)(((PyObject*)p->histry), a); if (e) return e;
  }
  if (p->ien) {
    e = (*v)(((PyObject*)p->ien), a); if (e) return e;
  }
  if (p->mat) {
    e = (*v)(((PyObject*)p->mat), a); if (e) return e;
  }
  if (p->tractionverts) {
    e = (*v)(((PyObject*)p->tractionverts), a); if (e) return e;
  }
  if (p->tractionvals) {
    e = (*v)(((PyObject*)p->tractionvals), a); if (e) return e;
  }
  if (p->nfault) {
    e = (*v)(((PyObject*)p->nfault), a); if (e) return e;
  }
  if (p->fault) {
    e = (*v)(((PyObject*)p->fault), a); if (e) return e;
  }
  if (p->nslip) {
    e = (*v)(((PyObject*)p->nslip), a); if (e) return e;
  }
  if (p->idhist) {
    e = (*v)(((PyObject*)p->idhist), a); if (e) return e;
  }
  if (p->diforc) {
    e = (*v)(((PyObject*)p->diforc), a); if (e) return e;
  }
  if (p->iwinkdef) {
    e = (*v)(((PyObject*)p->iwinkdef), a); if (e) return e;
  }
  if (p->iwinkid) {
    e = (*v)(((PyObject*)p->iwinkid), a); if (e) return e;
  }
  if (p->winkdef) {
    e = (*v)(((PyObject*)p->winkdef), a); if (e) return e;
  }
  if (p->iwinkxdef) {
    e = (*v)(((PyObject*)p->iwinkxdef), a); if (e) return e;
  }
  if (p->iwinkxid) {
    e = (*v)(((PyObject*)p->iwinkxid), a); if (e) return e;
  }
  if (p->winkxdef) {
    e = (*v)(((PyObject*)p->winkxdef), a); if (e) return e;
  }
  if (p->idftn) {
    e = (*v)(((PyObject*)p->idftn), a); if (e) return e;
  }
  if (p->id) {
    e = (*v)(((PyObject*)p->id), a); if (e) return e;
  }
  if (p->idx) {
    e = (*v)(((PyObject*)p->idx), a); if (e) return e;
  }
  if (p->idslp) {
    e = (*v)(((PyObject*)p->idslp), a); if (e) return e;
  }
  if (p->ipslp) {
    e = (*v)(((PyObject*)p->ipslp), a); if (e) return e;
  }
  if (p->wink) {
    e = (*v)(((PyObject*)p->wink), a); if (e) return e;
  }
  if (p->winkx) {
    e = (*v)(((PyObject*)p->winkx), a); if (e) return e;
  }
  if (p->iwink) {
    e = (*v)(((PyObject*)p->iwink), a); if (e) return e;
  }
  if (p->iwinkx) {
    e = (*v)(((PyObject*)p->iwinkx), a); if (e) return e;
  }
  if (p->iens) {
    e = (*v)(((PyObject*)p->iens), a); if (e) return e;
  }
  if (p->ivfamily) {
    e = (*v)(((PyObject*)p->ivfamily), a); if (e) return e;
  }
  if (p->indxiel) {
    e = (*v)(((PyObject*)p->indxiel), a); if (e) return e;
  }
  if (p->ielindx) {
    e = (*v)(((PyObject*)p->ielindx), a); if (e) return e;
  }
  if (p->lm) {
    e = (*v)(((PyObject*)p->lm), a); if (e) return e;
  }
  if (p->lmf) {
    e = (*v)(((PyObject*)p->lmf), a); if (e) return e;
  }
  if (p->lmx) {
    e = (*v)(((PyObject*)p->lmx), a); if (e) return e;
  }
  if (p->bextern) {
    e = (*v)(((PyObject*)p->bextern), a); if (e) return e;
  }
  if (p->btraction) {
    e = (*v)(((PyObject*)p->btraction), a); if (e) return e;
  }
  if (p->bgravity) {
    e = (*v)(((PyObject*)p->bgravity), a); if (e) return e;
  }
  if (p->bconcForce) {
    e = (*v)(((PyObject*)p->bconcForce), a); if (e) return e;
  }
  if (p->bwink) {
    e = (*v)(((PyObject*)p->bwink), a); if (e) return e;
  }
  if (p->bwinkx) {
    e = (*v)(((PyObject*)p->bwinkx), a); if (e) return e;
  }
  if (p->bintern) {
    e = (*v)(((PyObject*)p->bintern), a); if (e) return e;
  }
  if (p->bresid) {
    e = (*v)(((PyObject*)p->bresid), a); if (e) return e;
  }
  if (p->dispVec) {
    e = (*v)(((PyObject*)p->dispVec), a); if (e) return e;
  }
  if (p->dprev) {
    e = (*v)(((PyObject*)p->dprev), a); if (e) return e;
  }
  if (p->d) {
    e = (*v)(((PyObject*)p->d), a); if (e) return e;
  }
  if (p->deld) {
    e = (*v)(((PyObject*)p->deld), a); if (e) return e;
  }
  if (p->dcur) {
    e = (*v)(((PyObject*)p->dcur), a); if (e) return e;
  }
  if (p->dx) {
    e = (*v)(((PyObject*)p->dx), a); if (e) return e;
  }
  if (p->deldx) {
    e = (*v)(((PyObject*)p->deldx), a); if (e) return e;
  }
  if (p->dxcur) {
    e = (*v)(((PyObject*)p->dxcur), a); if (e) return e;
  }
  if (p->dfault) {
    e = (*v)(((PyObject*)p->dfault), a); if (e) return e;
  }
  if (p->tfault) {
    e = (*v)(((PyObject*)p->tfault), a); if (e) return e;
  }
  if (p->s) {
    e = (*v)(((PyObject*)p->s), a); if (e) return e;
  }
  if (p->stemp) {
    e = (*v)(((PyObject*)p->stemp), a); if (e) return e;
  }
  if (p->state) {
    e = (*v)(((PyObject*)p->state), a); if (e) return e;
  }
  if (p->dstate) {
    e = (*v)(((PyObject*)p->dstate), a); if (e) return e;
  }
  if (p->dmat) {
    e = (*v)(((PyObject*)p->dmat), a); if (e) return e;
  }
  if (p->state0) {
    e = (*v)(((PyObject*)p->state0), a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_9PyLithLib_PyLith(PyObject *o) {
  struct __pyx_obj_9PyLithLib_PyLith *p = (struct __pyx_obj_9PyLithLib_PyLith *)o;
  Py_XDECREF(p->title);
  p->title = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->fileRoot);
  p->fileRoot = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->ofile);
  p->ofile = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->pfile);
  p->pfile = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->ucdroot);
  p->ucdroot = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->coordinateInputFile);
  p->coordinateInputFile = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->bcfile);
  p->bcfile = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->timeStepInputFile);
  p->timeStepInputFile = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->stfile);
  p->stfile = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->connectivityInputFile);
  p->connectivityInputFile = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->fofile);
  p->fofile = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->sampleLocationFile);
  p->sampleLocationFile = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->spfile);
  p->spfile = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->skfile);
  p->skfile = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->hfile);
  p->hfile = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->tractionInputFile);
  p->tractionInputFile = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->wfile);
  p->wfile = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->materialHistoryInputFile);
  p->materialHistoryInputFile = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->prestressInputFile);
  p->prestressInputFile = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->slfile);
  p->slfile = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->difile);
  p->difile = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->wxfile);
  p->wxfile = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->_mesh));
  p->_mesh = ((struct PyMeshObject *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->_prop));
  p->_prop = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->_infmat));
  p->_infmat = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(p->trace);
  p->trace = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->ivflist));
  p->ivflist = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->sh));
  p->sh = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->shj));
  p->shj = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->gauss));
  p->gauss = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->sh2d));
  p->sh2d = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->gauss2d));
  p->gauss2d = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->x));
  p->x = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->bond));
  p->bond = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->ibond));
  p->ibond = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->skew));
  p->skew = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->delt));
  p->delt = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->alfa));
  p->alfa = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->utol));
  p->utol = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->ftol));
  p->ftol = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->etol));
  p->etol = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->times));
  p->times = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->maxstp));
  p->maxstp = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->maxit));
  p->maxit = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->ntdinit));
  p->ntdinit = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->lgdef));
  p->lgdef = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->itmax));
  p->itmax = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->iprint));
  p->iprint = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->histry));
  p->histry = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->ien));
  p->ien = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->mat));
  p->mat = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->tractionverts));
  p->tractionverts = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->tractionvals));
  p->tractionvals = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->nfault));
  p->nfault = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->fault));
  p->fault = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->nslip));
  p->nslip = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->idhist));
  p->idhist = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->diforc));
  p->diforc = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->iwinkdef));
  p->iwinkdef = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->iwinkid));
  p->iwinkid = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->winkdef));
  p->winkdef = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->iwinkxdef));
  p->iwinkxdef = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->iwinkxid));
  p->iwinkxid = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->winkxdef));
  p->winkxdef = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->idftn));
  p->idftn = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->id));
  p->id = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->idx));
  p->idx = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->idslp));
  p->idslp = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->ipslp));
  p->ipslp = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->wink));
  p->wink = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->winkx));
  p->winkx = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->iwink));
  p->iwink = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->iwinkx));
  p->iwinkx = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->iens));
  p->iens = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->ivfamily));
  p->ivfamily = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->indxiel));
  p->indxiel = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->ielindx));
  p->ielindx = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->lm));
  p->lm = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->lmf));
  p->lmf = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->lmx));
  p->lmx = ((struct __pyx_obj_9PyLithLib_IntArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->bextern));
  p->bextern = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->btraction));
  p->btraction = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->bgravity));
  p->bgravity = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->bconcForce));
  p->bconcForce = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->bwink));
  p->bwink = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->bwinkx));
  p->bwinkx = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->bintern));
  p->bintern = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->bresid));
  p->bresid = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->dispVec));
  p->dispVec = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->dprev));
  p->dprev = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->d));
  p->d = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->deld));
  p->deld = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->dcur));
  p->dcur = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->dx));
  p->dx = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->deldx));
  p->deldx = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->dxcur));
  p->dxcur = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->dfault));
  p->dfault = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->tfault));
  p->tfault = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->s));
  p->s = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->stemp));
  p->stemp = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->state));
  p->state = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->dstate));
  p->dstate = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->dmat));
  p->dmat = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->state0));
  p->state0 = ((struct __pyx_obj_9PyLithLib_DoubleArray *)Py_None); Py_INCREF(Py_None);
  return 0;
}

static PyObject *__pyx_getprop_9PyLithLib_6PyLith_grav(PyObject *o, void *x) {
  return __pyx_f_9PyLithLib_6PyLith_4grav___get__(o);
}

static int __pyx_setprop_9PyLithLib_6PyLith_grav(PyObject *o, PyObject *v, void *x) {
  if (v) {
    return __pyx_f_9PyLithLib_6PyLith_4grav___set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_9PyLithLib_6PyLith_prscal(PyObject *o, void *x) {
  return __pyx_f_9PyLithLib_6PyLith_6prscal___get__(o);
}

static int __pyx_setprop_9PyLithLib_6PyLith_prscal(PyObject *o, PyObject *v, void *x) {
  if (v) {
    return __pyx_f_9PyLithLib_6PyLith_6prscal___set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_9PyLithLib_6PyLith_wscal(PyObject *o, void *x) {
  return __pyx_f_9PyLithLib_6PyLith_5wscal___get__(o);
}

static int __pyx_setprop_9PyLithLib_6PyLith_wscal(PyObject *o, PyObject *v, void *x) {
  if (v) {
    return __pyx_f_9PyLithLib_6PyLith_5wscal___set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_9PyLithLib_6PyLith_wxscal(PyObject *o, void *x) {
  return __pyx_f_9PyLithLib_6PyLith_6wxscal___get__(o);
}

static int __pyx_setprop_9PyLithLib_6PyLith_wxscal(PyObject *o, PyObject *v, void *x) {
  if (v) {
    return __pyx_f_9PyLithLib_6PyLith_6wxscal___set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_9PyLithLib_6PyLith_prop(PyObject *o, void *x) {
  return __pyx_f_9PyLithLib_6PyLith_4prop___get__(o);
}

static int __pyx_setprop_9PyLithLib_6PyLith_prop(PyObject *o, PyObject *v, void *x) {
  if (v) {
    return __pyx_f_9PyLithLib_6PyLith_4prop___set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_9PyLithLib_6PyLith_infmat(PyObject *o, void *x) {
  return __pyx_f_9PyLithLib_6PyLith_6infmat___get__(o);
}

static int __pyx_setprop_9PyLithLib_6PyLith_infmat(PyObject *o, PyObject *v, void *x) {
  if (v) {
    return __pyx_f_9PyLithLib_6PyLith_6infmat___set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_9PyLithLib_6PyLith_mesh(PyObject *o, void *x) {
  return __pyx_f_9PyLithLib_6PyLith_4mesh___get__(o);
}

static int __pyx_setprop_9PyLithLib_6PyLith_mesh(PyObject *o, PyObject *v, void *x) {
  if (v) {
    return __pyx_f_9PyLithLib_6PyLith_4mesh___set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static struct PyMethodDef __pyx_methods_9PyLithLib_PyLith[] = {
  {"run", (PyCFunction)__pyx_f_9PyLithLib_6PyLith_run, METH_VARARGS|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};

static struct PyMemberDef __pyx_members_9PyLithLib_PyLith[] = {
  {"title", T_OBJECT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, title), 0, 0},
  {"fileRoot", T_OBJECT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, fileRoot), 0, 0},
  {"ofile", T_OBJECT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, ofile), 0, 0},
  {"pfile", T_OBJECT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, pfile), 0, 0},
  {"ucdroot", T_OBJECT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, ucdroot), 0, 0},
  {"coordinateInputFile", T_OBJECT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, coordinateInputFile), 0, 0},
  {"bcfile", T_OBJECT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, bcfile), 0, 0},
  {"timeStepInputFile", T_OBJECT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, timeStepInputFile), 0, 0},
  {"stfile", T_OBJECT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, stfile), 0, 0},
  {"connectivityInputFile", T_OBJECT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, connectivityInputFile), 0, 0},
  {"fofile", T_OBJECT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, fofile), 0, 0},
  {"sampleLocationFile", T_OBJECT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, sampleLocationFile), 0, 0},
  {"spfile", T_OBJECT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, spfile), 0, 0},
  {"skfile", T_OBJECT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, skfile), 0, 0},
  {"hfile", T_OBJECT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, hfile), 0, 0},
  {"tractionInputFile", T_OBJECT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, tractionInputFile), 0, 0},
  {"wfile", T_OBJECT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, wfile), 0, 0},
  {"materialHistoryInputFile", T_OBJECT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, materialHistoryInputFile), 0, 0},
  {"prestressInputFile", T_OBJECT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, prestressInputFile), 0, 0},
  {"slfile", T_OBJECT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, slfile), 0, 0},
  {"difile", T_OBJECT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, difile), 0, 0},
  {"wxfile", T_OBJECT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, wxfile), 0, 0},
  {"idout", T_INT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, idout), 0, 0},
  {"idsk", T_INT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, idsk), 0, 0},
  {"iucd", T_INT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, iucd), 0, 0},
  {"icode", T_INT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, icode), 0, 0},
  {"pythonTimestep", T_INT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, pythonTimestep), 0, 0},
  {"generateGreen", T_INT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, generateGreen), 0, 0},
  {"idebug", T_INT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, idebug), 0, 0},
  {"ncycle", T_INT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, ncycle), 0, 0},
  {"iskopt", T_INT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, iskopt), 0, 0},
  {"stol", T_DOUBLE, offsetof(struct __pyx_obj_9PyLithLib_PyLith, stol), 0, 0},
  {"dtol", T_DOUBLE, offsetof(struct __pyx_obj_9PyLithLib_PyLith, dtol), 0, 0},
  {"epert", T_DOUBLE, offsetof(struct __pyx_obj_9PyLithLib_PyLith, epert), 0, 0},
  {"nprevdflag", T_INT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, nprevdflag), 0, 0},
  {"intord", T_INT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, intord), 0, 0},
  {"ipstrs", T_INT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, ipstrs), 0, 0},
  {"ipauto", T_INT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, ipauto), 0, 0},
  {"tpois", T_DOUBLE, offsetof(struct __pyx_obj_9PyLithLib_PyLith, tpois), 0, 0},
  {"tyoungs", T_DOUBLE, offsetof(struct __pyx_obj_9PyLithLib_PyLith, tyoungs), 0, 0},
  {"numat", T_INT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, numat), 0, 0},
  {"kti", T_INT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, kti), 0, 0},
  {"kto", T_INT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, kto), 0, 0},
  {"kr", T_INT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, kr), 0, 0},
  {"kw", T_INT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, kw), 0, 0},
  {"kp", T_INT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, kp), 0, 0},
  {"kucd", T_INT, offsetof(struct __pyx_obj_9PyLithLib_PyLith, kucd), 0, 0},
  {0, 0, 0, 0, 0}
};

static struct PyGetSetDef __pyx_getsets_9PyLithLib_PyLith[] = {
  {"grav", __pyx_getprop_9PyLithLib_6PyLith_grav, __pyx_setprop_9PyLithLib_6PyLith_grav, 0, 0},
  {"prscal", __pyx_getprop_9PyLithLib_6PyLith_prscal, __pyx_setprop_9PyLithLib_6PyLith_prscal, 0, 0},
  {"wscal", __pyx_getprop_9PyLithLib_6PyLith_wscal, __pyx_setprop_9PyLithLib_6PyLith_wscal, 0, 0},
  {"wxscal", __pyx_getprop_9PyLithLib_6PyLith_wxscal, __pyx_setprop_9PyLithLib_6PyLith_wxscal, 0, 0},
  {"prop", __pyx_getprop_9PyLithLib_6PyLith_prop, __pyx_setprop_9PyLithLib_6PyLith_prop, 0, 0},
  {"infmat", __pyx_getprop_9PyLithLib_6PyLith_infmat, __pyx_setprop_9PyLithLib_6PyLith_infmat, 0, 0},
  {"mesh", __pyx_getprop_9PyLithLib_6PyLith_mesh, __pyx_setprop_9PyLithLib_6PyLith_mesh, 0, 0},
  {0, 0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_PyLith = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  0, /*nb_divide*/
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  0, /*nb_coerce*/
  0, /*nb_int*/
  0, /*nb_long*/
  0, /*nb_float*/
  0, /*nb_oct*/
  0, /*nb_hex*/
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  0, /*nb_inplace_divide*/
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
};

static PySequenceMethods __pyx_tp_as_sequence_PyLith = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_PyLith = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_PyLith = {
  0, /*bf_getreadbuffer*/
  0, /*bf_getwritebuffer*/
  0, /*bf_getsegcount*/
  0, /*bf_getcharbuffer*/
};

PyTypeObject __pyx_type_9PyLithLib_PyLith = {
  PyObject_HEAD_INIT(0)
  0, /*ob_size*/
  "PyLithLib.PyLith", /*tp_name*/
  sizeof(struct __pyx_obj_9PyLithLib_PyLith), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_9PyLithLib_PyLith, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_PyLith, /*tp_as_number*/
  &__pyx_tp_as_sequence_PyLith, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_PyLith, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_PyLith, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_9PyLithLib_PyLith, /*tp_traverse*/
  __pyx_tp_clear_9PyLithLib_PyLith, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_9PyLithLib_PyLith, /*tp_methods*/
  __pyx_members_9PyLithLib_PyLith, /*tp_members*/
  __pyx_getsets_9PyLithLib_PyLith, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_f_9PyLithLib_6PyLith___init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_9PyLithLib_PyLith, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static struct PyMethodDef __pyx_methods[] = {
  {"f77open", (PyCFunction)__pyx_f_9PyLithLib_f77open, METH_VARARGS|METH_KEYWORDS, 0},
  {"f77close", (PyCFunction)__pyx_f_9PyLithLib_f77close, METH_VARARGS|METH_KEYWORDS, 0},
  {"PetscInitialize", (PyCFunction)__pyx_f_9PyLithLib_PetscInitialize, METH_VARARGS|METH_KEYWORDS, 0},
  {"PetscFinalize", (PyCFunction)__pyx_f_9PyLithLib_PetscFinalize, METH_VARARGS|METH_KEYWORDS, 0},
  {"try_binio", (PyCFunction)__pyx_f_9PyLithLib_try_binio, METH_VARARGS|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};

static void __pyx_init_filenames(void); /*proto*/

PyMODINIT_FUNC initPyLithLib(void); /*proto*/
PyMODINIT_FUNC initPyLithLib(void) {
  __pyx_init_filenames();
  __pyx_m = Py_InitModule4("PyLithLib", __pyx_methods, 0, 0, PYTHON_API_VERSION);
  if (!__pyx_m) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 32; goto __pyx_L1;};
  __pyx_b = PyImport_AddModule("__builtin__");
  if (!__pyx_b) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 32; goto __pyx_L1;};
  if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 32; goto __pyx_L1;};
  if (__Pyx_InternStrings(__pyx_intern_tab) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 32; goto __pyx_L1;};
  if (__Pyx_InitStrings(__pyx_string_tab) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 32; goto __pyx_L1;};
  __pyx_vtabptr_9PyLithLib_IntArray = &__pyx_vtable_9PyLithLib_IntArray;
  *(void(**)())&__pyx_vtable_9PyLithLib_IntArray.asList = (void(*)())__pyx_f_9PyLithLib_8IntArray_asList;
  if (PyType_Ready(&__pyx_type_9PyLithLib_IntArray) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 40; goto __pyx_L1;}
  if (__Pyx_SetVtable(__pyx_type_9PyLithLib_IntArray.tp_dict, __pyx_vtabptr_9PyLithLib_IntArray) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 40; goto __pyx_L1;}
  if (PyObject_SetAttrString(__pyx_m, "IntArray", (PyObject *)&__pyx_type_9PyLithLib_IntArray) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 40; goto __pyx_L1;}
  __pyx_ptype_9PyLithLib_IntArray = &__pyx_type_9PyLithLib_IntArray;
  __pyx_vtabptr_9PyLithLib_DoubleArray = &__pyx_vtable_9PyLithLib_DoubleArray;
  *(void(**)())&__pyx_vtable_9PyLithLib_DoubleArray.asList = (void(*)())__pyx_f_9PyLithLib_11DoubleArray_asList;
  if (PyType_Ready(&__pyx_type_9PyLithLib_DoubleArray) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; goto __pyx_L1;}
  if (__Pyx_SetVtable(__pyx_type_9PyLithLib_DoubleArray.tp_dict, __pyx_vtabptr_9PyLithLib_DoubleArray) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; goto __pyx_L1;}
  if (PyObject_SetAttrString(__pyx_m, "DoubleArray", (PyObject *)&__pyx_type_9PyLithLib_DoubleArray) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; goto __pyx_L1;}
  __pyx_ptype_9PyLithLib_DoubleArray = &__pyx_type_9PyLithLib_DoubleArray;
  __pyx_vtabptr_9PyLithLib_PyLith = &__pyx_vtable_9PyLithLib_PyLith;
  *(void(**)())&__pyx_vtable_9PyLithLib_PyLith.outputSampleValues = (void(*)())__pyx_f_9PyLithLib_6PyLith_outputSampleValues;
  *(void(**)())&__pyx_vtable_9PyLithLib_PyLith.greenFunction = (void(*)())__pyx_f_9PyLithLib_6PyLith_greenFunction;
  *(void(**)())&__pyx_vtable_9PyLithLib_PyLith.scan = (void(*)())__pyx_f_9PyLithLib_6PyLith_scan;
  *(void(**)())&__pyx_vtable_9PyLithLib_PyLith.scan_connect = (void(*)())__pyx_f_9PyLithLib_6PyLith_scan_connect;
  *(void(**)())&__pyx_vtable_9PyLithLib_PyLith.read = (void(*)())__pyx_f_9PyLithLib_6PyLith_read;
  *(void(**)())&__pyx_vtable_9PyLithLib_PyLith.getdef = (void(*)())__pyx_f_9PyLithLib_6PyLith_getdef;
  *(void(**)())&__pyx_vtable_9PyLithLib_PyLith.numberequations = (void(*)())__pyx_f_9PyLithLib_6PyLith_numberequations;
  *(void(**)())&__pyx_vtable_9PyLithLib_PyLith.nfind = (void(*)())__pyx_f_9PyLithLib_6PyLith_nfind;
  *(void(**)())&__pyx_vtable_9PyLithLib_PyLith.sortmesh = (void(*)())__pyx_f_9PyLithLib_6PyLith_sortmesh;
  *(void(**)())&__pyx_vtable_9PyLithLib_PyLith.sort_elements = (void(*)())__pyx_f_9PyLithLib_6PyLith_sort_elements;
  *(void(**)())&__pyx_vtable_9PyLithLib_PyLith.setupPETScLogging = (void(*)())__pyx_f_9PyLithLib_6PyLith_setupPETScLogging;
  *(void(**)())&__pyx_vtable_9PyLithLib_PyLith.sparsesetup = (void(*)())__pyx_f_9PyLithLib_6PyLith_sparsesetup;
  *(void(**)())&__pyx_vtable_9PyLithLib_PyLith.allocateremaining = (void(*)())__pyx_f_9PyLithLib_6PyLith_allocateremaining;
  *(void(**)())&__pyx_vtable_9PyLithLib_PyLith.meshwrite = (void(*)())__pyx_f_9PyLithLib_6PyLith_meshwrite;
  *(void(**)())&__pyx_vtable_9PyLithLib_PyLith.solveElastic = (void(*)())__pyx_f_9PyLithLib_6PyLith_solveElastic;
  *(void(**)())&__pyx_vtable_9PyLithLib_PyLith.interpolatePoints = (void(*)())__pyx_f_9PyLithLib_6PyLith_interpolatePoints;
  *(void(**)())&__pyx_vtable_9PyLithLib_PyLith.runSimulation = (void(*)())__pyx_f_9PyLithLib_6PyLith_runSimulation;
  __pyx_type_9PyLithLib_PyLith.tp_free = _PyObject_GC_Del;
  if (PyType_Ready(&__pyx_type_9PyLithLib_PyLith) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 51; goto __pyx_L1;}
  if (__Pyx_SetVtable(__pyx_type_9PyLithLib_PyLith.tp_dict, __pyx_vtabptr_9PyLithLib_PyLith) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 51; goto __pyx_L1;}
  if (PyObject_SetAttrString(__pyx_m, "PyLith", (PyObject *)&__pyx_type_9PyLithLib_PyLith) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 51; goto __pyx_L1;}
  __pyx_ptype_9PyLithLib_PyLith = &__pyx_type_9PyLithLib_PyLith;
  __pyx_ptype_13PyLithMeshLib_Mesh = __Pyx_ImportType("PyLithMeshLib", "Mesh", sizeof(struct PyMeshObject)); if (!__pyx_ptype_13PyLithMeshLib_Mesh) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 36; goto __pyx_L1;}
  if (__Pyx_GetVtable(__pyx_ptype_13PyLithMeshLib_Mesh->tp_dict, &__pyx_vtabptr_13PyLithMeshLib_Mesh) < 0) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 36; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/f77io.pyx":35 */
  Py_INCREF(Py_None);
  __pyx_k1 = Py_None;
  Py_INCREF(Py_None);
  __pyx_k2 = Py_None;
  Py_INCREF(Py_None);
  __pyx_k3 = Py_None;
  Py_INCREF(Py_None);
  __pyx_k4 = Py_None;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":37 */
  if (PyObject_SetAttr(__pyx_m, __pyx_n_gfile, Py_None) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 37; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":38 */
  if (PyObject_SetAttr(__pyx_m, __pyx_n_ghelp, Py_None) < 0) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 38; goto __pyx_L1;}

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/setup.pyx":41 */
  Py_INCREF(Py_None);
  __pyx_k5 = Py_None;
  Py_INCREF(Py_None);
  __pyx_k6 = Py_None;

  /* "/home/leif/tmp/pylith3d-0.8.2/pylith3d/module/PyLithLib.pyx":2744 */
  return;
  __pyx_L1:;
  __Pyx_AddTraceback("PyLithLib");
}

static char *__pyx_filenames[] = {
  "array.pyx",
  "f77io.pyx",
  "setup.pyx",
  "PyLithLib.pyx",
  "PyLithMeshLib.pxd",
};

/* Runtime support code */

static void __pyx_init_filenames(void) {
  __pyx_f = __pyx_filenames;
}

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name) {
    PyObject *result;
    result = PyObject_GetAttr(dict, name);
    if (!result)
        PyErr_SetObject(PyExc_NameError, name);
    return result;
}

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb) {
    Py_XINCREF(type);
    Py_XINCREF(value);
    Py_XINCREF(tb);
    /* First, check the traceback argument, replacing None with NULL. */
    if (tb == Py_None) {
        Py_DECREF(tb);
        tb = 0;
    }
    else if (tb != NULL && !PyTraceBack_Check(tb)) {
        PyErr_SetString(PyExc_TypeError,
            "raise: arg 3 must be a traceback or None");
        goto raise_error;
    }
    /* Next, replace a missing value with None */
    if (value == NULL) {
        value = Py_None;
        Py_INCREF(value);
    }
    /* Next, repeatedly, replace a tuple exception with its first item */
    while (PyTuple_Check(type) && PyTuple_Size(type) > 0) {
        PyObject *tmp = type;
        type = PyTuple_GET_ITEM(type, 0);
        Py_INCREF(type);
        Py_DECREF(tmp);
    }
    if (PyString_Check(type)) {
        if (PyErr_Warn(PyExc_DeprecationWarning,
                "raising a string exception is deprecated"))
            goto raise_error;
    }
    else if (PyType_Check(type) || PyClass_Check(type))
        ; /*PyErr_NormalizeException(&type, &value, &tb);*/
    else {
        /* Raising an instance.  The value should be a dummy. */
        if (value != Py_None) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto raise_error;
        }
        /* Normalize to raise <class>, <instance> */
        Py_DECREF(value);
        value = type;
        if (PyInstance_Check(type))
            type = (PyObject*) ((PyInstanceObject*)type)->in_class;
        else
            type = (PyObject*) type->ob_type;
        Py_INCREF(type);
    }
    PyErr_Restore(type, value, tb);
    return;
raise_error:
    Py_XDECREF(value);
    Py_XDECREF(type);
    Py_XDECREF(tb);
    return;
}

static void __Pyx_WriteUnraisable(char *name) {
    PyObject *old_exc, *old_val, *old_tb;
    PyObject *ctx;
    PyErr_Fetch(&old_exc, &old_val, &old_tb);
    ctx = PyString_FromString(name);
    PyErr_Restore(old_exc, old_val, old_tb);
    if (!ctx)
        ctx = Py_None;
    PyErr_WriteUnraisable(ctx);
}

static int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
    if (!type) {
        PyErr_Format(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if (obj == Py_None || PyObject_TypeCheck(obj, type))
        return 1;
    PyErr_Format(PyExc_TypeError, "Cannot convert %s to %s",
        obj->ob_type->tp_name, type->tp_name);
    return 0;
}

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list) {
    PyObject *__import__ = 0;
    PyObject *empty_list = 0;
    PyObject *module = 0;
    PyObject *global_dict = 0;
    PyObject *empty_dict = 0;
    PyObject *list;
    __import__ = PyObject_GetAttrString(__pyx_b, "__import__");
    if (!__import__)
        goto bad;
    if (from_list)
        list = from_list;
    else {
        empty_list = PyList_New(0);
        if (!empty_list)
            goto bad;
        list = empty_list;
    }
    global_dict = PyModule_GetDict(__pyx_m);
    if (!global_dict)
        goto bad;
    empty_dict = PyDict_New();
    if (!empty_dict)
        goto bad;
    module = PyObject_CallFunction(__import__, "OOOO",
        name, global_dict, empty_dict, list);
bad:
    Py_XDECREF(empty_list);
    Py_XDECREF(__import__);
    Py_XDECREF(empty_dict);
    return module;
}

static void __Pyx_UnpackError(void) {
    PyErr_SetString(PyExc_ValueError, "unpack sequence of wrong size");
}

static PyObject *__Pyx_UnpackItem(PyObject *iter) {
    PyObject *item;
    if (!(item = PyIter_Next(iter))) {
        if (!PyErr_Occurred())
            __Pyx_UnpackError();
    }
    return item;
}

static int __Pyx_EndUnpack(PyObject *iter) {
    PyObject *item;
    if ((item = PyIter_Next(iter))) {
        Py_DECREF(item);
        __Pyx_UnpackError();
        return -1;
    }
    else if (!PyErr_Occurred())
        return 0;
    else
        return -1;
}

static PyObject *__Pyx_GetStdout(void) {
    PyObject *f = PySys_GetObject("stdout");
    if (!f) {
        PyErr_SetString(PyExc_RuntimeError, "lost sys.stdout");
    }
    return f;
}

static int __Pyx_PrintItem(PyObject *v) {
    PyObject *f;
    
    if (!(f = __Pyx_GetStdout()))
        return -1;
    if (PyFile_SoftSpace(f, 1)) {
        if (PyFile_WriteString(" ", f) < 0)
            return -1;
    }
    if (PyFile_WriteObject(v, f, Py_PRINT_RAW) < 0)
        return -1;
    if (PyString_Check(v)) {
        char *s = PyString_AsString(v);
        int len = PyString_Size(v);
        if (len > 0 &&
            isspace(Py_CHARMASK(s[len-1])) &&
            s[len-1] != ' ')
                PyFile_SoftSpace(f, 0);
    }
    return 0;
}

static int __Pyx_PrintNewline(void) {
    PyObject *f;
    
    if (!(f = __Pyx_GetStdout()))
        return -1;
    if (PyFile_WriteString("\n", f) < 0)
        return -1;
    PyFile_SoftSpace(f, 0);
    return 0;
}

static int __Pyx_InternStrings(__Pyx_InternTabEntry *t) {
    while (t->p) {
        *t->p = PyString_InternFromString(t->s);
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t) {
    while (t->p) {
        *t->p = PyString_FromStringAndSize(t->s, t->n - 1);
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

static int __Pyx_SetVtable(PyObject *dict, void *vtable) {
    PyObject *pycobj = 0;
    int result;
    
    pycobj = PyCObject_FromVoidPtr(vtable, 0);
    if (!pycobj)
        goto bad;
    if (PyDict_SetItemString(dict, "__pyx_vtable__", pycobj) < 0)
        goto bad;
    result = 0;
    goto done;

bad:
    result = -1;
done:
    Py_XDECREF(pycobj);
    return result;
}

static PyTypeObject *__Pyx_ImportType(char *module_name, char *class_name, 
    long size) 
{
    PyObject *py_module_name = 0;
    PyObject *py_class_name = 0;
    PyObject *py_name_list = 0;
    PyObject *py_module = 0;
    PyObject *result = 0;
    
    py_module_name = PyString_FromString(module_name);
    if (!py_module_name)
        goto bad;
    py_class_name = PyString_FromString(class_name);
    if (!py_class_name)
        goto bad;
    py_name_list = PyList_New(1);
    if (!py_name_list)
        goto bad;
    Py_INCREF(py_class_name);
    if (PyList_SetItem(py_name_list, 0, py_class_name) < 0)
        goto bad;
    py_module = __Pyx_Import(py_module_name, py_name_list);
    if (!py_module)
        goto bad;
    result = PyObject_GetAttr(py_module, py_class_name);
    if (!result)
        goto bad;
    if (!PyType_Check(result)) {
        PyErr_Format(PyExc_TypeError, 
            "%s.%s is not a type object",
            module_name, class_name);
        goto bad;
    }
    if (((PyTypeObject *)result)->tp_basicsize != size) {
        PyErr_Format(PyExc_ValueError, 
            "%s.%s does not appear to be the correct type object",
            module_name, class_name);
        goto bad;
    }
    goto done;
bad:
    Py_XDECREF(result);
    result = 0;
done:
    Py_XDECREF(py_module_name);
    Py_XDECREF(py_class_name);
    Py_XDECREF(py_name_list);
    return (PyTypeObject *)result;
}

static int __Pyx_GetVtable(PyObject *dict, void *vtabptr) {
    int result;
    PyObject *pycobj;
    
    pycobj = PyMapping_GetItemString(dict, "__pyx_vtable__");
    if (!pycobj)
        goto bad;
    *(void **)vtabptr = PyCObject_AsVoidPtr(pycobj);
    if (!*(void **)vtabptr)
        goto bad;
    result = 0;
    goto done;

bad:
    result = -1;
done:
    Py_XDECREF(pycobj);
    return result;
}

#include "compile.h"
#include "frameobject.h"
#include "traceback.h"

static void __Pyx_AddTraceback(char *funcname) {
    PyObject *py_srcfile = 0;
    PyObject *py_funcname = 0;
    PyObject *py_globals = 0;
    PyObject *empty_tuple = 0;
    PyObject *empty_string = 0;
    PyCodeObject *py_code = 0;
    PyFrameObject *py_frame = 0;
    
    py_srcfile = PyString_FromString(__pyx_filename);
    if (!py_srcfile) goto bad;
    py_funcname = PyString_FromString(funcname);
    if (!py_funcname) goto bad;
    py_globals = PyModule_GetDict(__pyx_m);
    if (!py_globals) goto bad;
    empty_tuple = PyTuple_New(0);
    if (!empty_tuple) goto bad;
    empty_string = PyString_FromString("");
    if (!empty_string) goto bad;
    py_code = PyCode_New(
        0,            /*int argcount,*/
        0,            /*int nlocals,*/
        0,            /*int stacksize,*/
        0,            /*int flags,*/
        empty_string, /*PyObject *code,*/
        empty_tuple,  /*PyObject *consts,*/
        empty_tuple,  /*PyObject *names,*/
        empty_tuple,  /*PyObject *varnames,*/
        empty_tuple,  /*PyObject *freevars,*/
        empty_tuple,  /*PyObject *cellvars,*/
        py_srcfile,   /*PyObject *filename,*/
        py_funcname,  /*PyObject *name,*/
        __pyx_lineno,   /*int firstlineno,*/
        empty_string  /*PyObject *lnotab*/
    );
    if (!py_code) goto bad;
    py_frame = PyFrame_New(
        PyThreadState_Get(), /*PyThreadState *tstate,*/
        py_code,             /*PyCodeObject *code,*/
        py_globals,          /*PyObject *globals,*/
        0                    /*PyObject *locals*/
    );
    if (!py_frame) goto bad;
    py_frame->f_lineno = __pyx_lineno;
    PyTraceBack_Here(py_frame);
bad:
    Py_XDECREF(py_srcfile);
    Py_XDECREF(py_funcname);
    Py_XDECREF(empty_tuple);
    Py_XDECREF(empty_string);
    Py_XDECREF(py_code);
    Py_XDECREF(py_frame);
}
